<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ONE - On-device Neural Engine: Backend API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ONE - On-device Neural Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_runtime_backend_api.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Backend API </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Backend API is defined by One Runtime. It is about actual computation of operations and memory management for operands. In order to allow different kinds of computation units or libraries, Backend API is exposed to support user defined operation kernels and memory manager. It contains several C++ interface classes which are <b>subject to change</b>.</p>
<h1>How backends are loaded</h1>
<p >When a backend ID is given to a session, the compiler module tries to load <code>libbackend_{BACKEND_ID}.so</code>. If it is successful, the runtime looks up for C API functions in it, and make use of those.</p>
<h1>C and C++ API</h1>
<h2>C API</h2>
<p >We have 2 C API functions which are used as the entrypoint and the exitpoint. Here are the definitions of those.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classonert_1_1backend_1_1_backend.html">onert::backend::Backend</a> *<a class="code hl_function" href="acl__cl_8cc.html#ac05b7edc89ea7fbb0fb60f42db522c49">onert_backend_create</a>();</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="acl__cl_8cc.html#a1d7114a0448122974a3df458ef21f2f8">onert_backend_destroy</a>(<a class="code hl_class" href="classonert_1_1backend_1_1_backend.html">onert::backend::Backend</a> *backend);</div>
<div class="ttc" id="aacl__cl_8cc_html_a1d7114a0448122974a3df458ef21f2f8"><div class="ttname"><a href="acl__cl_8cc.html#a1d7114a0448122974a3df458ef21f2f8">onert_backend_destroy</a></div><div class="ttdeci">void onert_backend_destroy(onert::backend::Backend *backend)</div><div class="ttdef"><b>Definition:</b> <a href="acl__cl_8cc_source.html#l00023">acl_cl.cc:23</a></div></div>
<div class="ttc" id="aacl__cl_8cc_html_ac05b7edc89ea7fbb0fb60f42db522c49"><div class="ttname"><a href="acl__cl_8cc.html#ac05b7edc89ea7fbb0fb60f42db522c49">onert_backend_create</a></div><div class="ttdeci">onert::backend::Backend * onert_backend_create()</div><div class="ttdef"><b>Definition:</b> <a href="acl__cl_8cc_source.html#l00021">acl_cl.cc:21</a></div></div>
<div class="ttc" id="aclassonert_1_1backend_1_1_backend_html"><div class="ttname"><a href="classonert_1_1backend_1_1_backend.html">onert::backend::Backend</a></div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2backend_2_backend_8h_source.html#l00036">Backend.h:37</a></div></div>
</div><!-- fragment --><p >What they do is creating a C++ object and destroying it, respectively. These two functions are the only ones that are dynamically resolved at runtime.</p>
<h2>C++ API</h2>
<blockquote class="doxtable">
<p >&zwj;<b>NOTE</b> C++ API is subject to change so it may change in every release </p>
</blockquote>
<p>C API above is just an entrypoint and it delegates core stuff to C++ API.</p>
<p >Here are major classes are described below. One must implement these classes(and some more classes) to create a backend.</p>
<ul>
<li><code>Backend</code> : Responsible to create a backend context which is a set of backend components</li>
<li><code>BackendContext</code> : Holds data for the current session and also responsible to create tensor objects and kernels<ul>
<li><code>BackendContext::genTensors</code> : Create tensor objects</li>
<li><code>BackendContext::genKernels</code> : Create kernels</li>
</ul>
</li>
<li><code>IConfig</code> : Configurations and miscellaneous stuff (not session based, global)</li>
<li><code>ITensorRegistry</code> : A set of tensor(<code>ITensor</code>) objects that are used by the current backend</li>
</ul>
<p >Please refer to each class document for details. You may refer to Bundle Backends for actual implementation samples.</p>
<h1>Provided Backend Implementations</h1>
<p >We provide some backends along with the runtime. There is the special backend <code>builtin</code> which is part of runtime core, and some bundle backends which are baseline backends and samples of backend implementation.</p>
<h1><code>builtin</code> Backend</h1>
<p ><code>builtin</code> is a special backend that is always loaded(statically linked, part of runtime core). It is implemented just like other backends, but there are some things that it does exclusively.</p>
<ul>
<li>Has kernels for If, While and Permute operations (Kernels from other backends are never be used)</li>
<li>The runtime core directly creates <code>builtin</code>'s tensor objects to accept user-given input and output buffers</li>
<li>The runtime core gives the executor context to <code>builtin</code> backend which allows control flow ops can change execution flow properly</li>
</ul>
<h1>Bundle Backends</h1>
<p >Without actual implmentation of backends, we cannot run any models. So we provide 3 bundle backends which support dozens of operations.</p>
<h2>cpu</h2>
<p >This backend is written in C++ and all the computation is done with CPU only.</p>
<h2>acl_neon</h2>
<p ><code>acl_neon</code> is a backend that is an adaptation layer of <a href="https://github.com/ARM-software/ComputeLibrary">ARM ComputeLibrary</a> NE(NEON) part. So it basically only uses CPU too, but worksonly on ARM.</p>
<h2>acl_cl</h2>
<p ><code>acl_cl</code> is a backend that is an adaptation layer of <a href="https://github.com/ARM-software/ComputeLibrary">ARM ComputeLibrary</a> CL(OpenCL) part. OpenCL support(<code>libOpenCL.so</code>) is also necessary in the running environment to be able to use this backend. Also, it works only on ARM. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
