<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ONE - On-device Neural Engine: onert::backend::basic Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ONE - On-device Neural Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceonert_1_1backend_1_1basic.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">onert::backend::basic Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_allocator.html">Allocator</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to allocate memory.  <a href="classonert_1_1backend_1_1basic_1_1_allocator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structonert_1_1backend_1_1basic_1_1_block.html">Block</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to have memory offset and size.  <a href="structonert_1_1backend_1_1basic_1_1_block.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_bump_planner.html">BumpPlanner</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to plan memory by bump way.  <a href="classonert_1_1backend_1_1basic_1_1_bump_planner.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_dynamic_memory_manager.html">DynamicMemoryManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_dynamic_tensor_manager.html">DynamicTensorManager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to manage dynamic tensor and its memory.  <a href="classonert_1_1backend_1_1basic_1_1_dynamic_tensor_manager.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_external_tensor.html">ExternalTensor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class that uses data from external memory that is not managed by a backend instead of allocating and copying the data. ExternalTensor's data pointer points to an address of memory such as where memory is already allocated, or mmapped area. This is meaning that ExternalTensor can take all of types' ir::Data. To support this, assume below things no padding, always NHWC layout, constant tensor and not dynamic.  <a href="classonert_1_1backend_1_1basic_1_1_external_tensor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_first_fit_planner.html">FirstFitPlanner</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to plan memory by firstfit way.  <a href="classonert_1_1backend_1_1basic_1_1_first_fit_planner.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structonert_1_1backend_1_1basic_1_1_i_memory_planner.html">IMemoryPlanner</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to plan memory.  <a href="structonert_1_1backend_1_1basic_1_1_i_memory_planner.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_kernel_generator_base.html">KernelGeneratorBase</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_memory_manager.html">MemoryManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_memory_planner_factory.html">MemoryPlannerFactory</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_static_tensor_manager.html">StaticTensorManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_tensor.html">Tensor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_tensor_builder.html">TensorBuilder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classonert_1_1backend_1_1basic_1_1_w_i_c_planner.html">WICPlanner</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to plan memory by Weighted Interval Color algorithm.  <a href="classonert_1_1backend_1_1basic_1_1_w_i_c_planner.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a50c36d28c81cb8c597b3b3b694ed28b4"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceonert_1_1backend_1_1basic.html#a50c36d28c81cb8c597b3b3b694ed28b4">TensorRegistry</a> = <a class="el" href="classonert_1_1backend_1_1_portable_tensor_registry_template.html">PortableTensorRegistryTemplate</a>&lt; <a class="el" href="classonert_1_1backend_1_1basic_1_1_tensor.html">basic::Tensor</a> &gt;</td></tr>
<tr class="separator:a50c36d28c81cb8c597b3b3b694ed28b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a54eb5e4a346b96f0671cf5a22a503047"><td class="memTemplParams" colspan="2">template&lt;typename T_BackendContext &gt; </td></tr>
<tr class="memitem:a54eb5e4a346b96f0671cf5a22a503047"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceonert_1_1backend_1_1basic.html#a54eb5e4a346b96f0671cf5a22a503047">planTensors</a> (const T_BackendContext &amp;ctx)</td></tr>
<tr class="separator:a54eb5e4a346b96f0671cf5a22a503047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523700f739c342f8cd74c44b0bb0e1ec"><td class="memTemplParams" colspan="2">template&lt;typename T_BackendContext &gt; </td></tr>
<tr class="memitem:a523700f739c342f8cd74c44b0bb0e1ec"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structonert_1_1backend_1_1_i_tensor_registry.html">ITensorRegistry</a> *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceonert_1_1backend_1_1basic.html#a523700f739c342f8cd74c44b0bb0e1ec">genTensors</a> (T_BackendContext &amp;ctx)</td></tr>
<tr class="separator:a523700f739c342f8cd74c44b0bb0e1ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac166a61e29e65ea974fdff255b1097ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceonert_1_1backend_1_1basic.html#ac166a61e29e65ea974fdff255b1097ef">initConsts</a> (<a class="el" href="classonert_1_1backend_1_1_backend_context.html">BackendContext</a> &amp;ctx)</td></tr>
<tr class="separator:ac166a61e29e65ea974fdff255b1097ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a50c36d28c81cb8c597b3b3b694ed28b4" name="a50c36d28c81cb8c597b3b3b694ed28b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50c36d28c81cb8c597b3b3b694ed28b4">&#9670;&#160;</a></span>TensorRegistry</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="namespaceonert_1_1backend_1_1basic.html#a50c36d28c81cb8c597b3b3b694ed28b4">onert::backend::basic::TensorRegistry</a> = typedef <a class="el" href="classonert_1_1backend_1_1_portable_tensor_registry_template.html">PortableTensorRegistryTemplate</a>&lt;<a class="el" href="classonert_1_1backend_1_1basic_1_1_tensor.html">basic::Tensor</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="core_2include_2backend_2basic_2_tensor_registry_8h_source.html#l00030">30</a> of file <a class="el" href="core_2include_2backend_2basic_2_tensor_registry_8h_source.html">TensorRegistry.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a523700f739c342f8cd74c44b0bb0e1ec" name="a523700f739c342f8cd74c44b0bb0e1ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523700f739c342f8cd74c44b0bb0e1ec">&#9670;&#160;</a></span>genTensors()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T_BackendContext &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structonert_1_1backend_1_1_i_tensor_registry.html">ITensorRegistry</a> * onert::backend::basic::genTensors </td>
          <td>(</td>
          <td class="paramtype">T_BackendContext &amp;&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_backend_context_helpers_8h_source.html#l00188">188</a> of file <a class="el" href="_backend_context_helpers_8h_source.html">BackendContextHelpers.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>{</div>
<div class="line"><span class="lineno">  190</span>  <span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1ir_1_1_graph.html">ir::Graph</a> &amp;graph = *ctx.graph();</div>
<div class="line"><span class="lineno">  191</span>  <span class="keyword">auto</span> tensor_builder = ctx.tensor_builder;</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  <span class="keyword">auto</span> model_io =</div>
<div class="line"><span class="lineno">  194</span>    (graph.getInputs() + graph.getOutputs()) | ir::Remove::UNDEFINED | ir::Remove::DUPLICATED;</div>
<div class="line"><span class="lineno">  195</span>  graph.operands().iterate([&amp;](<span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1util_1_1_index.html">ir::OperandIndex</a> &amp;ind, <span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1ir_1_1_operand.html">ir::Operand</a> &amp;obj) {</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">if</span> (ctx.external_operands().contains(ind))</div>
<div class="line"><span class="lineno">  197</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  198</span>    <span class="comment">// NOTE Assuming there is no layout changes (Always assume NHWC or UNKNOWN)</span></div>
<div class="line"><span class="lineno">  199</span>    assert(graph.layout() != ir::Layout::NCHW);</div>
<div class="line"><span class="lineno">  200</span>    <a class="code hl_class" href="classonert_1_1ir_1_1_operand_info.html">ir::OperandInfo</a> backend_info{obj.shape(), obj.typeInfo(), obj.info().memAllocType(),</div>
<div class="line"><span class="lineno">  201</span>                                 obj.isConstant()};</div>
<div class="line"><span class="lineno">  202</span>    tensor_builder-&gt;registerTensorInfo(ind, backend_info, ir::Layout::NHWC);</div>
<div class="line"><span class="lineno">  203</span>  });</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>  <span class="comment">// TODO Get compiler options from compiler, and use it rather than getting it from Env</span></div>
<div class="line"><span class="lineno">  206</span>  <span class="keywordflow">if</span> (util::getConfigString(util::config::EXECUTOR) == <span class="stringliteral">&quot;Linear&quot;</span>)</div>
<div class="line"><span class="lineno">  207</span>  {</div>
<div class="line"><span class="lineno">  208</span>    basic::planTensors(ctx);</div>
<div class="line"><span class="lineno">  209</span>  }</div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  211</span>  {</div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">// For the executors that does not have fixed linear execution order:</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">// To make tensors never be deallocated, this is a workaround to use static memory planner</span></div>
<div class="line"><span class="lineno">  214</span>    graph.operands().iterate([&amp;](<span class="keyword">const</span> ir::OperandIndex &amp;ind, <span class="keyword">const</span> ir::Operand &amp;) {</div>
<div class="line"><span class="lineno">  215</span>      <span class="keywordflow">if</span> (tensor_builder-&gt;isRegistered(ind))</div>
<div class="line"><span class="lineno">  216</span>        tensor_builder-&gt;notifyFirstUse(ind);</div>
<div class="line"><span class="lineno">  217</span>    });</div>
<div class="line"><span class="lineno">  218</span>  }</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>  tensor_builder-&gt;allocate();</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>  <span class="keywordflow">return</span> ctx.tensor_registry.get();</div>
<div class="line"><span class="lineno">  223</span>}</div>
<div class="ttc" id="aclassonert_1_1ir_1_1_graph_html"><div class="ttname"><a href="classonert_1_1ir_1_1_graph.html">onert::ir::Graph</a></div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2ir_2_graph_8h_source.html#l00043">Graph.h:44</a></div></div>
<div class="ttc" id="aclassonert_1_1ir_1_1_operand_html"><div class="ttname"><a href="classonert_1_1ir_1_1_operand.html">onert::ir::Operand</a></div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2ir_2_operand_8h_source.html#l00035">Operand.h:36</a></div></div>
<div class="ttc" id="aclassonert_1_1ir_1_1_operand_info_html"><div class="ttname"><a href="classonert_1_1ir_1_1_operand_info.html">onert::ir::OperandInfo</a></div><div class="ttdoc">Class to save tensor's shape and type.</div><div class="ttdef"><b>Definition:</b> <a href="_operand_info_8h_source.html#l00054">OperandInfo.h:55</a></div></div>
<div class="ttc" id="aclassonert_1_1util_1_1_index_html"><div class="ttname"><a href="classonert_1_1util_1_1_index.html">onert::util::Index&lt; uint32_t, OperandIndexTag &gt;</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespaceonert_1_1ir.html#a5e8296b1d63c853b1ea62276ed809e54a1d840e66127ec54a19244f29a07fb8b8">onert::ir::DUPLICATED</a>, <a class="el" href="onert_2core_2src_2util_2_config_source_8cc_source.html#l00130">onert::util::getConfigString()</a>, <a class="el" href="namespaceonert_1_1ir.html#ae8c0846bdada8dcd2c06205bb4a8a4e2a6b99f356fe3b30a2a850b5ea897c289f">onert::ir::NCHW</a>, <a class="el" href="namespaceonert_1_1ir.html#ae8c0846bdada8dcd2c06205bb4a8a4e2ad066db54b89b0912e7e7c6da51e2da51">onert::ir::NHWC</a>, <a class="el" href="_backend_context_helpers_8h_source.html#l00037">planTensors()</a>, and <a class="el" href="namespaceonert_1_1ir.html#a5e8296b1d63c853b1ea62276ed809e54a0db45d2a4141101bdfe48e3314cfbca3">onert::ir::UNDEFINED</a>.</p>

<p class="reference">Referenced by <a class="el" href="backend_2cpu_2_backend_context_8cc_source.html#l00034">onert::backend::cpu::BackendContext::genTensors()</a>, <a class="el" href="backend_2ruy_2_backend_context_8cc_source.html#l00034">onert::backend::ruy::BackendContext::genTensors()</a>, <a class="el" href="backend_2trix_2_backend_context_8cc_source.html#l00034">onert::backend::trix::BackendContext::genTensors()</a>, <a class="el" href="backend_2xnnpack_2_backend_context_8cc_source.html#l00034">onert::backend::xnnpack::BackendContext::genTensors()</a>, and <a class="el" href="core_2src_2backend_2builtin_2_backend_context_8cc_source.html#l00029">onert::backend::builtin::BackendContext::genTensors()</a>.</p>

</div>
</div>
<a id="ac166a61e29e65ea974fdff255b1097ef" name="ac166a61e29e65ea974fdff255b1097ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac166a61e29e65ea974fdff255b1097ef">&#9670;&#160;</a></span>initConsts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void onert::backend::basic::initConsts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classonert_1_1backend_1_1_backend_context.html">BackendContext</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_backend_context_helpers_8h_source.html#l00225">225</a> of file <a class="el" href="_backend_context_helpers_8h_source.html">BackendContextHelpers.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>{</div>
<div class="line"><span class="lineno">  227</span>  ctx.<a class="code hl_function" href="classonert_1_1backend_1_1_backend_context.html#aa46736f718462405643dd0e37cca0568">graph</a>()-&gt;<a class="code hl_function" href="classonert_1_1ir_1_1_graph.html#a22112007ffac1f6dcfced6eb000639b2">operands</a>().<a class="code hl_function" href="classonert_1_1util_1_1_object_manager.html#ac73c1ef157e3bbe47709a786ebc6aae2">iterate</a>([&amp;](<span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1util_1_1_index.html">ir::OperandIndex</a> &amp;ind, <span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1ir_1_1_operand.html">ir::Operand</a> &amp;operand) {</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">if</span> (ctx.<a class="code hl_function" href="classonert_1_1backend_1_1_backend_context.html#af2614248c40a6d65b63893e2d4e6ab34">external_operands</a>().contains(ind) || !operand.<a class="code hl_function" href="classonert_1_1ir_1_1_operand.html#adf7f1ce514558b7c27e75ba5457c74d7">isConstant</a>())</div>
<div class="line"><span class="lineno">  229</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>    <span class="keyword">auto</span> tensor = ctx.<a class="code hl_variable" href="classonert_1_1backend_1_1_backend_context.html#a2104ac8b3e1ae28ea2dfbb7ca00e2806">tensor_registry</a>-&gt;getNativeITensor(ind);</div>
<div class="line"><span class="lineno">  232</span>    assert(tensor != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_define" href="luci_2log_2include_2luci_2_log_8h.html#a212d71bce44cd84d4fe678058cd5eccd">VERBOSE</a>(FillOperandData) &lt;&lt; <span class="stringliteral">&quot;Fill data for &quot;</span> &lt;&lt; ind &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keyword">auto</span> data = operand.<a class="code hl_function" href="classonert_1_1ir_1_1_operand.html#af96653c450ff2c67f0db84d995054754">shareData</a>();</div>
<div class="line"><span class="lineno">  237</span>    assert(data &amp;&amp; data-&gt;base());</div>
<div class="line"><span class="lineno">  238</span>    <a class="code hl_class" href="classonert_1_1backend_1_1basic_1_1_external_tensor.html">ExternalTensor</a> *ext_tensor = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classonert_1_1backend_1_1basic_1_1_external_tensor.html">ExternalTensor</a> *<span class="keyword">&gt;</span>(tensor);</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">if</span> (ext_tensor == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  241</span>      <span class="keywordflow">throw</span> std::runtime_error{<span class="stringliteral">&quot;This tensor is not external tensor&quot;</span>};</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    ext_tensor-&gt;<a class="code hl_function" href="classonert_1_1backend_1_1basic_1_1_external_tensor.html#abff88ff11a8ae2338d04986e8c5a6145">setData</a>(data);</div>
<div class="line"><span class="lineno">  244</span>  });</div>
<div class="line"><span class="lineno">  245</span>}</div>
<div class="ttc" id="aclassonert_1_1backend_1_1_backend_context_html_a2104ac8b3e1ae28ea2dfbb7ca00e2806"><div class="ttname"><a href="classonert_1_1backend_1_1_backend_context.html#a2104ac8b3e1ae28ea2dfbb7ca00e2806">onert::backend::BackendContext::tensor_registry</a></div><div class="ttdeci">std::shared_ptr&lt; ITensorRegistry &gt; tensor_registry</div><div class="ttdef"><b>Definition:</b> <a href="core_2include_2backend_2_backend_context_8h_source.html#l00079">BackendContext.h:79</a></div></div>
<div class="ttc" id="aclassonert_1_1backend_1_1_backend_context_html_aa46736f718462405643dd0e37cca0568"><div class="ttname"><a href="classonert_1_1backend_1_1_backend_context.html#aa46736f718462405643dd0e37cca0568">onert::backend::BackendContext::graph</a></div><div class="ttdeci">const ir::Graph * graph() const</div><div class="ttdef"><b>Definition:</b> <a href="core_2include_2backend_2_backend_context_8h_source.html#l00066">BackendContext.h:66</a></div></div>
<div class="ttc" id="aclassonert_1_1backend_1_1_backend_context_html_af2614248c40a6d65b63893e2d4e6ab34"><div class="ttname"><a href="classonert_1_1backend_1_1_backend_context.html#af2614248c40a6d65b63893e2d4e6ab34">onert::backend::BackendContext::external_operands</a></div><div class="ttdeci">const util::Set&lt; ir::OperandIndex &gt; &amp; external_operands() const</div><div class="ttdef"><b>Definition:</b> <a href="core_2include_2backend_2_backend_context_8h_source.html#l00067">BackendContext.h:67</a></div></div>
<div class="ttc" id="aclassonert_1_1backend_1_1basic_1_1_external_tensor_html"><div class="ttname"><a href="classonert_1_1backend_1_1basic_1_1_external_tensor.html">onert::backend::basic::ExternalTensor</a></div><div class="ttdoc">Class that uses data from external memory that is not managed by a backend instead of allocating and ...</div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2backend_2basic_2_tensor_8h_source.html#l00169">Tensor.h:170</a></div></div>
<div class="ttc" id="aclassonert_1_1backend_1_1basic_1_1_external_tensor_html_abff88ff11a8ae2338d04986e8c5a6145"><div class="ttname"><a href="classonert_1_1backend_1_1basic_1_1_external_tensor.html#abff88ff11a8ae2338d04986e8c5a6145">onert::backend::basic::ExternalTensor::setData</a></div><div class="ttdeci">void setData(const std::shared_ptr&lt; ir::Data &gt; data)</div><div class="ttdoc">set Data to be shared from external so that this ExternalTensor will not be allocated on CPU backend</div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2backend_2basic_2_tensor_8h_source.html#l00190">Tensor.h:190</a></div></div>
<div class="ttc" id="aclassonert_1_1ir_1_1_graph_html_a22112007ffac1f6dcfced6eb000639b2"><div class="ttname"><a href="classonert_1_1ir_1_1_graph.html#a22112007ffac1f6dcfced6eb000639b2">onert::ir::Graph::operands</a></div><div class="ttdeci">const Operands &amp; operands() const</div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2ir_2_graph_8h_source.html#l00125">Graph.h:125</a></div></div>
<div class="ttc" id="aclassonert_1_1ir_1_1_operand_html_adf7f1ce514558b7c27e75ba5457c74d7"><div class="ttname"><a href="classonert_1_1ir_1_1_operand.html#adf7f1ce514558b7c27e75ba5457c74d7">onert::ir::Operand::isConstant</a></div><div class="ttdeci">bool isConstant(void) const</div><div class="ttdoc">Get true if Operand is const, otherwise false a.</div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2ir_2_operand_8h_source.html#l00079">Operand.h:79</a></div></div>
<div class="ttc" id="aclassonert_1_1ir_1_1_operand_html_af96653c450ff2c67f0db84d995054754"><div class="ttname"><a href="classonert_1_1ir_1_1_operand.html#af96653c450ff2c67f0db84d995054754">onert::ir::Operand::shareData</a></div><div class="ttdeci">std::shared_ptr&lt; Data &gt; shareData(void) const</div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2ir_2_operand_8h_source.html#l00073">Operand.h:73</a></div></div>
<div class="ttc" id="aclassonert_1_1util_1_1_object_manager_html_ac73c1ef157e3bbe47709a786ebc6aae2"><div class="ttname"><a href="classonert_1_1util_1_1_object_manager.html#ac73c1ef157e3bbe47709a786ebc6aae2">onert::util::ObjectManager::iterate</a></div><div class="ttdeci">void iterate(const std::function&lt; void(const Index &amp;, const Object &amp;)&gt; &amp;fn) const</div><div class="ttdoc">Iterate over the container with given function.</div><div class="ttdef"><b>Definition:</b> <a href="runtime_2onert_2core_2include_2util_2_object_manager_8h_source.html#l00186">ObjectManager.h:186</a></div></div>
<div class="ttc" id="aluci_2log_2include_2luci_2_log_8h_html_a212d71bce44cd84d4fe678058cd5eccd"><div class="ttname"><a href="luci_2log_2include_2luci_2_log_8h.html#a212d71bce44cd84d4fe678058cd5eccd">VERBOSE</a></div><div class="ttdeci">#define VERBOSE(name, lv)</div><div class="ttdef"><b>Definition:</b> <a href="luci_2log_2include_2luci_2_log_8h_source.html#l00071">Log.h:71</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="core_2include_2backend_2_backend_context_8h_source.html#l00067">onert::backend::BackendContext::external_operands()</a>, <a class="el" href="core_2include_2backend_2_backend_context_8h_source.html#l00066">onert::backend::BackendContext::graph()</a>, <a class="el" href="runtime_2onert_2core_2include_2ir_2_operand_8h_source.html#l00079">onert::ir::Operand::isConstant()</a>, <a class="el" href="runtime_2onert_2core_2include_2util_2_object_manager_8h_source.html#l00186">onert::util::ObjectManager&lt; Index, Object &gt;::iterate()</a>, <a class="el" href="runtime_2onert_2core_2include_2ir_2_graph_8h_source.html#l00125">onert::ir::Graph::operands()</a>, <a class="el" href="runtime_2onert_2core_2include_2backend_2basic_2_tensor_8h_source.html#l00190">onert::backend::basic::ExternalTensor::setData()</a>, <a class="el" href="runtime_2onert_2core_2include_2ir_2_operand_8h_source.html#l00073">onert::ir::Operand::shareData()</a>, <a class="el" href="core_2include_2backend_2_backend_context_8h_source.html#l00079">onert::backend::BackendContext::tensor_registry</a>, and <a class="el" href="luci_2log_2include_2luci_2_log_8h_source.html#l00071">VERBOSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="backend_2cpu_2_backend_context_8cc_source.html#l00036">onert::backend::cpu::BackendContext::genKernels()</a>, <a class="el" href="backend_2ruy_2_backend_context_8cc_source.html#l00036">onert::backend::ruy::BackendContext::genKernels()</a>, <a class="el" href="backend_2trix_2_backend_context_8cc_source.html#l00036">onert::backend::trix::BackendContext::genKernels()</a>, <a class="el" href="backend_2xnnpack_2_backend_context_8cc_source.html#l00036">onert::backend::xnnpack::BackendContext::genKernels()</a>, and <a class="el" href="core_2src_2backend_2builtin_2_backend_context_8cc_source.html#l00031">onert::backend::builtin::BackendContext::genKernels()</a>.</p>

</div>
</div>
<a id="a54eb5e4a346b96f0671cf5a22a503047" name="a54eb5e4a346b96f0671cf5a22a503047"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54eb5e4a346b96f0671cf5a22a503047">&#9670;&#160;</a></span>planTensors()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T_BackendContext &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void onert::backend::basic::planTensors </td>
          <td>(</td>
          <td class="paramtype">const T_BackendContext &amp;&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_backend_context_helpers_8h_source.html#l00037">37</a> of file <a class="el" href="_backend_context_helpers_8h_source.html">BackendContextHelpers.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>  <span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1ir_1_1_graph.html">ir::Graph</a> &amp;graph = *ctx.graph();</div>
<div class="line"><span class="lineno">   40</span>  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;order = ctx.data().op_order;</div>
<div class="line"><span class="lineno">   41</span>  <span class="keyword">auto</span> tensor_builder = ctx.tensor_builder;</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <a class="code hl_typedef" href="namespaceonert_1_1ir.html#a8d1d09cc0eb99dc03e422dbe13dccce3">ir::OperandIndexMap&lt;uint32_t&gt;</a> uses_map;</div>
<div class="line"><span class="lineno">   44</span>  <a class="code hl_typedef" href="namespaceonert_1_1ir.html#a8d1d09cc0eb99dc03e422dbe13dccce3">ir::OperandIndexMap&lt;uint32_t&gt;</a> def_map;</div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_class" href="classonert_1_1ir_1_1_operand_index_sequence.html">ir::OperandIndexSequence</a> constants;</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>  <span class="keyword">auto</span> model_io =</div>
<div class="line"><span class="lineno">   48</span>    (graph.getInputs() + graph.getOutputs()) | ir::Remove::UNDEFINED | ir::Remove::DUPLICATED;</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>  <span class="comment">// Prepare scanning</span></div>
<div class="line"><span class="lineno">   51</span>  graph.operands().iterate([&amp;](<span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1util_1_1_index.html">ir::OperandIndex</a> &amp;ind, <span class="keyword">const</span> <a class="code hl_class" href="classonert_1_1ir_1_1_operand.html">ir::Operand</a> &amp;obj) {</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> (ctx.external_operands().contains(ind))</div>
<div class="line"><span class="lineno">   53</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    <span class="comment">// TODO Check if we need to handle unused tensors</span></div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    uses_map[ind] = obj.getUses().size();</div>
<div class="line"><span class="lineno">   58</span>    def_map[ind] = obj.getDef().valid() ? 1 : 0;</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">if</span> (obj.isConstant())</div>
<div class="line"><span class="lineno">   61</span>      constants.<a class="code hl_function" href="classonert_1_1ir_1_1_operand_index_sequence.html#a9e8f537f480cdb2cc219452180ca3036">append</a>(ind);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">if</span> (!tensor_builder-&gt;isRegistered(ind))</div>
<div class="line"><span class="lineno">   64</span>    {</div>
<div class="line"><span class="lineno">   65</span>      <span class="comment">// These tensors do not exist in any  (No use and def)</span></div>
<div class="line"><span class="lineno">   66</span>      <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="library__info_8cc.html#a54f2e176d30fe963addf60c313ccd9ca">info</a> = obj.info();</div>
<div class="line"><span class="lineno">   67</span>      <span class="comment">// NOTE Currently we only support NHWC tensors for cpu-common tensors.</span></div>
<div class="line"><span class="lineno">   68</span>      <span class="comment">//      There is no way to get the layout info from the backend context for now.</span></div>
<div class="line"><span class="lineno">   69</span>      <span class="comment">//      When we support NCHW tensors as well, we also need to change tensor info to be</span></div>
<div class="line"><span class="lineno">   70</span>      <span class="comment">//      permuted shape.</span></div>
<div class="line"><span class="lineno">   71</span>      assert(ctx.operand_layouts().at(ind) == ir::Layout::NHWC);</div>
<div class="line"><span class="lineno">   72</span>      tensor_builder-&gt;registerTensorInfo(ind, <a class="code hl_variable" href="library__info_8cc.html#a54f2e176d30fe963addf60c313ccd9ca">info</a>, ir::Layout::NHWC);</div>
<div class="line"><span class="lineno">   73</span>    }</div>
<div class="line"><span class="lineno">   74</span>  });</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// Start scanning to do notify{First|Last}Use for each tensor</span></div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  <span class="comment">// If a tensor is a constant, increase the use of the tensor and allocate it first.</span></div>
<div class="line"><span class="lineno">   79</span>  <span class="comment">// Increasing use count here makes the tensor never be deallocated, i.e it they will be</span></div>
<div class="line"><span class="lineno">   80</span>  <span class="comment">// deallocated last.</span></div>
<div class="line"><span class="lineno">   81</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;ind : constants)</div>
<div class="line"><span class="lineno">   82</span>  {</div>
<div class="line"><span class="lineno">   83</span>    uses_map[ind]++;</div>
<div class="line"><span class="lineno">   84</span>    tensor_builder-&gt;notifyFirstUse(ind);</div>
<div class="line"><span class="lineno">   85</span>  }</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : def_map)</div>
<div class="line"><span class="lineno">   88</span>  {</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">if</span> (pair.second == 0)</div>
<div class="line"><span class="lineno">   90</span>      tensor_builder-&gt;notifyFirstUse(pair.first);</div>
<div class="line"><span class="lineno">   91</span>  }</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="comment">// This is a workaround to keep the operands over the execution</span></div>
<div class="line"><span class="lineno">   94</span>  <span class="comment">// (the operands look like they are unused)</span></div>
<div class="line"><span class="lineno">   95</span>  std::vector&lt;ir::OperandIndex&gt; operands_last_until_end;</div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pair : uses_map)</div>
<div class="line"><span class="lineno">   97</span>  {</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (pair.second == 0)</div>
<div class="line"><span class="lineno">   99</span>      operands_last_until_end.push_back(pair.first);</div>
<div class="line"><span class="lineno">  100</span>  }</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  <span class="comment">// At each operation,</span></div>
<div class="line"><span class="lineno">  103</span>  <span class="comment">// 1. Scan DEF of outputs. If the DEF, allocate it</span></div>
<div class="line"><span class="lineno">  104</span>  <span class="comment">// 2. Scan DEF of inputs. If variable tensor, allocate it</span></div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">// 3. Scan USE of inputs. Decrease the USE and deallocate if the USE is 0</span></div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;op_ind : order)</div>
<div class="line"><span class="lineno">  107</span>  {</div>
<div class="line"><span class="lineno">  108</span>    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;op = <a class="code hl_variable" href="namespace_gen_h5_random_inputs.html#ac7f0f74f10011f31ef450dc70f8918af">graph</a>.operations().at(op_ind);</div>
<div class="line"><span class="lineno">  109</span>    <span class="keyword">auto</span> op_inputs = op.getInputs() | ir::Remove::DUPLICATED | ir::Remove::UNDEFINED;</div>
<div class="line"><span class="lineno">  110</span>    <span class="keyword">auto</span> op_outputs = op.getOutputs() | ir::Remove::DUPLICATED | ir::Remove::UNDEFINED;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="comment">// Define outputs</span></div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;ind : op_outputs)</div>
<div class="line"><span class="lineno">  114</span>    {</div>
<div class="line"><span class="lineno">  115</span>      <span class="keywordflow">if</span> (ctx.external_operands().contains(ind))</div>
<div class="line"><span class="lineno">  116</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  117</span>      <span class="keywordflow">if</span> (!tensor_builder-&gt;isRegistered(ind))</div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  119</span>      assert(def_map.find(ind) != def_map.end());</div>
<div class="line"><span class="lineno">  120</span>      <span class="keywordflow">if</span> (def_map[ind])</div>
<div class="line"><span class="lineno">  121</span>      {</div>
<div class="line"><span class="lineno">  122</span>        def_map[ind] = 0;</div>
<div class="line"><span class="lineno">  123</span>        tensor_builder-&gt;notifyFirstUse(ind);</div>
<div class="line"><span class="lineno">  124</span>      }</div>
<div class="line"><span class="lineno">  125</span>    }</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <span class="comment">// Scan variable tensors</span></div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">// This tensor has features like constant. But OperandInfo and LowerInfo treat them as</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="comment">// non-constant because of less memory usage by memory planning in here</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;ind : op_inputs)</div>
<div class="line"><span class="lineno">  131</span>    {</div>
<div class="line"><span class="lineno">  132</span>      <span class="keywordflow">if</span> (ctx.external_operands().contains(ind))</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  134</span>      <span class="keywordflow">if</span> (!tensor_builder-&gt;isRegistered(ind))</div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  136</span>      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;operand = <a class="code hl_variable" href="namespace_gen_h5_random_inputs.html#ac7f0f74f10011f31ef450dc70f8918af">graph</a>.operands().at(ind);</div>
<div class="line"><span class="lineno">  137</span>      <span class="keywordflow">if</span> (operand.info().isVariable())</div>
<div class="line"><span class="lineno">  138</span>      {</div>
<div class="line"><span class="lineno">  139</span>        <span class="comment">// The variable tensor with buffer is not supported yet</span></div>
<div class="line"><span class="lineno">  140</span>        assert(operand.data() == <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  141</span>        assert(operand.getUses().size() == 1 &amp;&amp; !operand.getDef().valid());</div>
<div class="line"><span class="lineno">  142</span>        assert(uses_map[ind] == 1 &amp;&amp; def_map[ind] == 0);</div>
<div class="line"><span class="lineno">  143</span>        tensor_builder-&gt;notifyFirstUse(ind);</div>
<div class="line"><span class="lineno">  144</span>      }</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;ind : op_inputs)</div>
<div class="line"><span class="lineno">  148</span>    {</div>
<div class="line"><span class="lineno">  149</span>      <span class="keywordflow">if</span> (ctx.external_operands().contains(ind))</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  151</span>      <span class="keywordflow">if</span> (!tensor_builder-&gt;isRegistered(ind))</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  153</span>      assert(uses_map.find(ind) != uses_map.end());</div>
<div class="line"><span class="lineno">  154</span>      assert(uses_map[ind] &gt; 0);</div>
<div class="line"><span class="lineno">  155</span>      uses_map[ind]--;</div>
<div class="line"><span class="lineno">  156</span>      <span class="keywordflow">if</span> (uses_map[ind] == 0)</div>
<div class="line"><span class="lineno">  157</span>      {</div>
<div class="line"><span class="lineno">  158</span>        <span class="comment">// plan for deallocation of static tensornode</span></div>
<div class="line"><span class="lineno">  159</span>        tensor_builder-&gt;notifyLastUse(ind);</div>
<div class="line"><span class="lineno">  160</span>      }</div>
<div class="line"><span class="lineno">  161</span>    }</div>
<div class="line"><span class="lineno">  162</span>  }</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;ind : operands_last_until_end)</div>
<div class="line"><span class="lineno">  165</span>  {</div>
<div class="line"><span class="lineno">  166</span>    tensor_builder-&gt;notifyLastUse(ind);</div>
<div class="line"><span class="lineno">  167</span>  }</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>  <span class="comment">// Dispose and validate</span></div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;ind : constants)</div>
<div class="line"><span class="lineno">  171</span>  {</div>
<div class="line"><span class="lineno">  172</span>    --uses_map[ind];</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">if</span> (uses_map[ind] == 0) <span class="comment">// To prevent notifyLastUse from being called twice</span></div>
<div class="line"><span class="lineno">  174</span>    {</div>
<div class="line"><span class="lineno">  175</span>      tensor_builder-&gt;notifyLastUse(ind);</div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span>  }</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>  assert(</div>
<div class="line"><span class="lineno">  180</span>    std::all_of(uses_map.begin(), uses_map.end(),</div>
<div class="line"><span class="lineno">  181</span>                [](std::pair&lt;const ir::OperandIndex, uint32_t&gt; it) { return it.second == 0; }));</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  assert(</div>
<div class="line"><span class="lineno">  184</span>    std::all_of(def_map.begin(), def_map.end(),</div>
<div class="line"><span class="lineno">  185</span>                [](std::pair&lt;const ir::OperandIndex, uint32_t&gt; it) { return it.second == 0; }));</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="aclassonert_1_1ir_1_1_operand_index_sequence_html"><div class="ttname"><a href="classonert_1_1ir_1_1_operand_index_sequence.html">onert::ir::OperandIndexSequence</a></div><div class="ttdef"><b>Definition:</b> <a href="_operand_index_sequence_8h_source.html#l00036">OperandIndexSequence.h:37</a></div></div>
<div class="ttc" id="aclassonert_1_1ir_1_1_operand_index_sequence_html_a9e8f537f480cdb2cc219452180ca3036"><div class="ttname"><a href="classonert_1_1ir_1_1_operand_index_sequence.html#a9e8f537f480cdb2cc219452180ca3036">onert::ir::OperandIndexSequence::append</a></div><div class="ttdeci">void append(const OperandIndex &amp;index)</div><div class="ttdef"><b>Definition:</b> <a href="_operand_index_sequence_8h_source.html#l00045">OperandIndexSequence.h:45</a></div></div>
<div class="ttc" id="alibrary__info_8cc_html_a54f2e176d30fe963addf60c313ccd9ca"><div class="ttname"><a href="library__info_8cc.html#a54f2e176d30fe963addf60c313ccd9ca">info</a></div><div class="ttdeci">volatile const char info[]</div><div class="ttdef"><b>Definition:</b> <a href="library__info_8cc_source.html#l00017">library_info.cc:17</a></div></div>
<div class="ttc" id="anamespace_gen_h5_random_inputs_html_ac7f0f74f10011f31ef450dc70f8918af"><div class="ttname"><a href="namespace_gen_h5_random_inputs.html#ac7f0f74f10011f31ef450dc70f8918af">GenH5RandomInputs.graph</a></div><div class="ttdeci">graph</div><div class="ttdef"><b>Definition:</b> <a href="_gen_h5_random_inputs_8py_source.html#l00048">GenH5RandomInputs.py:48</a></div></div>
<div class="ttc" id="anamespaceonert_1_1ir_html_a8d1d09cc0eb99dc03e422dbe13dccce3"><div class="ttname"><a href="namespaceonert_1_1ir.html#a8d1d09cc0eb99dc03e422dbe13dccce3">onert::ir::OperandIndexMap</a></div><div class="ttdeci">std::unordered_map&lt; OperandIndex, T &gt; OperandIndexMap</div><div class="ttdef"><b>Definition:</b> <a href="_operand_index_map_8h_source.html#l00029">OperandIndexMap.h:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_operand_index_sequence_8h_source.html#l00045">onert::ir::OperandIndexSequence::append()</a>, <a class="el" href="namespaceonert_1_1ir.html#a5e8296b1d63c853b1ea62276ed809e54a1d840e66127ec54a19244f29a07fb8b8">onert::ir::DUPLICATED</a>, <a class="el" href="library__info_8cc_source.html#l00017">info</a>, <a class="el" href="namespaceonert_1_1ir.html#ae8c0846bdada8dcd2c06205bb4a8a4e2ad066db54b89b0912e7e7c6da51e2da51">onert::ir::NHWC</a>, and <a class="el" href="namespaceonert_1_1ir.html#a5e8296b1d63c853b1ea62276ed809e54a0db45d2a4141101bdfe48e3314cfbca3">onert::ir::UNDEFINED</a>.</p>

<p class="reference">Referenced by <a class="el" href="_backend_context_helpers_8h_source.html#l00188">genTensors()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceonert.html">onert</a></li><li class="navelem"><a class="el" href="namespaceonert_1_1backend.html">backend</a></li><li class="navelem"><a class="el" href="namespaceonert_1_1backend_1_1basic.html">basic</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
