<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ONE - On-device Neural Engine: luci_interpreter_pal::lstm Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ONE - On-device Neural Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceluci__interpreter__pal_1_1lstm.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">luci_interpreter_pal::lstm Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae73bbfa7d9e0192734d7e01e5c05df63"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63">TfLiteFusedActivation</a> { <br />
&#160;&#160;<a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a611f6492ff91826833d1b9e42f7f9a5e">kTfLiteActNone</a> = 0
, <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a06a35e36dd2f10a2e82095f663eb7cb7">kTfLiteActRelu</a>
, <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a9f385b0941a619677310da5deb8c0751">kTfLiteActReluN1To1</a>
, <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63adcc6c589b6ffe8ff89fd701c70b38342">kTfLiteActRelu6</a>
, <br />
&#160;&#160;<a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a60bdd9a337a5f1f2866fd65c7d8ffdce">kTfLiteActTanh</a>
, <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63ad5ee29be46ddc348e9865b96129a533a">kTfLiteActSignBit</a>
, <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63ab211c831f880a63ebc80994bb0cf2dc2">kTfLiteActSigmoid</a>
<br />
 }</td></tr>
<tr class="separator:ae73bbfa7d9e0192734d7e01e5c05df63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a15e54cf21be2fb24c7575d140e2a8d1a"><td class="memItemLeft" align="right" valign="top">cmsis_nn_lstm_params&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a15e54cf21be2fb24c7575d140e2a8d1a">convert_lstm_params</a> (const <a class="el" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html">luci_interpreter::IntegerLSTMParams</a> &amp;params_in, bool time_major, int32_t output_zeropoint, const int32_t *input_gate_bias, const int32_t *forget_gate_bias, const int32_t *cell_gate_bias, const int32_t *output_gate_bias, int16_t *input_layer_norm_coefficients, int16_t *forget_layer_norm_coefficients, int16_t *cell_layer_norm_coefficients, int16_t *output_layer_norm_coefficients)</td></tr>
<tr class="separator:a15e54cf21be2fb24c7575d140e2a8d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe525077503e0d3f37d59b7fc8276e2"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#acbe525077503e0d3f37d59b7fc8276e2">multiply_by_quantized_multiplier</a> (int32_t x, int32_t quantized_multiplier, int shift)</td></tr>
<tr class="separator:acbe525077503e0d3f37d59b7fc8276e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13269908e5cbb4827f974e782b98f6b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a13269908e5cbb4827f974e782b98f6b2">cwise_mul</a> (const int16_t *input_1, const int16_t *input_2, int32_t multiplier, int32_t shift, int32_t n_batch, int32_t n_input, int32_t output_zp, int8_t *output)</td></tr>
<tr class="separator:a13269908e5cbb4827f974e782b98f6b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3a8ce5736307c9146154fd4639e0cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a7b3a8ce5736307c9146154fd4639e0cb">sub1_vector</a> (const int16_t *vector, int v_size, int16_t *result)</td></tr>
<tr class="separator:a7b3a8ce5736307c9146154fd4639e0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e414d74814834c72b789c80e68e843b"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a4e414d74814834c72b789c80e68e843b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a4e414d74814834c72b789c80e68e843b">cwise_clipping</a> (T *vector, const int v_size, const T &amp;clipping_value)</td></tr>
<tr class="separator:a4e414d74814834c72b789c80e68e843b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4923cae88d2f75c29b49c78c9a00f99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#af4923cae88d2f75c29b49c78c9a00f99">cwise_add</a> (const int16_t *input_1, const int16_t *input_2, int n_batch, int n_input, int16_t *output)</td></tr>
<tr class="separator:af4923cae88d2f75c29b49c78c9a00f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acef25fe5a003e2ff65b2c8ccb2711207"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:acef25fe5a003e2ff65b2c8ccb2711207"><td class="memTemplItemLeft" align="right" valign="top">int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#acef25fe5a003e2ff65b2c8ccb2711207">count_leading_zeros</a> (T integer_input)</td></tr>
<tr class="separator:acef25fe5a003e2ff65b2c8ccb2711207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2d78fd09384fe6419222fac94e71b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a4a2d78fd09384fe6419222fac94e71b3">get_inv_sqrt_quantized_multiplier_exp</a> (int32_t input, int reverse_shift, int32_t *output_inv_sqrt, int *output_shift)</td></tr>
<tr class="separator:a4a2d78fd09384fe6419222fac94e71b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c34168ef2084dd14025705bf93271ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a9c34168ef2084dd14025705bf93271ed">apply_layer_norm</a> (const int16_t *input, const int16_t *layer_norm_weights, const int32_t *bias, int32_t layer_norm_scale_a, int32_t layer_norm_scale_b, int32_t variance_limit, int n_batch, int n_input, int16_t *output)</td></tr>
<tr class="separator:a9c34168ef2084dd14025705bf93271ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7361af5bb813813c50859760c4cc8f8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#a7361af5bb813813c50859760c4cc8f8a">vector_batch_vector_cwise_product_accumulate</a> (const int16_t *vector, int v_size, const int16_t *batch_vector, int n_batch, int32_t multiplier, int shift, int16_t *result)</td></tr>
<tr class="separator:a7361af5bb813813c50859760c4cc8f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9970c643958b6d2c26dcd2506bac62b"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ad9970c643958b6d2c26dcd2506bac62b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ad9970c643958b6d2c26dcd2506bac62b">matrix_batch_vector_multiply_accumulate</a> (const int8_t *input, const int32_t *bias, const int8_t *input_to_gate_weights, int32_t multiplier, int32_t shift, int32_t n_batch, int32_t n_input, int32_t n_output, int32_t output_zp, T *output)</td></tr>
<tr class="separator:ad9970c643958b6d2c26dcd2506bac62b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16a4f8e96b58833ba85f9b5ef120b6c"><td class="memTemplParams" colspan="2">template&lt;int IntegerBits&gt; </td></tr>
<tr class="memitem:af16a4f8e96b58833ba85f9b5ef120b6c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#af16a4f8e96b58833ba85f9b5ef120b6c">apply_tanh_impl</a> (const int16_t *input, int32_t n_batch, int32_t n_input, int16_t *output)</td></tr>
<tr class="separator:af16a4f8e96b58833ba85f9b5ef120b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5995c2f4e037e3d18ef8f0462079564"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae5995c2f4e037e3d18ef8f0462079564">apply_tanh</a> (int32_t integer_bits, const int16_t *input, int32_t n_batch, int32_t n_input, int16_t *output)</td></tr>
<tr class="separator:ae5995c2f4e037e3d18ef8f0462079564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07afcc83af092c475787d8184538098"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ad07afcc83af092c475787d8184538098">calculate_lstm_output_integer8x8_16</a> (int n_batch, int n_cell, int n_output, int16_t *cell_state, int32_t cell_state_scale, const int16_t *output_gate, int32_t hidden_scale_a, int32_t hidden_scale_b, int32_t hidden_zp, const int8_t *projection_weights, int32_t proj_scale_a, int32_t proj_scale_b, const int32_t *projection_bias, int32_t output_state_zp, int8_t quantized_proj_clip, int8_t *output_state, int16_t *scratch0, int8_t *scratch1, int32_t *scratch2)</td></tr>
<tr class="separator:ad07afcc83af092c475787d8184538098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b6a487395ebcaaef58516ae80581a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ad0b6a487395ebcaaef58516ae80581a7">cwise_mul</a> (const int16_t *input_1, const int16_t *input_2, int n_batch, int n_input, int shift, int16_t *output)</td></tr>
<tr class="separator:ad0b6a487395ebcaaef58516ae80581a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab554f067a0e70af0121424c774ad3880"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ab554f067a0e70af0121424c774ad3880">update_lstm_cell_integer</a> (int n_batch, int n_cell, int16_t *cell_state, int32_t cell_state_scale, const int16_t *input_gate, int16_t *forget_gate, const int16_t *cell_gate, bool use_cifg, int16_t clip)</td></tr>
<tr class="separator:ab554f067a0e70af0121424c774ad3880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa95dd338f0bbd9be680fd7dfc6d1aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#adaa95dd338f0bbd9be680fd7dfc6d1aa">calculate_lstm_gate_integer_8x8_16</a> (const int8_t *input, const int8_t *input_to_gate_weights, const int32_t *input_to_gate_bias, const int32_t input_to_gate_scale_a, const int32_t input_to_gate_scale_b, const int8_t *output_state, const int8_t *recurrent_to_gate_weights, const int32_t *recurrent_to_gate_bias, const int32_t recurrent_to_gate_scale_a, const int32_t recurrent_to_gate_scale_b, const int16_t *cell_state, const int16_t *cell_to_gate_weights, const int32_t cell_to_gate_scale_a, const int32_t cell_to_gate_scale_b, const int16_t *layer_norm_coefficients, const int32_t *layer_norm_bias, const int32_t layer_norm_input_scale_a, const int32_t layer_norm_input_scale_b, const int32_t layer_norm_variance_guard, const int n_batch, const int n_input, const int n_output, const int n_cell, const <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63">TfLiteFusedActivation</a> activation, int16_t *gate, int32_t *scratch5)</td></tr>
<tr class="separator:adaa95dd338f0bbd9be680fd7dfc6d1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff32234d5392b0c7fdbccc7cad115c0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#aff32234d5392b0c7fdbccc7cad115c0e">lstm_step_integer_8x8_16</a> (const int8_t *input_ptr, const int8_t *input_to_input_weight_ptr, int32_t effective_input_to_input_scale_a, int32_t effective_input_to_input_scale_b, const int8_t *input_to_forget_weight_ptr, int32_t effective_input_to_forget_scale_a, int32_t effective_input_to_forget_scale_b, const int8_t *input_to_cell_weight_ptr, int32_t effective_input_to_cell_scale_a, int32_t effective_input_to_cell_scale_b, const int8_t *input_to_output_weight_ptr, int32_t effective_input_to_output_scale_a, int32_t effective_input_to_output_scale_b, const int8_t *recurrent_to_input_weight_ptr, int32_t effective_recurrent_to_input_scale_a, int32_t effective_recurrent_to_input_scale_b, const int8_t *recurrent_to_forget_weight_ptr, int32_t effective_recurrent_to_forget_scale_a, int32_t effective_recurrent_to_forget_scale_b, const int8_t *recurrent_to_cell_weight_ptr, int32_t effective_recurrent_to_cell_scale_a, int32_t effective_recurrent_to_cell_scale_b, const int8_t *recurrent_to_output_weight_ptr, int32_t effective_recurrent_to_output_scale_a, int32_t effective_recurrent_to_output_scale_b, const int16_t *cell_to_input_weight_ptr, int32_t effective_cell_to_input_scale_a, int32_t effective_cell_to_input_scale_b, const int16_t *cell_to_forget_weight_ptr, int32_t effective_cell_to_forget_scale_a, int32_t effective_cell_to_forget_scale_b, const int16_t *cell_to_output_weight_ptr, int32_t effective_cell_to_output_scale_a, int32_t effective_cell_to_output_scale_b, const int8_t *projection_weight_ptr, int32_t effective_proj_scale_a, int32_t effective_proj_scale_b, int32_t hidden_zp, int32_t effective_hidden_scale_a, int32_t effective_hidden_scale_b, const int16_t *layer_norm_input_weight_ptr, int32_t layer_norm_input_scale_a, int32_t layer_norm_input_scale_b, const int16_t *layer_norm_forget_weight_ptr, int32_t layer_norm_forget_scale_a, int32_t layer_norm_forget_scale_b, const int16_t *layer_norm_cell_weight_ptr, int32_t layer_norm_cell_scale_a, int32_t layer_norm_cell_scale_b, const int16_t *layer_norm_output_weight_ptr, int32_t layer_norm_output_scale_a, int32_t layer_norm_output_scale_b, const int32_t *input_gate_bias_ptr, const int32_t *forget_gate_bias_ptr, const int32_t *cell_gate_bias_ptr, const int32_t *output_gate_bias_ptr, int16_t quantized_cell_clip, int8_t quantized_proj_clip, int32_t cell_state_scale, int32_t input_variance_guard, int32_t forget_variance_guard, int32_t cell_variance_guard, int32_t output_variance_guard, const int32_t *input_to_forget_effective_bias, const int32_t *recurrent_to_forget_effective_bias, const int32_t *input_to_cell_effective_bias, const int32_t *recurrent_to_cell_effective_bias, const int32_t *input_to_output_effective_bias, const int32_t *recurrent_to_output_effective_bias, const int32_t *input_to_input_effective_bias, const int32_t *recurrent_to_input_effective_bias, const int32_t *projection_effective_bias, int n_batch, int n_cell, int n_input, int n_output, int8_t *output_state_ptr, int32_t output_state_zp, int16_t *cell_state_ptr, int8_t *output_ptr, int16_t *scratch0, int16_t *scratch1, int16_t *scratch2, int16_t *scratch3, int8_t *scratch4, int32_t *scratch5)</td></tr>
<tr class="separator:aff32234d5392b0c7fdbccc7cad115c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ae73bbfa7d9e0192734d7e01e5c05df63" name="ae73bbfa7d9e0192734d7e01e5c05df63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae73bbfa7d9e0192734d7e01e5c05df63">&#9670;&#160;</a></span>TfLiteFusedActivation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63">luci_interpreter_pal::lstm::TfLiteFusedActivation</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63a611f6492ff91826833d1b9e42f7f9a5e" name="ae73bbfa7d9e0192734d7e01e5c05df63a611f6492ff91826833d1b9e42f7f9a5e"></a>kTfLiteActNone&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63a06a35e36dd2f10a2e82095f663eb7cb7" name="ae73bbfa7d9e0192734d7e01e5c05df63a06a35e36dd2f10a2e82095f663eb7cb7"></a>kTfLiteActRelu&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63a9f385b0941a619677310da5deb8c0751" name="ae73bbfa7d9e0192734d7e01e5c05df63a9f385b0941a619677310da5deb8c0751"></a>kTfLiteActReluN1To1&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63adcc6c589b6ffe8ff89fd701c70b38342" name="ae73bbfa7d9e0192734d7e01e5c05df63adcc6c589b6ffe8ff89fd701c70b38342"></a>kTfLiteActRelu6&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63a60bdd9a337a5f1f2866fd65c7d8ffdce" name="ae73bbfa7d9e0192734d7e01e5c05df63a60bdd9a337a5f1f2866fd65c7d8ffdce"></a>kTfLiteActTanh&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63ad5ee29be46ddc348e9865b96129a533a" name="ae73bbfa7d9e0192734d7e01e5c05df63ad5ee29be46ddc348e9865b96129a533a"></a>kTfLiteActSignBit&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ae73bbfa7d9e0192734d7e01e5c05df63ab211c831f880a63ebc80994bb0cf2dc2" name="ae73bbfa7d9e0192734d7e01e5c05df63ab211c831f880a63ebc80994bb0cf2dc2"></a>kTfLiteActSigmoid&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00031">31</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>{</div>
<div class="line"><span class="lineno">   33</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a611f6492ff91826833d1b9e42f7f9a5e">kTfLiteActNone</a> = 0,</div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a06a35e36dd2f10a2e82095f663eb7cb7">kTfLiteActRelu</a>,</div>
<div class="line"><span class="lineno">   35</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a9f385b0941a619677310da5deb8c0751">kTfLiteActReluN1To1</a>, <span class="comment">// min(max(-1, x), 1)</span></div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63adcc6c589b6ffe8ff89fd701c70b38342">kTfLiteActRelu6</a>,     <span class="comment">// min(max(0, x), 6)</span></div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a60bdd9a337a5f1f2866fd65c7d8ffdce">kTfLiteActTanh</a>,</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63ad5ee29be46ddc348e9865b96129a533a">kTfLiteActSignBit</a>,</div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_enumvalue" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63ab211c831f880a63ebc80994bb0cf2dc2">kTfLiteActSigmoid</a>,</div>
<div class="line"><span class="lineno">   40</span>} TfLiteFusedActivation;</div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63a06a35e36dd2f10a2e82095f663eb7cb7"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a06a35e36dd2f10a2e82095f663eb7cb7">luci_interpreter_pal::lstm::kTfLiteActRelu</a></div><div class="ttdeci">@ kTfLiteActRelu</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00034">PALUnidirectionalSequenceLSTM.h:34</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63a60bdd9a337a5f1f2866fd65c7d8ffdce"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a60bdd9a337a5f1f2866fd65c7d8ffdce">luci_interpreter_pal::lstm::kTfLiteActTanh</a></div><div class="ttdeci">@ kTfLiteActTanh</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00037">PALUnidirectionalSequenceLSTM.h:37</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63a611f6492ff91826833d1b9e42f7f9a5e"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a611f6492ff91826833d1b9e42f7f9a5e">luci_interpreter_pal::lstm::kTfLiteActNone</a></div><div class="ttdeci">@ kTfLiteActNone</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00033">PALUnidirectionalSequenceLSTM.h:33</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63a9f385b0941a619677310da5deb8c0751"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63a9f385b0941a619677310da5deb8c0751">luci_interpreter_pal::lstm::kTfLiteActReluN1To1</a></div><div class="ttdeci">@ kTfLiteActReluN1To1</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00035">PALUnidirectionalSequenceLSTM.h:35</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63ab211c831f880a63ebc80994bb0cf2dc2"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63ab211c831f880a63ebc80994bb0cf2dc2">luci_interpreter_pal::lstm::kTfLiteActSigmoid</a></div><div class="ttdeci">@ kTfLiteActSigmoid</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00039">PALUnidirectionalSequenceLSTM.h:39</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63ad5ee29be46ddc348e9865b96129a533a"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63ad5ee29be46ddc348e9865b96129a533a">luci_interpreter_pal::lstm::kTfLiteActSignBit</a></div><div class="ttdeci">@ kTfLiteActSignBit</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00038">PALUnidirectionalSequenceLSTM.h:38</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae73bbfa7d9e0192734d7e01e5c05df63adcc6c589b6ffe8ff89fd701c70b38342"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63adcc6c589b6ffe8ff89fd701c70b38342">luci_interpreter_pal::lstm::kTfLiteActRelu6</a></div><div class="ttdeci">@ kTfLiteActRelu6</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00036">PALUnidirectionalSequenceLSTM.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9c34168ef2084dd14025705bf93271ed" name="a9c34168ef2084dd14025705bf93271ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c34168ef2084dd14025705bf93271ed">&#9670;&#160;</a></span>apply_layer_norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::apply_layer_norm </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>layer_norm_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>variance_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00186">186</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>{</div>
<div class="line"><span class="lineno">  190</span>  <span class="comment">// The square of std::pow(2, 10), which is the extra factor that makes sure</span></div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">// normalized values has enough resolution.</span></div>
<div class="line"><span class="lineno">  192</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kTwoToPower20 = 1 &lt;&lt; 20;</div>
<div class="line"><span class="lineno">  193</span>  <span class="keyword">const</span> int32_t kInt16Max = std::numeric_limits&lt;int16_t&gt;::max();</div>
<div class="line"><span class="lineno">  194</span>  <span class="keyword">const</span> int32_t kInt16Min = std::numeric_limits&lt;int16_t&gt;::min();</div>
<div class="line"><span class="lineno">  195</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_batch; ++i)</div>
<div class="line"><span class="lineno">  196</span>  {</div>
<div class="line"><span class="lineno">  197</span>    int64_t sum = 0;</div>
<div class="line"><span class="lineno">  198</span>    int64_t sum_sq = 0;</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n_input; ++j)</div>
<div class="line"><span class="lineno">  200</span>    {</div>
<div class="line"><span class="lineno">  201</span>      <span class="keyword">const</span> int32_t index = i * n_input + j;</div>
<div class="line"><span class="lineno">  202</span>      int32_t val = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(input[index]);</div>
<div class="line"><span class="lineno">  203</span>      sum += val;</div>
<div class="line"><span class="lineno">  204</span>      sum_sq += val * val;</div>
<div class="line"><span class="lineno">  205</span>    }</div>
<div class="line"><span class="lineno">  206</span>    int32_t mean = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(sum) * 1024 / n_input);</div>
<div class="line"><span class="lineno">  207</span>    <span class="comment">// TODO Avoids overflow but only works for POT n_input.</span></div>
<div class="line"><span class="lineno">  208</span>    int32_t temp = kTwoToPower20 / n_input;</div>
<div class="line"><span class="lineno">  209</span>    int64_t variance = sum_sq * temp - <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(mean) * <span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(mean);</div>
<div class="line"><span class="lineno">  210</span>    int32_t variance2 = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(variance / kTwoToPower20);</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> (variance2 &lt; 1)</div>
<div class="line"><span class="lineno">  212</span>    {</div>
<div class="line"><span class="lineno">  213</span>      variance2 = variance_limit;</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="line"><span class="lineno">  215</span>    int32_t stddev_inverse_a;</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordtype">int</span> stddev_inverse_b;</div>
<div class="line"><span class="lineno">  217</span>    get_inv_sqrt_quantized_multiplier_exp(variance2, <span class="comment">/*reverse_shift*/</span> -1, &amp;stddev_inverse_a,</div>
<div class="line"><span class="lineno">  218</span>                                          &amp;stddev_inverse_b);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n_input; ++j)</div>
<div class="line"><span class="lineno">  221</span>    {</div>
<div class="line"><span class="lineno">  222</span>      <span class="keyword">const</span> int32_t index = i * n_input + j;</div>
<div class="line"><span class="lineno">  223</span>      int32_t val = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(input[index]);</div>
<div class="line"><span class="lineno">  224</span>      int32_t shifted = 1024 * val - mean;</div>
<div class="line"><span class="lineno">  225</span>      int32_t rescaled =</div>
<div class="line"><span class="lineno">  226</span>        multiply_by_quantized_multiplier(shifted, stddev_inverse_a, stddev_inverse_b);</div>
<div class="line"><span class="lineno">  227</span>      <span class="comment">// TODO: Saturate this.</span></div>
<div class="line"><span class="lineno">  228</span>      int64_t val3 = rescaled * layer_norm_weights[j] + bias[j];</div>
<div class="line"><span class="lineno">  229</span>      int32_t val4 = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>((val3 &gt; 0 ? val3 + 512 : val3 - 512) / 1024);</div>
<div class="line"><span class="lineno">  230</span>      int32_t val5 =</div>
<div class="line"><span class="lineno">  231</span>        multiply_by_quantized_multiplier(val4, layer_norm_scale_a, layer_norm_scale_b + 12);</div>
<div class="line"><span class="lineno">  232</span>      val5 = std::min(std::max(kInt16Min, val5), kInt16Max);</div>
<div class="line"><span class="lineno">  233</span>      output[index] = <span class="keyword">static_cast&lt;</span>int16_t<span class="keyword">&gt;</span>(val5);</div>
<div class="line"><span class="lineno">  234</span>    }</div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="line"><span class="lineno">  236</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00128">get_inv_sqrt_quantized_multiplier_exp()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00042">multiply_by_quantized_multiplier()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00443">calculate_lstm_gate_integer_8x8_16()</a>.</p>

</div>
</div>
<a id="ae5995c2f4e037e3d18ef8f0462079564" name="ae5995c2f4e037e3d18ef8f0462079564"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5995c2f4e037e3d18ef8f0462079564">&#9670;&#160;</a></span>apply_tanh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::apply_tanh </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>integer_bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00309">309</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>{</div>
<div class="line"><span class="lineno">  312</span>  assert(integer_bits &lt;= 6);</div>
<div class="line"><span class="lineno">  313</span><span class="preprocessor">#define DISPATCH_TANH(i)                                 \</span></div>
<div class="line"><span class="lineno">  314</span><span class="preprocessor">  case i:                                                \</span></div>
<div class="line"><span class="lineno">  315</span><span class="preprocessor">    apply_tanh_impl&lt;i&gt;(input, n_batch, n_input, output); \</span></div>
<div class="line"><span class="lineno">  316</span><span class="preprocessor">    break;</span></div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordflow">switch</span> (integer_bits)</div>
<div class="line"><span class="lineno">  318</span>  {</div>
<div class="line"><span class="lineno">  319</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(0);</div>
<div class="line"><span class="lineno">  320</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(1);</div>
<div class="line"><span class="lineno">  321</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(2);</div>
<div class="line"><span class="lineno">  322</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(3);</div>
<div class="line"><span class="lineno">  323</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(4);</div>
<div class="line"><span class="lineno">  324</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(5);</div>
<div class="line"><span class="lineno">  325</span>    <a class="code hl_define" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>(6);</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  327</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  328</span>  }</div>
<div class="line"><span class="lineno">  329</span><span class="preprocessor">#undef DISPATCH_TANH</span></div>
<div class="line"><span class="lineno">  330</span>}</div>
<div class="ttc" id="amcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_html_a740521307802d978b1a8134e3eb4acf9"><div class="ttname"><a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a></div><div class="ttdeci">#define DISPATCH_TANH(i)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h.html#a740521307802d978b1a8134e3eb4acf9">DISPATCH_TANH</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">calculate_lstm_output_integer8x8_16()</a>.</p>

</div>
</div>
<a id="af16a4f8e96b58833ba85f9b5ef120b6c" name="af16a4f8e96b58833ba85f9b5ef120b6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16a4f8e96b58833ba85f9b5ef120b6c">&#9670;&#160;</a></span>apply_tanh_impl()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int IntegerBits&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::apply_tanh_impl </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00293">293</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>{</div>
<div class="line"><span class="lineno">  295</span>  <span class="keyword">using </span>FX = gemmlowp::FixedPoint&lt;std::int16_t, IntegerBits&gt;;</div>
<div class="line"><span class="lineno">  296</span>  <span class="keyword">using </span>F0 = gemmlowp::FixedPoint&lt;std::int16_t, 0&gt;;</div>
<div class="line"><span class="lineno">  297</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> batch = 0; batch &lt; n_batch; ++batch)</div>
<div class="line"><span class="lineno">  298</span>  {</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_input; ++i)</div>
<div class="line"><span class="lineno">  300</span>    {</div>
<div class="line"><span class="lineno">  301</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> index = batch * n_input + i;</div>
<div class="line"><span class="lineno">  302</span>      FX tanh_input = FX::FromRaw(input[index]);</div>
<div class="line"><span class="lineno">  303</span>      F0 tanh_output = gemmlowp::tanh(tanh_input);</div>
<div class="line"><span class="lineno">  304</span>      output[index] = tanh_output.raw();</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span>  }</div>
<div class="line"><span class="lineno">  307</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adaa95dd338f0bbd9be680fd7dfc6d1aa" name="adaa95dd338f0bbd9be680fd7dfc6d1aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa95dd338f0bbd9be680fd7dfc6d1aa">&#9670;&#160;</a></span>calculate_lstm_gate_integer_8x8_16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::calculate_lstm_gate_integer_8x8_16 </td>
          <td>(</td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_to_gate_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_to_gate_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>input_to_gate_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>input_to_gate_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>output_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_gate_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_gate_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>recurrent_to_gate_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>recurrent_to_gate_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>cell_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>cell_to_gate_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>cell_to_gate_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>cell_to_gate_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>layer_norm_coefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>layer_norm_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_input_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_input_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_variance_guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html#ae73bbfa7d9e0192734d7e01e5c05df63">TfLiteFusedActivation</a>&#160;</td>
          <td class="paramname"><em>activation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>scratch5</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00443">443</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  466</span>{</div>
<div class="line"><span class="lineno">  467</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_peephole = (cell_to_gate_weights != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  468</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_layer_norm = (layer_norm_coefficients != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <span class="comment">// Initialize scratch buffers with zeros. Note that unlike float and hybrid</span></div>
<div class="line"><span class="lineno">  471</span>  <span class="comment">// versions, bias is only used in layer normalization.</span></div>
<div class="line"><span class="lineno">  472</span>  memset(gate, 0, n_batch * n_cell * <span class="keyword">sizeof</span>(int16_t));</div>
<div class="line"><span class="lineno">  473</span>  <span class="comment">// For each batch and cell: compute input_weight * input.</span></div>
<div class="line"><span class="lineno">  474</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#ad9970c643958b6d2c26dcd2506bac62b">matrix_batch_vector_multiply_accumulate</a>(input, input_to_gate_bias, input_to_gate_weights,</div>
<div class="line"><span class="lineno">  475</span>                                          input_to_gate_scale_a, input_to_gate_scale_b, n_batch,</div>
<div class="line"><span class="lineno">  476</span>                                          n_input, n_cell, 0, gate);</div>
<div class="line"><span class="lineno">  477</span>  <span class="comment">// Note: no aux_input.</span></div>
<div class="line"><span class="lineno">  478</span>  <span class="comment">// For each batch and cell: compute recurrent_weight * output_state.</span></div>
<div class="line"><span class="lineno">  479</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#ad9970c643958b6d2c26dcd2506bac62b">matrix_batch_vector_multiply_accumulate</a>(</div>
<div class="line"><span class="lineno">  480</span>    output_state, recurrent_to_gate_bias, recurrent_to_gate_weights, recurrent_to_gate_scale_a,</div>
<div class="line"><span class="lineno">  481</span>    recurrent_to_gate_scale_b, n_batch, n_output, n_cell, 0, gate);</div>
<div class="line"><span class="lineno">  482</span>  <span class="comment">// For each batch and cell: compute cell_weight * cell_state (peephole LSTM)</span></div>
<div class="line"><span class="lineno">  483</span>  <span class="keywordflow">if</span> (use_peephole)</div>
<div class="line"><span class="lineno">  484</span>  {</div>
<div class="line"><span class="lineno">  485</span>    <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#a7361af5bb813813c50859760c4cc8f8a">vector_batch_vector_cwise_product_accumulate</a>(cell_to_gate_weights, n_output, cell_state,</div>
<div class="line"><span class="lineno">  486</span>                                                 n_batch, cell_to_gate_scale_a,</div>
<div class="line"><span class="lineno">  487</span>                                                 cell_to_gate_scale_b, gate);</div>
<div class="line"><span class="lineno">  488</span>  }</div>
<div class="line"><span class="lineno">  489</span>  <span class="comment">// Do layer normalization (if layer norm LSTM)</span></div>
<div class="line"><span class="lineno">  490</span>  <span class="keywordflow">if</span> (use_layer_norm)</div>
<div class="line"><span class="lineno">  491</span>  {</div>
<div class="line"><span class="lineno">  492</span>    apply_layer_norm(gate, layer_norm_coefficients, layer_norm_bias, layer_norm_input_scale_a,</div>
<div class="line"><span class="lineno">  493</span>                     layer_norm_input_scale_b, layer_norm_variance_guard, n_batch, n_cell, gate);</div>
<div class="line"><span class="lineno">  494</span>  }</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>  <span class="comment">// Apply activation</span></div>
<div class="line"><span class="lineno">  497</span>  <span class="keywordflow">switch</span> (activation)</div>
<div class="line"><span class="lineno">  498</span>  {</div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">case</span> kTfLiteActSigmoid:</div>
<div class="line"><span class="lineno">  500</span>      tflite::reference_integer_ops::Logistic(</div>
<div class="line"><span class="lineno">  501</span>        0 <span class="comment">/*data-&gt;input_multiplier*/</span>, 0 <span class="comment">/*data-&gt;input_left_shift */</span>,</div>
<div class="line"><span class="lineno">  502</span>        n_batch * n_cell <span class="comment">/*NumElements(input-&gt;dims)*/</span>,</div>
<div class="line"><span class="lineno">  503</span>        gate <span class="comment">/* tflite::micro::GetTensorData&lt;int16_t&gt;(input) */</span>,</div>
<div class="line"><span class="lineno">  504</span>        gate <span class="comment">/*tflite::micro::GetTensorData&lt;int16_t&gt;(output) */</span>);</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordflow">case</span> kTfLiteActTanh:</div>
<div class="line"><span class="lineno">  508</span>    {</div>
<div class="line"><span class="lineno">  509</span>      int32_t dims_data = n_batch * n_cell;</div>
<div class="line"><span class="lineno">  510</span>      tflite::RuntimeShape tanh_inp_shape = tflite::RuntimeShape(1, &amp;dims_data);</div>
<div class="line"><span class="lineno">  511</span>      tflite::reference_integer_ops::Tanh(0, 0, tanh_inp_shape, gate, tanh_inp_shape, gate);</div>
<div class="line"><span class="lineno">  512</span>    }</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  515</span>      <span class="comment">// Only Sigmoid or Tanh is used.</span></div>
<div class="line"><span class="lineno">  516</span>      TFLITE_ASSERT_FALSE;</div>
<div class="line"><span class="lineno">  517</span>  }</div>
<div class="line"><span class="lineno">  518</span>}</div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_a7361af5bb813813c50859760c4cc8f8a"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#a7361af5bb813813c50859760c4cc8f8a">luci_interpreter_pal::lstm::vector_batch_vector_cwise_product_accumulate</a></div><div class="ttdeci">void vector_batch_vector_cwise_product_accumulate(const int16_t *vector, int v_size, const int16_t *batch_vector, int n_batch, int32_t multiplier, int shift, int16_t *result)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00238">PALUnidirectionalSequenceLSTM.h:238</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ad9970c643958b6d2c26dcd2506bac62b"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ad9970c643958b6d2c26dcd2506bac62b">luci_interpreter_pal::lstm::matrix_batch_vector_multiply_accumulate</a></div><div class="ttdeci">void matrix_batch_vector_multiply_accumulate(const int8_t *input, const int32_t *bias, const int8_t *input_to_gate_weights, int32_t multiplier, int32_t shift, int32_t n_batch, int32_t n_input, int32_t n_output, int32_t output_zp, T *output)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00257">PALUnidirectionalSequenceLSTM.h:257</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00186">apply_layer_norm()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00039">kTfLiteActSigmoid</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00037">kTfLiteActTanh</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00257">matrix_batch_vector_multiply_accumulate()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00238">vector_batch_vector_cwise_product_accumulate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00612">lstm_step_integer_8x8_16()</a>.</p>

</div>
</div>
<a id="ad07afcc83af092c475787d8184538098" name="ad07afcc83af092c475787d8184538098"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07afcc83af092c475787d8184538098">&#9670;&#160;</a></span>calculate_lstm_output_integer8x8_16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::calculate_lstm_output_integer8x8_16 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>cell_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>cell_state_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>output_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>hidden_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>hidden_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>hidden_zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>projection_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>proj_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>proj_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>projection_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>output_state_zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>quantized_proj_clip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>output_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>scratch0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>scratch1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>scratch2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">350</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  358</span>{</div>
<div class="line"><span class="lineno">  359</span>  <span class="comment">// Note: unlike float/hybrid, the activation is always Tanh.</span></div>
<div class="line"><span class="lineno">  360</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#ae5995c2f4e037e3d18ef8f0462079564">apply_tanh</a>(15 + cell_state_scale, cell_state, n_batch, n_cell, scratch0);</div>
<div class="line"><span class="lineno">  361</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_projection = (projection_weights != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>  <span class="keywordflow">if</span> (use_projection)</div>
<div class="line"><span class="lineno">  364</span>  {</div>
<div class="line"><span class="lineno">  365</span>    <span class="comment">// b/246629213 the projection operation assumes -hidden_zp in CwiseMul</span></div>
<div class="line"><span class="lineno">  366</span>    <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#a13269908e5cbb4827f974e782b98f6b2">cwise_mul</a>(output_gate, scratch0, hidden_scale_a, hidden_scale_b, n_batch, n_cell, -hidden_zp,</div>
<div class="line"><span class="lineno">  367</span>              scratch1);</div>
<div class="line"><span class="lineno">  368</span>    <span class="comment">// Note: no bias like in float/hybrid</span></div>
<div class="line"><span class="lineno">  369</span>    std::fill_n(output_state, n_batch * n_output, 0);</div>
<div class="line"><span class="lineno">  370</span>    <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#ad9970c643958b6d2c26dcd2506bac62b">matrix_batch_vector_multiply_accumulate</a>(scratch1, projection_bias, projection_weights,</div>
<div class="line"><span class="lineno">  371</span>                                            proj_scale_a, proj_scale_b, n_batch, n_cell, n_output,</div>
<div class="line"><span class="lineno">  372</span>                                            output_state_zp, output_state);</div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">if</span> (quantized_proj_clip &gt; 0)</div>
<div class="line"><span class="lineno">  374</span>    {</div>
<div class="line"><span class="lineno">  375</span>      <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#a4e414d74814834c72b789c80e68e843b">cwise_clipping</a>(output_state, n_batch * n_output, quantized_proj_clip);</div>
<div class="line"><span class="lineno">  376</span>    }</div>
<div class="line"><span class="lineno">  377</span>  }</div>
<div class="line"><span class="lineno">  378</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  379</span>  {</div>
<div class="line"><span class="lineno">  380</span>    cwise_mul(output_gate, scratch0, hidden_scale_a, hidden_scale_b, n_batch, n_cell, hidden_zp,</div>
<div class="line"><span class="lineno">  381</span>              output_state);</div>
<div class="line"><span class="lineno">  382</span>  }</div>
<div class="line"><span class="lineno">  383</span>}</div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_a13269908e5cbb4827f974e782b98f6b2"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#a13269908e5cbb4827f974e782b98f6b2">luci_interpreter_pal::lstm::cwise_mul</a></div><div class="ttdeci">void cwise_mul(const int16_t *input_1, const int16_t *input_2, int32_t multiplier, int32_t shift, int32_t n_batch, int32_t n_input, int32_t output_zp, int8_t *output)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00052">PALUnidirectionalSequenceLSTM.h:52</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_a4e414d74814834c72b789c80e68e843b"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#a4e414d74814834c72b789c80e68e843b">luci_interpreter_pal::lstm::cwise_clipping</a></div><div class="ttdeci">void cwise_clipping(T *vector, const int v_size, const T &amp;clipping_value)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00081">PALUnidirectionalSequenceLSTM.h:81</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ae5995c2f4e037e3d18ef8f0462079564"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ae5995c2f4e037e3d18ef8f0462079564">luci_interpreter_pal::lstm::apply_tanh</a></div><div class="ttdeci">void apply_tanh(int32_t integer_bits, const int16_t *input, int32_t n_batch, int32_t n_input, int16_t *output)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00309">PALUnidirectionalSequenceLSTM.h:309</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00309">apply_tanh()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00081">cwise_clipping()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00052">cwise_mul()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00257">matrix_batch_vector_multiply_accumulate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00612">lstm_step_integer_8x8_16()</a>.</p>

</div>
</div>
<a id="a15e54cf21be2fb24c7575d140e2a8d1a" name="a15e54cf21be2fb24c7575d140e2a8d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15e54cf21be2fb24c7575d140e2a8d1a">&#9670;&#160;</a></span>convert_lstm_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cmsis_nn_lstm_params luci_interpreter_pal::lstm::convert_lstm_params </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html">luci_interpreter::IntegerLSTMParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>time_major</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>output_zeropoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_gate_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>forget_gate_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>cell_gate_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>output_gate_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>input_layer_norm_coefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>forget_layer_norm_coefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>cell_layer_norm_coefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>output_layer_norm_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cmsisnn_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00033">33</a> of file <a class="el" href="cmsisnn_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   39</span>{</div>
<div class="line"><span class="lineno">   40</span>  cmsis_nn_lstm_params params_out;</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  params_out.time_major = time_major;</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">// Multipliers and shifts for weights</span></div>
<div class="line"><span class="lineno">   45</span>  params_out.input_to_input_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a1815b45d4e9979eaf81cb89f299c8f79">effective_input_to_input_scale_a</a>;</div>
<div class="line"><span class="lineno">   46</span>  params_out.input_to_input_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aab48dc57abe245d257c35cc1c6ad7354">effective_input_to_input_scale_b</a>;</div>
<div class="line"><span class="lineno">   47</span>  params_out.recurrent_to_input_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a38de4e598127e2fb764fce6a21c2fc9e">effective_recurrent_to_input_scale_a</a>;</div>
<div class="line"><span class="lineno">   48</span>  params_out.recurrent_to_input_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a9686553df691e2b1b8c716615f13753e">effective_recurrent_to_input_scale_b</a>;</div>
<div class="line"><span class="lineno">   49</span>  params_out.cell_to_input_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#abe40c57692043111c35301789a9218e6">effective_cell_to_input_scale_a</a>;</div>
<div class="line"><span class="lineno">   50</span>  params_out.cell_to_input_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aacc97958d62163e8f69f44703bd2b411">effective_cell_to_input_scale_b</a>;</div>
<div class="line"><span class="lineno">   51</span>  params_out.input_to_forget_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aad3a135d4309854e3ca3ffcf375aa07a">effective_input_to_forget_scale_a</a>;</div>
<div class="line"><span class="lineno">   52</span>  params_out.input_to_forget_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#adc38a56e44f8a3e6550bc80bfaca363e">effective_input_to_forget_scale_b</a>;</div>
<div class="line"><span class="lineno">   53</span>  params_out.recurrent_to_forget_scaling.multiplier =</div>
<div class="line"><span class="lineno">   54</span>    params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a786a7d187a322aab6e8d07bfb157c834">effective_recurrent_to_forget_scale_a</a>;</div>
<div class="line"><span class="lineno">   55</span>  params_out.recurrent_to_forget_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a0f2e283966be688baf8353cb83d6cabe">effective_recurrent_to_forget_scale_b</a>;</div>
<div class="line"><span class="lineno">   56</span>  params_out.cell_to_forget_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a6e524defb86176d1c87074f90d30b6fc">effective_cell_to_forget_scale_a</a>;</div>
<div class="line"><span class="lineno">   57</span>  params_out.cell_to_forget_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aab68f6adb9ab9fbdcb02b1561939f623">effective_cell_to_forget_scale_b</a>;</div>
<div class="line"><span class="lineno">   58</span>  params_out.input_to_cell_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a17aa2b0f550808acc80edf483d9aefc0">effective_input_to_cell_scale_a</a>;</div>
<div class="line"><span class="lineno">   59</span>  params_out.input_to_cell_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a88ce1ec27fc97e74415f066b281bcb71">effective_input_to_cell_scale_b</a>;</div>
<div class="line"><span class="lineno">   60</span>  params_out.recurrent_to_cell_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ae8b58fbab6226ddb2b3d5b972ca47a3d">effective_recurrent_to_cell_scale_a</a>;</div>
<div class="line"><span class="lineno">   61</span>  params_out.recurrent_to_cell_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a7429f0edf41d6c2ffce4987830d31235">effective_recurrent_to_cell_scale_b</a>;</div>
<div class="line"><span class="lineno">   62</span>  params_out.input_to_output_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a436a706c17cf37479593607220ff0aab">effective_input_to_output_scale_a</a>;</div>
<div class="line"><span class="lineno">   63</span>  params_out.input_to_output_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a8f050cf3537363681b3aff86395f7813">effective_input_to_output_scale_b</a>;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>  params_out.recurrent_to_output_scaling.multiplier =</div>
<div class="line"><span class="lineno">   66</span>    params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a1ef00ac5637652bc42302b668595c14f">effective_recurrent_to_output_scale_a</a>;</div>
<div class="line"><span class="lineno">   67</span>  params_out.recurrent_to_output_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a397af438d6a1e7051cd78da4dbb743ba">effective_recurrent_to_output_scale_b</a>;</div>
<div class="line"><span class="lineno">   68</span>  params_out.cell_to_output_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#affdebdc0521280db0be1bec0434c04e4">effective_cell_to_output_scale_a</a>;</div>
<div class="line"><span class="lineno">   69</span>  params_out.cell_to_output_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a760916e38abee7495fa35d198ba96008">effective_cell_to_output_scale_b</a>;</div>
<div class="line"><span class="lineno">   70</span>  params_out.projection_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a27867e3ab1cbefb506f3d384587b5a32">effective_proj_scale_a</a>;</div>
<div class="line"><span class="lineno">   71</span>  params_out.projection_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a78b06d907d35a460555947d9ce6b6192">effective_proj_scale_b</a>;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  params_out.layer_norm_input_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ac0c85d53bd0a78802d42a9493616fa9e">layer_norm_input_scale_a</a>;</div>
<div class="line"><span class="lineno">   74</span>  params_out.layer_norm_input_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#afde0dc24fcf4a78b859be82f28632b61">layer_norm_input_scale_b</a>;</div>
<div class="line"><span class="lineno">   75</span>  params_out.layer_norm_forget_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a4f17d869e9a7e018549d323949d507e8">layer_norm_forget_scale_a</a>;</div>
<div class="line"><span class="lineno">   76</span>  params_out.layer_norm_forget_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aff505a21fe1205ce8de8d6349274d1be">layer_norm_forget_scale_b</a>;</div>
<div class="line"><span class="lineno">   77</span>  params_out.layer_norm_cell_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aa121ea209ac56e9b152ea2b7a8818715">layer_norm_cell_scale_a</a>;</div>
<div class="line"><span class="lineno">   78</span>  params_out.layer_norm_cell_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a63778507ff2e28c090b2937fba31cbf2">layer_norm_cell_scale_b</a>;</div>
<div class="line"><span class="lineno">   79</span>  params_out.layer_norm_output_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a05119ca8a00dfb53b66ca3cc187c5b05">layer_norm_output_scale_a</a>;</div>
<div class="line"><span class="lineno">   80</span>  params_out.layer_norm_output_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ac3690c9c36794675982ba9ec3607f8b7">layer_norm_output_scale_b</a>;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  params_out.clip.cell = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a8462a1a6cced18ac3a6b82306bfcc780">quantized_cell_clip</a>;</div>
<div class="line"><span class="lineno">   83</span>  params_out.clip.projection = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ac8ddd6f032f01eaefa39a8a1259e900d">quantized_proj_clip</a>;</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  params_out.cell_state_shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ab7664e69aed93448fcc3bae80cff7b57">cell_scale</a>;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  params_out.hidden_offset = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a9179415a87f49b1efd429c501c20432c">hidden_zp</a>;</div>
<div class="line"><span class="lineno">   88</span>  params_out.output_state_offset = output_zeropoint;</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  params_out.guard.input_variance = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#af9a05c5052c25714265807ee320bc966">input_variance_guard</a>;</div>
<div class="line"><span class="lineno">   91</span>  params_out.guard.forget_variance = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ad4ee84a5a78c2c9dfe7fabe78b9388d1">forget_variance_guard</a>;</div>
<div class="line"><span class="lineno">   92</span>  params_out.guard.cell_variance = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ae922b35a1ae080073fce915fb42eb4c7">cell_variance_guard</a>;</div>
<div class="line"><span class="lineno">   93</span>  params_out.guard.output_variance = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a34cb17f71c767ce6ad0b60daeec89c18">output_variance_guard</a>;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  params_out.i2f_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a5230bd10273c2df881d2992ca89d764d">input_to_forget_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">   96</span>  params_out.r2f_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a08150d9662d4b9e4471a0fb28298a5c2">recurrent_to_forget_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">   97</span>  params_out.i2c_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#add6e3338ffe810eff38750897882d35c">input_to_cell_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">   98</span>  params_out.r2c_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#af8e50735cb0b964413f1c273220131d6">recurrent_to_cell_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">   99</span>  params_out.i2o_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a66f2874ced3aa8934bf0ee93ae61cec0">input_to_output_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">  100</span>  params_out.r2o_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a7a79444954718b6ec2b01bb61afcd40b">recurrent_to_output_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">  101</span>  params_out.i2i_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a3a42233043f3d11e76ff7e5a48b98609">input_to_input_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">  102</span>  params_out.r2i_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a88d966314f5bce1f3dab6a948436f409">recurrent_to_input_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">  103</span>  params_out.projection_effective_bias = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a72134384372348fba20502cd12af5fe9">projection_effective_bias</a>.data();</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  params_out.hidden_scaling.multiplier = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#abb27a971ebf03b639b8c9206fdaa392f">effective_hidden_scale_a</a>;</div>
<div class="line"><span class="lineno">  106</span>  params_out.hidden_scaling.shift = params_in.<a class="code hl_variable" href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a3fed6619c9e6f648f17f00aa5af6aacd">effective_hidden_scale_b</a>;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>  params_out.input_gate_bias = input_gate_bias;</div>
<div class="line"><span class="lineno">  109</span>  params_out.forget_gate_bias = forget_gate_bias;</div>
<div class="line"><span class="lineno">  110</span>  params_out.cell_gate_bias = cell_gate_bias;</div>
<div class="line"><span class="lineno">  111</span>  params_out.output_gate_bias = output_gate_bias;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  params_out.layer_norm.input_weight = input_layer_norm_coefficients;</div>
<div class="line"><span class="lineno">  114</span>  params_out.layer_norm.forget_weight = forget_layer_norm_coefficients;</div>
<div class="line"><span class="lineno">  115</span>  params_out.layer_norm.cell_weight = cell_layer_norm_coefficients;</div>
<div class="line"><span class="lineno">  116</span>  params_out.layer_norm.output_weight = output_layer_norm_coefficients;</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  params_out.activation.min = std::numeric_limits&lt;int16_t&gt;::min();</div>
<div class="line"><span class="lineno">  119</span>  params_out.activation.max = std::numeric_limits&lt;int16_t&gt;::max();</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">return</span> params_out;</div>
<div class="line"><span class="lineno">  122</span>}</div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a05119ca8a00dfb53b66ca3cc187c5b05"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a05119ca8a00dfb53b66ca3cc187c5b05">luci_interpreter::IntegerLSTMParams::layer_norm_output_scale_a</a></div><div class="ttdeci">int32_t layer_norm_output_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00283">KernelParams.h:283</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a08150d9662d4b9e4471a0fb28298a5c2"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a08150d9662d4b9e4471a0fb28298a5c2">luci_interpreter::IntegerLSTMParams::recurrent_to_forget_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; recurrent_to_forget_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00294">KernelParams.h:294</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a0f2e283966be688baf8353cb83d6cabe"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a0f2e283966be688baf8353cb83d6cabe">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_forget_scale_b</a></div><div class="ttdeci">int32_t effective_recurrent_to_forget_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00248">KernelParams.h:248</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a17aa2b0f550808acc80edf483d9aefc0"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a17aa2b0f550808acc80edf483d9aefc0">luci_interpreter::IntegerLSTMParams::effective_input_to_cell_scale_a</a></div><div class="ttdeci">int32_t effective_input_to_cell_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00253">KernelParams.h:253</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a1815b45d4e9979eaf81cb89f299c8f79"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a1815b45d4e9979eaf81cb89f299c8f79">luci_interpreter::IntegerLSTMParams::effective_input_to_input_scale_a</a></div><div class="ttdeci">int32_t effective_input_to_input_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00235">KernelParams.h:235</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a1ef00ac5637652bc42302b668595c14f"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a1ef00ac5637652bc42302b668595c14f">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_output_scale_a</a></div><div class="ttdeci">int32_t effective_recurrent_to_output_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00262">KernelParams.h:262</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a27867e3ab1cbefb506f3d384587b5a32"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a27867e3ab1cbefb506f3d384587b5a32">luci_interpreter::IntegerLSTMParams::effective_proj_scale_a</a></div><div class="ttdeci">int32_t effective_proj_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00268">KernelParams.h:268</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a34cb17f71c767ce6ad0b60daeec89c18"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a34cb17f71c767ce6ad0b60daeec89c18">luci_interpreter::IntegerLSTMParams::output_variance_guard</a></div><div class="ttdeci">int32_t output_variance_guard</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00291">KernelParams.h:291</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a38de4e598127e2fb764fce6a21c2fc9e"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a38de4e598127e2fb764fce6a21c2fc9e">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_input_scale_a</a></div><div class="ttdeci">int32_t effective_recurrent_to_input_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00238">KernelParams.h:238</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a397af438d6a1e7051cd78da4dbb743ba"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a397af438d6a1e7051cd78da4dbb743ba">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_output_scale_b</a></div><div class="ttdeci">int32_t effective_recurrent_to_output_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00263">KernelParams.h:263</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a3a42233043f3d11e76ff7e5a48b98609"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a3a42233043f3d11e76ff7e5a48b98609">luci_interpreter::IntegerLSTMParams::input_to_input_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; input_to_input_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00299">KernelParams.h:299</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a3fed6619c9e6f648f17f00aa5af6aacd"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a3fed6619c9e6f648f17f00aa5af6aacd">luci_interpreter::IntegerLSTMParams::effective_hidden_scale_b</a></div><div class="ttdeci">int32_t effective_hidden_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00272">KernelParams.h:272</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a436a706c17cf37479593607220ff0aab"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a436a706c17cf37479593607220ff0aab">luci_interpreter::IntegerLSTMParams::effective_input_to_output_scale_a</a></div><div class="ttdeci">int32_t effective_input_to_output_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00259">KernelParams.h:259</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a4f17d869e9a7e018549d323949d507e8"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a4f17d869e9a7e018549d323949d507e8">luci_interpreter::IntegerLSTMParams::layer_norm_forget_scale_a</a></div><div class="ttdeci">int32_t layer_norm_forget_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00277">KernelParams.h:277</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a5230bd10273c2df881d2992ca89d764d"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a5230bd10273c2df881d2992ca89d764d">luci_interpreter::IntegerLSTMParams::input_to_forget_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; input_to_forget_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00293">KernelParams.h:293</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a63778507ff2e28c090b2937fba31cbf2"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a63778507ff2e28c090b2937fba31cbf2">luci_interpreter::IntegerLSTMParams::layer_norm_cell_scale_b</a></div><div class="ttdeci">int32_t layer_norm_cell_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00281">KernelParams.h:281</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a66f2874ced3aa8934bf0ee93ae61cec0"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a66f2874ced3aa8934bf0ee93ae61cec0">luci_interpreter::IntegerLSTMParams::input_to_output_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; input_to_output_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00297">KernelParams.h:297</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a6e524defb86176d1c87074f90d30b6fc"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a6e524defb86176d1c87074f90d30b6fc">luci_interpreter::IntegerLSTMParams::effective_cell_to_forget_scale_a</a></div><div class="ttdeci">int32_t effective_cell_to_forget_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00250">KernelParams.h:250</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a72134384372348fba20502cd12af5fe9"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a72134384372348fba20502cd12af5fe9">luci_interpreter::IntegerLSTMParams::projection_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; projection_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00301">KernelParams.h:301</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a7429f0edf41d6c2ffce4987830d31235"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a7429f0edf41d6c2ffce4987830d31235">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_cell_scale_b</a></div><div class="ttdeci">int32_t effective_recurrent_to_cell_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00257">KernelParams.h:257</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a760916e38abee7495fa35d198ba96008"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a760916e38abee7495fa35d198ba96008">luci_interpreter::IntegerLSTMParams::effective_cell_to_output_scale_b</a></div><div class="ttdeci">int32_t effective_cell_to_output_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00266">KernelParams.h:266</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a786a7d187a322aab6e8d07bfb157c834"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a786a7d187a322aab6e8d07bfb157c834">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_forget_scale_a</a></div><div class="ttdeci">int32_t effective_recurrent_to_forget_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00247">KernelParams.h:247</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a78b06d907d35a460555947d9ce6b6192"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a78b06d907d35a460555947d9ce6b6192">luci_interpreter::IntegerLSTMParams::effective_proj_scale_b</a></div><div class="ttdeci">int32_t effective_proj_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00269">KernelParams.h:269</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a7a79444954718b6ec2b01bb61afcd40b"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a7a79444954718b6ec2b01bb61afcd40b">luci_interpreter::IntegerLSTMParams::recurrent_to_output_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; recurrent_to_output_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00298">KernelParams.h:298</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a8462a1a6cced18ac3a6b82306bfcc780"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a8462a1a6cced18ac3a6b82306bfcc780">luci_interpreter::IntegerLSTMParams::quantized_cell_clip</a></div><div class="ttdeci">int16_t quantized_cell_clip</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00231">KernelParams.h:231</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a88ce1ec27fc97e74415f066b281bcb71"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a88ce1ec27fc97e74415f066b281bcb71">luci_interpreter::IntegerLSTMParams::effective_input_to_cell_scale_b</a></div><div class="ttdeci">int32_t effective_input_to_cell_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00254">KernelParams.h:254</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a88d966314f5bce1f3dab6a948436f409"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a88d966314f5bce1f3dab6a948436f409">luci_interpreter::IntegerLSTMParams::recurrent_to_input_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; recurrent_to_input_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00300">KernelParams.h:300</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a8f050cf3537363681b3aff86395f7813"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a8f050cf3537363681b3aff86395f7813">luci_interpreter::IntegerLSTMParams::effective_input_to_output_scale_b</a></div><div class="ttdeci">int32_t effective_input_to_output_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00260">KernelParams.h:260</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a9179415a87f49b1efd429c501c20432c"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a9179415a87f49b1efd429c501c20432c">luci_interpreter::IntegerLSTMParams::hidden_zp</a></div><div class="ttdeci">int32_t hidden_zp</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00286">KernelParams.h:286</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_a9686553df691e2b1b8c716615f13753e"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#a9686553df691e2b1b8c716615f13753e">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_input_scale_b</a></div><div class="ttdeci">int32_t effective_recurrent_to_input_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00239">KernelParams.h:239</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_aa121ea209ac56e9b152ea2b7a8818715"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aa121ea209ac56e9b152ea2b7a8818715">luci_interpreter::IntegerLSTMParams::layer_norm_cell_scale_a</a></div><div class="ttdeci">int32_t layer_norm_cell_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00280">KernelParams.h:280</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_aab48dc57abe245d257c35cc1c6ad7354"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aab48dc57abe245d257c35cc1c6ad7354">luci_interpreter::IntegerLSTMParams::effective_input_to_input_scale_b</a></div><div class="ttdeci">int32_t effective_input_to_input_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00236">KernelParams.h:236</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_aab68f6adb9ab9fbdcb02b1561939f623"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aab68f6adb9ab9fbdcb02b1561939f623">luci_interpreter::IntegerLSTMParams::effective_cell_to_forget_scale_b</a></div><div class="ttdeci">int32_t effective_cell_to_forget_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00251">KernelParams.h:251</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_aacc97958d62163e8f69f44703bd2b411"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aacc97958d62163e8f69f44703bd2b411">luci_interpreter::IntegerLSTMParams::effective_cell_to_input_scale_b</a></div><div class="ttdeci">int32_t effective_cell_to_input_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00242">KernelParams.h:242</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_aad3a135d4309854e3ca3ffcf375aa07a"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aad3a135d4309854e3ca3ffcf375aa07a">luci_interpreter::IntegerLSTMParams::effective_input_to_forget_scale_a</a></div><div class="ttdeci">int32_t effective_input_to_forget_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00244">KernelParams.h:244</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ab7664e69aed93448fcc3bae80cff7b57"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ab7664e69aed93448fcc3bae80cff7b57">luci_interpreter::IntegerLSTMParams::cell_scale</a></div><div class="ttdeci">int cell_scale</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00233">KernelParams.h:233</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_abb27a971ebf03b639b8c9206fdaa392f"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#abb27a971ebf03b639b8c9206fdaa392f">luci_interpreter::IntegerLSTMParams::effective_hidden_scale_a</a></div><div class="ttdeci">int32_t effective_hidden_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00271">KernelParams.h:271</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_abe40c57692043111c35301789a9218e6"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#abe40c57692043111c35301789a9218e6">luci_interpreter::IntegerLSTMParams::effective_cell_to_input_scale_a</a></div><div class="ttdeci">int32_t effective_cell_to_input_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00241">KernelParams.h:241</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ac0c85d53bd0a78802d42a9493616fa9e"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ac0c85d53bd0a78802d42a9493616fa9e">luci_interpreter::IntegerLSTMParams::layer_norm_input_scale_a</a></div><div class="ttdeci">int32_t layer_norm_input_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00274">KernelParams.h:274</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ac3690c9c36794675982ba9ec3607f8b7"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ac3690c9c36794675982ba9ec3607f8b7">luci_interpreter::IntegerLSTMParams::layer_norm_output_scale_b</a></div><div class="ttdeci">int32_t layer_norm_output_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00284">KernelParams.h:284</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ac8ddd6f032f01eaefa39a8a1259e900d"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ac8ddd6f032f01eaefa39a8a1259e900d">luci_interpreter::IntegerLSTMParams::quantized_proj_clip</a></div><div class="ttdeci">int8_t quantized_proj_clip</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00232">KernelParams.h:232</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ad4ee84a5a78c2c9dfe7fabe78b9388d1"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ad4ee84a5a78c2c9dfe7fabe78b9388d1">luci_interpreter::IntegerLSTMParams::forget_variance_guard</a></div><div class="ttdeci">int32_t forget_variance_guard</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00289">KernelParams.h:289</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_adc38a56e44f8a3e6550bc80bfaca363e"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#adc38a56e44f8a3e6550bc80bfaca363e">luci_interpreter::IntegerLSTMParams::effective_input_to_forget_scale_b</a></div><div class="ttdeci">int32_t effective_input_to_forget_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00245">KernelParams.h:245</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_add6e3338ffe810eff38750897882d35c"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#add6e3338ffe810eff38750897882d35c">luci_interpreter::IntegerLSTMParams::input_to_cell_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; input_to_cell_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00295">KernelParams.h:295</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ae8b58fbab6226ddb2b3d5b972ca47a3d"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ae8b58fbab6226ddb2b3d5b972ca47a3d">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_cell_scale_a</a></div><div class="ttdeci">int32_t effective_recurrent_to_cell_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00256">KernelParams.h:256</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_ae922b35a1ae080073fce915fb42eb4c7"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#ae922b35a1ae080073fce915fb42eb4c7">luci_interpreter::IntegerLSTMParams::cell_variance_guard</a></div><div class="ttdeci">int32_t cell_variance_guard</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00290">KernelParams.h:290</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_af8e50735cb0b964413f1c273220131d6"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#af8e50735cb0b964413f1c273220131d6">luci_interpreter::IntegerLSTMParams::recurrent_to_cell_effective_bias</a></div><div class="ttdeci">std::vector&lt; int32_t &gt; recurrent_to_cell_effective_bias</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00296">KernelParams.h:296</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_af9a05c5052c25714265807ee320bc966"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#af9a05c5052c25714265807ee320bc966">luci_interpreter::IntegerLSTMParams::input_variance_guard</a></div><div class="ttdeci">int32_t input_variance_guard</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00288">KernelParams.h:288</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_afde0dc24fcf4a78b859be82f28632b61"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#afde0dc24fcf4a78b859be82f28632b61">luci_interpreter::IntegerLSTMParams::layer_norm_input_scale_b</a></div><div class="ttdeci">int32_t layer_norm_input_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00275">KernelParams.h:275</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_aff505a21fe1205ce8de8d6349274d1be"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#aff505a21fe1205ce8de8d6349274d1be">luci_interpreter::IntegerLSTMParams::layer_norm_forget_scale_b</a></div><div class="ttdeci">int32_t layer_norm_forget_scale_b</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00278">KernelParams.h:278</a></div></div>
<div class="ttc" id="astructluci__interpreter_1_1_integer_l_s_t_m_params_html_affdebdc0521280db0be1bec0434c04e4"><div class="ttname"><a href="structluci__interpreter_1_1_integer_l_s_t_m_params.html#affdebdc0521280db0be1bec0434c04e4">luci_interpreter::IntegerLSTMParams::effective_cell_to_output_scale_a</a></div><div class="ttdeci">int32_t effective_cell_to_output_scale_a</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00265">KernelParams.h:265</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00233">luci_interpreter::IntegerLSTMParams::cell_scale</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00290">luci_interpreter::IntegerLSTMParams::cell_variance_guard</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00250">luci_interpreter::IntegerLSTMParams::effective_cell_to_forget_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00251">luci_interpreter::IntegerLSTMParams::effective_cell_to_forget_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00241">luci_interpreter::IntegerLSTMParams::effective_cell_to_input_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00242">luci_interpreter::IntegerLSTMParams::effective_cell_to_input_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00265">luci_interpreter::IntegerLSTMParams::effective_cell_to_output_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00266">luci_interpreter::IntegerLSTMParams::effective_cell_to_output_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00271">luci_interpreter::IntegerLSTMParams::effective_hidden_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00272">luci_interpreter::IntegerLSTMParams::effective_hidden_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00253">luci_interpreter::IntegerLSTMParams::effective_input_to_cell_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00254">luci_interpreter::IntegerLSTMParams::effective_input_to_cell_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00244">luci_interpreter::IntegerLSTMParams::effective_input_to_forget_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00245">luci_interpreter::IntegerLSTMParams::effective_input_to_forget_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00235">luci_interpreter::IntegerLSTMParams::effective_input_to_input_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00236">luci_interpreter::IntegerLSTMParams::effective_input_to_input_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00259">luci_interpreter::IntegerLSTMParams::effective_input_to_output_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00260">luci_interpreter::IntegerLSTMParams::effective_input_to_output_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00268">luci_interpreter::IntegerLSTMParams::effective_proj_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00269">luci_interpreter::IntegerLSTMParams::effective_proj_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00256">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_cell_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00257">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_cell_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00247">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_forget_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00248">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_forget_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00238">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_input_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00239">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_input_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00262">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_output_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00263">luci_interpreter::IntegerLSTMParams::effective_recurrent_to_output_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00289">luci_interpreter::IntegerLSTMParams::forget_variance_guard</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00286">luci_interpreter::IntegerLSTMParams::hidden_zp</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00295">luci_interpreter::IntegerLSTMParams::input_to_cell_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00293">luci_interpreter::IntegerLSTMParams::input_to_forget_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00299">luci_interpreter::IntegerLSTMParams::input_to_input_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00297">luci_interpreter::IntegerLSTMParams::input_to_output_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00288">luci_interpreter::IntegerLSTMParams::input_variance_guard</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00280">luci_interpreter::IntegerLSTMParams::layer_norm_cell_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00281">luci_interpreter::IntegerLSTMParams::layer_norm_cell_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00277">luci_interpreter::IntegerLSTMParams::layer_norm_forget_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00278">luci_interpreter::IntegerLSTMParams::layer_norm_forget_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00274">luci_interpreter::IntegerLSTMParams::layer_norm_input_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00275">luci_interpreter::IntegerLSTMParams::layer_norm_input_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00283">luci_interpreter::IntegerLSTMParams::layer_norm_output_scale_a</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00284">luci_interpreter::IntegerLSTMParams::layer_norm_output_scale_b</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00291">luci_interpreter::IntegerLSTMParams::output_variance_guard</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00301">luci_interpreter::IntegerLSTMParams::projection_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00231">luci_interpreter::IntegerLSTMParams::quantized_cell_clip</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00232">luci_interpreter::IntegerLSTMParams::quantized_proj_clip</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00296">luci_interpreter::IntegerLSTMParams::recurrent_to_cell_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00294">luci_interpreter::IntegerLSTMParams::recurrent_to_forget_effective_bias</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00300">luci_interpreter::IntegerLSTMParams::recurrent_to_input_effective_bias</a>, and <a class="el" href="onert-micro_2luci-interpreter_2src_2core_2_kernel_params_8h_source.html#l00298">luci_interpreter::IntegerLSTMParams::recurrent_to_output_effective_bias</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmsisnn_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00126">luci_interpreter_pal::eval_integer_8x8_16_lstm()</a>.</p>

</div>
</div>
<a id="acef25fe5a003e2ff65b2c8ccb2711207" name="acef25fe5a003e2ff65b2c8ccb2711207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acef25fe5a003e2ff65b2c8ccb2711207">&#9670;&#160;</a></span>count_leading_zeros()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int luci_interpreter_pal::lstm::count_leading_zeros </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>integer_input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00106">106</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  107</span>{</div>
<div class="line"><span class="lineno">  108</span>  <span class="keyword">static_assert</span>(std::is_unsigned&lt;T&gt;::value, <span class="stringliteral">&quot;Only unsigned integer types handled.&quot;</span>);</div>
<div class="line"><span class="lineno">  109</span><span class="preprocessor">#if defined(__GNUC__)</span></div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">return</span> integer_input ? __builtin_clz(integer_input) : <a class="code hl_namespace" href="namespacestd.html">std</a>::numeric_limits&lt;T&gt;::digits;</div>
<div class="line"><span class="lineno">  111</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  112</span>  <span class="keywordflow">if</span> (integer_input == 0)</div>
<div class="line"><span class="lineno">  113</span>  {</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">return</span> std::numeric_limits&lt;T&gt;::digits;</div>
<div class="line"><span class="lineno">  115</span>  }</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  <span class="keyword">const</span> T one_in_leading_positive = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1) &lt;&lt; (std::numeric_limits&lt;T&gt;::digits - 1);</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordtype">int</span> leading_zeros = 0;</div>
<div class="line"><span class="lineno">  119</span>  <span class="keywordflow">while</span> (integer_input &lt; one_in_leading_positive)</div>
<div class="line"><span class="lineno">  120</span>  {</div>
<div class="line"><span class="lineno">  121</span>    integer_input &lt;&lt;= 1;</div>
<div class="line"><span class="lineno">  122</span>    ++leading_zeros;</div>
<div class="line"><span class="lineno">  123</span>  }</div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordflow">return</span> leading_zeros;</div>
<div class="line"><span class="lineno">  125</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  126</span>}</div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="exo_2src_2_circle_2_circle_exporter_utils_8h_source.html#l00052">CircleExporterUtils.h:53</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00128">get_inv_sqrt_quantized_multiplier_exp()</a>.</p>

</div>
</div>
<a id="af4923cae88d2f75c29b49c78c9a00f99" name="af4923cae88d2f75c29b49c78c9a00f99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4923cae88d2f75c29b49c78c9a00f99">&#9670;&#160;</a></span>cwise_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::cwise_add </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00089">89</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>{</div>
<div class="line"><span class="lineno">   92</span>  <span class="keyword">const</span> int32_t kInt16Max = std::numeric_limits&lt;int16_t&gt;::max();</div>
<div class="line"><span class="lineno">   93</span>  <span class="keyword">const</span> int32_t kInt16Min = std::numeric_limits&lt;int16_t&gt;::min();</div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> batch = 0; batch &lt; n_batch; ++batch)</div>
<div class="line"><span class="lineno">   95</span>  {</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_input; ++i)</div>
<div class="line"><span class="lineno">   97</span>    {</div>
<div class="line"><span class="lineno">   98</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> index = batch * n_input + i;</div>
<div class="line"><span class="lineno">   99</span>      int32_t sum = input_1[index] + input_2[index];</div>
<div class="line"><span class="lineno">  100</span>      <span class="keyword">const</span> int32_t sum_clamped = std::min(kInt16Max, std::max(kInt16Min, sum));</div>
<div class="line"><span class="lineno">  101</span>      output[index] = <span class="keyword">static_cast&lt;</span>int16_t<span class="keyword">&gt;</span>(sum_clamped);</div>
<div class="line"><span class="lineno">  102</span>    }</div>
<div class="line"><span class="lineno">  103</span>  }</div>
<div class="line"><span class="lineno">  104</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">update_lstm_cell_integer()</a>.</p>

</div>
</div>
<a id="a4e414d74814834c72b789c80e68e843b" name="a4e414d74814834c72b789c80e68e843b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e414d74814834c72b789c80e68e843b">&#9670;&#160;</a></span>cwise_clipping()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::cwise_clipping </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>v_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>clipping_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00081">81</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>{</div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; v_size; i++)</div>
<div class="line"><span class="lineno">   84</span>  {</div>
<div class="line"><span class="lineno">   85</span>    vector[i] = std::max(std::min(clipping_value, vector[i]), <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(-clipping_value));</div>
<div class="line"><span class="lineno">   86</span>  }</div>
<div class="line"><span class="lineno">   87</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">calculate_lstm_output_integer8x8_16()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">update_lstm_cell_integer()</a>.</p>

</div>
</div>
<a id="ad0b6a487395ebcaaef58516ae80581a7" name="ad0b6a487395ebcaaef58516ae80581a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b6a487395ebcaaef58516ae80581a7">&#9670;&#160;</a></span>cwise_mul() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::cwise_mul </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00385">385</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  387</span>{</div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> batch = 0; batch &lt; n_batch; ++batch)</div>
<div class="line"><span class="lineno">  389</span>  {</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_input; ++i)</div>
<div class="line"><span class="lineno">  391</span>    {</div>
<div class="line"><span class="lineno">  392</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> index = batch * n_input + i;</div>
<div class="line"><span class="lineno">  393</span>      <span class="keyword">const</span> int16_t a = input_1[index];</div>
<div class="line"><span class="lineno">  394</span>      <span class="keyword">const</span> int16_t b = input_2[index];</div>
<div class="line"><span class="lineno">  395</span>      <span class="keyword">const</span> int32_t value = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(a) * <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(b);</div>
<div class="line"><span class="lineno">  396</span>      output[index] = <span class="keyword">static_cast&lt;</span>int16_t<span class="keyword">&gt;</span>(gemmlowp::RoundingDivideByPOT(value, shift));</div>
<div class="line"><span class="lineno">  397</span>    }</div>
<div class="line"><span class="lineno">  398</span>  }</div>
<div class="line"><span class="lineno">  399</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a13269908e5cbb4827f974e782b98f6b2" name="a13269908e5cbb4827f974e782b98f6b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13269908e5cbb4827f974e782b98f6b2">&#9670;&#160;</a></span>cwise_mul() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::cwise_mul </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>multiplier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>output_zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00052">52</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>{</div>
<div class="line"><span class="lineno">   55</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> batch = 0; batch &lt; n_batch; ++batch)</div>
<div class="line"><span class="lineno">   56</span>  {</div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_input; ++i)</div>
<div class="line"><span class="lineno">   58</span>    {</div>
<div class="line"><span class="lineno">   59</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> index = batch * n_input + i;</div>
<div class="line"><span class="lineno">   60</span>      <span class="keyword">const</span> int16_t a = input_1[index];</div>
<div class="line"><span class="lineno">   61</span>      <span class="keyword">const</span> int16_t b = input_2[index];</div>
<div class="line"><span class="lineno">   62</span>      int32_t value = <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(a) * <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(b);</div>
<div class="line"><span class="lineno">   63</span>      value = <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#acbe525077503e0d3f37d59b7fc8276e2">multiply_by_quantized_multiplier</a>(value, multiplier, shift);</div>
<div class="line"><span class="lineno">   64</span>      value -= output_zp;</div>
<div class="line"><span class="lineno">   65</span>      value = std::min(std::max(<span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(-128), value), <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(127));</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>      output[index] = <span class="keyword">static_cast&lt;</span>int8_t<span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">   68</span>    }</div>
<div class="line"><span class="lineno">   69</span>  }</div>
<div class="line"><span class="lineno">   70</span>}</div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_acbe525077503e0d3f37d59b7fc8276e2"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#acbe525077503e0d3f37d59b7fc8276e2">luci_interpreter_pal::lstm::multiply_by_quantized_multiplier</a></div><div class="ttdeci">int32_t multiply_by_quantized_multiplier(int32_t x, int32_t quantized_multiplier, int shift)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00042">PALUnidirectionalSequenceLSTM.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00042">multiply_by_quantized_multiplier()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">calculate_lstm_output_integer8x8_16()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">update_lstm_cell_integer()</a>.</p>

</div>
</div>
<a id="a4a2d78fd09384fe6419222fac94e71b3" name="a4a2d78fd09384fe6419222fac94e71b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2d78fd09384fe6419222fac94e71b3">&#9670;&#160;</a></span>get_inv_sqrt_quantized_multiplier_exp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::get_inv_sqrt_quantized_multiplier_exp </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reverse_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>output_inv_sqrt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>output_shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00128">128</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>{</div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">if</span> (input &lt;= 1)</div>
<div class="line"><span class="lineno">  132</span>  {</div>
<div class="line"><span class="lineno">  133</span>    <span class="comment">// Handle the input value 1 separately to avoid overflow in that case</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// in the general computation below (b/143972021). Also handle 0 as if it</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">// were a 1. 0 is an invalid input here (divide by zero) and 1 is a valid</span></div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">// but rare/unrealistic input value. We can expect both to occur in some</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="comment">// incompletely trained models, but probably not in fully trained models.</span></div>
<div class="line"><span class="lineno">  138</span>    *output_inv_sqrt = std::numeric_limits&lt;std::int32_t&gt;::max();</div>
<div class="line"><span class="lineno">  139</span>    *output_shift = 0;</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  141</span>  }</div>
<div class="line"><span class="lineno">  142</span>  *output_shift = 11;</div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">while</span> (input &gt;= (1 &lt;&lt; 29))</div>
<div class="line"><span class="lineno">  144</span>  {</div>
<div class="line"><span class="lineno">  145</span>    input /= 4;</div>
<div class="line"><span class="lineno">  146</span>    ++*output_shift;</div>
<div class="line"><span class="lineno">  147</span>  }</div>
<div class="line"><span class="lineno">  148</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_left_shift_bits = count_leading_zeros(<span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(input)) - 1;</div>
<div class="line"><span class="lineno">  149</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_left_shift_bit_pairs = max_left_shift_bits / 2;</div>
<div class="line"><span class="lineno">  150</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> left_shift_bit_pairs = max_left_shift_bit_pairs - 1;</div>
<div class="line"><span class="lineno">  151</span>  *output_shift -= left_shift_bit_pairs;</div>
<div class="line"><span class="lineno">  152</span>  input &lt;&lt;= 2 * left_shift_bit_pairs;</div>
<div class="line"><span class="lineno">  153</span>  <span class="keyword">using </span>gemmlowp::FixedPoint;</div>
<div class="line"><span class="lineno">  154</span>  <span class="keyword">using </span>gemmlowp::Rescale;</div>
<div class="line"><span class="lineno">  155</span>  <span class="keyword">using </span>gemmlowp::SaturatingRoundingMultiplyByPOT;</div>
<div class="line"><span class="lineno">  156</span>  <span class="comment">// Using 3 integer bits gives us enough room for the internal arithmetic in</span></div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">// this Newton-Raphson iteration.</span></div>
<div class="line"><span class="lineno">  158</span>  <span class="keyword">using </span>F3 = FixedPoint&lt;int32_t, 3&gt;;</div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">using </span>F0 = FixedPoint&lt;int32_t, 0&gt;;</div>
<div class="line"><span class="lineno">  160</span>  <span class="keyword">const</span> F3 fixedpoint_input = F3::FromRaw(input &gt;&gt; 1);</div>
<div class="line"><span class="lineno">  161</span>  <span class="keyword">const</span> F3 fixedpoint_half_input = SaturatingRoundingMultiplyByPOT&lt;-1&gt;(fixedpoint_input);</div>
<div class="line"><span class="lineno">  162</span>  <span class="keyword">const</span> F3 fixedpoint_half_three =</div>
<div class="line"><span class="lineno">  163</span>    GEMMLOWP_CHECKED_FIXEDPOINT_CONSTANT(F3, (1 &lt;&lt; 28) + (1 &lt;&lt; 27), 1.5);</div>
<div class="line"><span class="lineno">  164</span>  <span class="comment">// Newton-Raphson iteration</span></div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// Naive unoptimized starting guess: x = 1</span></div>
<div class="line"><span class="lineno">  166</span>  F3 x = F3::One();</div>
<div class="line"><span class="lineno">  167</span>  <span class="comment">// Naive unoptimized number of iterations: 5</span></div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; i++)</div>
<div class="line"><span class="lineno">  169</span>  {</div>
<div class="line"><span class="lineno">  170</span>    <span class="keyword">const</span> F3 x3 = Rescale&lt;3&gt;(x * x * x);</div>
<div class="line"><span class="lineno">  171</span>    x = Rescale&lt;3&gt;(fixedpoint_half_three * x - fixedpoint_half_input * x3);</div>
<div class="line"><span class="lineno">  172</span>  }</div>
<div class="line"><span class="lineno">  173</span>  <span class="keyword">const</span> F0 fixedpoint_half_sqrt_2 =</div>
<div class="line"><span class="lineno">  174</span>    GEMMLOWP_CHECKED_FIXEDPOINT_CONSTANT(F0, 1518500250, std::sqrt(2.) / 2.);</div>
<div class="line"><span class="lineno">  175</span>  x = x * fixedpoint_half_sqrt_2;</div>
<div class="line"><span class="lineno">  176</span>  *output_inv_sqrt = x.raw();</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">if</span> (*output_shift &lt; 0)</div>
<div class="line"><span class="lineno">  178</span>  {</div>
<div class="line"><span class="lineno">  179</span>    *output_inv_sqrt &lt;&lt;= -*output_shift;</div>
<div class="line"><span class="lineno">  180</span>    *output_shift = 0;</div>
<div class="line"><span class="lineno">  181</span>  }</div>
<div class="line"><span class="lineno">  182</span>  <span class="comment">// Convert right shift (right is positive) to left shift.</span></div>
<div class="line"><span class="lineno">  183</span>  *output_shift *= reverse_shift;</div>
<div class="line"><span class="lineno">  184</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00106">count_leading_zeros()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00186">apply_layer_norm()</a>.</p>

</div>
</div>
<a id="aff32234d5392b0c7fdbccc7cad115c0e" name="aff32234d5392b0c7fdbccc7cad115c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff32234d5392b0c7fdbccc7cad115c0e">&#9670;&#160;</a></span>lstm_step_integer_8x8_16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::lstm_step_integer_8x8_16 </td>
          <td>(</td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_to_input_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_input_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_input_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_to_forget_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_forget_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_forget_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_to_cell_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_cell_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_cell_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_to_output_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_output_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_input_to_output_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_input_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_input_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_input_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_forget_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_forget_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_forget_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_cell_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_cell_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_cell_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_output_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_output_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_recurrent_to_output_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>cell_to_input_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_cell_to_input_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_cell_to_input_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>cell_to_forget_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_cell_to_forget_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_cell_to_forget_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>cell_to_output_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_cell_to_output_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_cell_to_output_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>projection_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_proj_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_proj_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>hidden_zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_hidden_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>effective_hidden_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>layer_norm_input_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_input_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_input_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>layer_norm_forget_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_forget_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_forget_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>layer_norm_cell_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_cell_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_cell_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>layer_norm_output_weight_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_output_scale_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>layer_norm_output_scale_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_gate_bias_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>forget_gate_bias_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>cell_gate_bias_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>output_gate_bias_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>quantized_cell_clip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>quantized_proj_clip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>cell_state_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>input_variance_guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>forget_variance_guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>cell_variance_guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>output_variance_guard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_to_forget_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_forget_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_to_cell_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_cell_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_to_output_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_output_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>input_to_input_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>recurrent_to_input_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>projection_effective_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>output_state_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>output_state_zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>cell_state_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>output_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>scratch0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>scratch1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>scratch2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>scratch3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t *&#160;</td>
          <td class="paramname"><em>scratch4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>scratch5</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00612">612</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  651</span>{</div>
<div class="line"><span class="lineno">  652</span>  <span class="comment">// Make named scratch buffers for the different gates.</span></div>
<div class="line"><span class="lineno">  653</span>  int16_t *input_gate_scratch = scratch0;</div>
<div class="line"><span class="lineno">  654</span>  int16_t *forget_gate_scratch = scratch1;</div>
<div class="line"><span class="lineno">  655</span>  int16_t *cell_gate_scratch = scratch2;</div>
<div class="line"><span class="lineno">  656</span>  int16_t *output_gate_scratch = scratch3;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>  <span class="comment">// Since we have already checked that weights are all there or none, we</span></div>
<div class="line"><span class="lineno">  659</span>  <span class="comment">// can check the existence of only one to the get the condition.</span></div>
<div class="line"><span class="lineno">  660</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_cifg = (input_to_input_weight_ptr == <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>  <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(input_to_forget_effective_bias);</div>
<div class="line"><span class="lineno">  663</span>  <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(recurrent_to_forget_effective_bias);</div>
<div class="line"><span class="lineno">  664</span>  <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(input_to_cell_effective_bias);</div>
<div class="line"><span class="lineno">  665</span>  <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(recurrent_to_cell_effective_bias);</div>
<div class="line"><span class="lineno">  666</span>  <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(input_to_output_effective_bias);</div>
<div class="line"><span class="lineno">  667</span>  <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(recurrent_to_output_effective_bias);</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>  <span class="keywordflow">if</span> (!use_cifg)</div>
<div class="line"><span class="lineno">  670</span>  {</div>
<div class="line"><span class="lineno">  671</span>    <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(input_to_input_effective_bias);</div>
<div class="line"><span class="lineno">  672</span>    <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(recurrent_to_input_effective_bias);</div>
<div class="line"><span class="lineno">  673</span>  }</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_projection = (projection_weight_ptr != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  676</span>  <span class="keywordflow">if</span> (use_projection)</div>
<div class="line"><span class="lineno">  677</span>  {</div>
<div class="line"><span class="lineno">  678</span>    <a class="code hl_define" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a>(projection_effective_bias);</div>
<div class="line"><span class="lineno">  679</span>  }</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>  <span class="keywordflow">if</span> (!use_cifg)</div>
<div class="line"><span class="lineno">  682</span>  {</div>
<div class="line"><span class="lineno">  683</span>    <span class="comment">// Calculate the input gate. (If not CIFG.)</span></div>
<div class="line"><span class="lineno">  684</span>    calculate_lstm_gate_integer_8x8_16(</div>
<div class="line"><span class="lineno">  685</span>      input_ptr, input_to_input_weight_ptr, input_to_input_effective_bias,</div>
<div class="line"><span class="lineno">  686</span>      effective_input_to_input_scale_a, effective_input_to_input_scale_b, output_state_ptr,</div>
<div class="line"><span class="lineno">  687</span>      recurrent_to_input_weight_ptr, recurrent_to_input_effective_bias,</div>
<div class="line"><span class="lineno">  688</span>      effective_recurrent_to_input_scale_a, effective_recurrent_to_input_scale_b, cell_state_ptr,</div>
<div class="line"><span class="lineno">  689</span>      cell_to_input_weight_ptr, effective_cell_to_input_scale_a, effective_cell_to_input_scale_b,</div>
<div class="line"><span class="lineno">  690</span>      layer_norm_input_weight_ptr, input_gate_bias_ptr, layer_norm_input_scale_a,</div>
<div class="line"><span class="lineno">  691</span>      layer_norm_input_scale_b, input_variance_guard, n_batch, n_input, n_output, n_cell,</div>
<div class="line"><span class="lineno">  692</span>      kTfLiteActSigmoid, input_gate_scratch, scratch5);</div>
<div class="line"><span class="lineno">  693</span>  }</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>  <span class="comment">// Calculate the forget gate.</span></div>
<div class="line"><span class="lineno">  696</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#adaa95dd338f0bbd9be680fd7dfc6d1aa">calculate_lstm_gate_integer_8x8_16</a>(</div>
<div class="line"><span class="lineno">  697</span>    input_ptr, input_to_forget_weight_ptr, input_to_forget_effective_bias,</div>
<div class="line"><span class="lineno">  698</span>    effective_input_to_forget_scale_a, effective_input_to_forget_scale_b, output_state_ptr,</div>
<div class="line"><span class="lineno">  699</span>    recurrent_to_forget_weight_ptr, recurrent_to_forget_effective_bias,</div>
<div class="line"><span class="lineno">  700</span>    effective_recurrent_to_forget_scale_a, effective_recurrent_to_forget_scale_b, cell_state_ptr,</div>
<div class="line"><span class="lineno">  701</span>    cell_to_forget_weight_ptr, effective_cell_to_forget_scale_a, effective_cell_to_forget_scale_b,</div>
<div class="line"><span class="lineno">  702</span>    layer_norm_forget_weight_ptr, forget_gate_bias_ptr, layer_norm_forget_scale_a,</div>
<div class="line"><span class="lineno">  703</span>    layer_norm_forget_scale_b, forget_variance_guard, n_batch, n_input, n_output, n_cell,</div>
<div class="line"><span class="lineno">  704</span>    kTfLiteActSigmoid, forget_gate_scratch, scratch5);</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>  <span class="comment">// Calculate the cell update gate.</span></div>
<div class="line"><span class="lineno">  707</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#adaa95dd338f0bbd9be680fd7dfc6d1aa">calculate_lstm_gate_integer_8x8_16</a>(</div>
<div class="line"><span class="lineno">  708</span>    input_ptr, input_to_cell_weight_ptr, input_to_cell_effective_bias,</div>
<div class="line"><span class="lineno">  709</span>    effective_input_to_cell_scale_a, effective_input_to_cell_scale_b, output_state_ptr,</div>
<div class="line"><span class="lineno">  710</span>    recurrent_to_cell_weight_ptr, recurrent_to_cell_effective_bias,</div>
<div class="line"><span class="lineno">  711</span>    effective_recurrent_to_cell_scale_a, effective_recurrent_to_cell_scale_b, cell_state_ptr,</div>
<div class="line"><span class="lineno">  712</span>    <span class="comment">/*cell_to_gate_weights=*/</span><span class="keyword">nullptr</span>, <span class="comment">/*cell_to_gate_scale_a=*/</span>0,</div>
<div class="line"><span class="lineno">  713</span>    <span class="comment">/*cell_to_gate_scale_b=*/</span>0, layer_norm_cell_weight_ptr, cell_gate_bias_ptr,</div>
<div class="line"><span class="lineno">  714</span>    layer_norm_cell_scale_a, layer_norm_cell_scale_b, cell_variance_guard, n_batch, n_input,</div>
<div class="line"><span class="lineno">  715</span>    n_output, n_cell, kTfLiteActTanh, cell_gate_scratch, scratch5);</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>  <span class="comment">// Update the cell state.</span></div>
<div class="line"><span class="lineno">  718</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#ab554f067a0e70af0121424c774ad3880">update_lstm_cell_integer</a>(n_batch, n_cell, cell_state_ptr, cell_state_scale, input_gate_scratch,</div>
<div class="line"><span class="lineno">  719</span>                           forget_gate_scratch, cell_gate_scratch, use_cifg, quantized_cell_clip);</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>  <span class="comment">// Calculate the output gate.</span></div>
<div class="line"><span class="lineno">  722</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#adaa95dd338f0bbd9be680fd7dfc6d1aa">calculate_lstm_gate_integer_8x8_16</a>(</div>
<div class="line"><span class="lineno">  723</span>    input_ptr, input_to_output_weight_ptr, input_to_output_effective_bias,</div>
<div class="line"><span class="lineno">  724</span>    effective_input_to_output_scale_a, effective_input_to_output_scale_b, output_state_ptr,</div>
<div class="line"><span class="lineno">  725</span>    recurrent_to_output_weight_ptr, recurrent_to_output_effective_bias,</div>
<div class="line"><span class="lineno">  726</span>    effective_recurrent_to_output_scale_a, effective_recurrent_to_output_scale_b, cell_state_ptr,</div>
<div class="line"><span class="lineno">  727</span>    cell_to_output_weight_ptr, effective_cell_to_output_scale_a, effective_cell_to_output_scale_b,</div>
<div class="line"><span class="lineno">  728</span>    layer_norm_output_weight_ptr, output_gate_bias_ptr, layer_norm_output_scale_a,</div>
<div class="line"><span class="lineno">  729</span>    layer_norm_output_scale_b, output_variance_guard, n_batch, n_input, n_output, n_cell,</div>
<div class="line"><span class="lineno">  730</span>    kTfLiteActSigmoid, output_gate_scratch, scratch5);</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>  <span class="comment">// Update the output state.</span></div>
<div class="line"><span class="lineno">  733</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#ad07afcc83af092c475787d8184538098">calculate_lstm_output_integer8x8_16</a>(</div>
<div class="line"><span class="lineno">  734</span>    n_batch, n_cell, n_output, cell_state_ptr, cell_state_scale, output_gate_scratch,</div>
<div class="line"><span class="lineno">  735</span>    effective_hidden_scale_a, effective_hidden_scale_b, hidden_zp, projection_weight_ptr,</div>
<div class="line"><span class="lineno">  736</span>    effective_proj_scale_a, effective_proj_scale_b, projection_effective_bias, output_state_zp,</div>
<div class="line"><span class="lineno">  737</span>    quantized_proj_clip, output_state_ptr, scratch0, scratch4, scratch5);</div>
<div class="line"><span class="lineno">  738</span>  <span class="comment">// Copy output state to the output. Note that unlike float or hybrid, output</span></div>
<div class="line"><span class="lineno">  739</span>  <span class="comment">// is always contiguous.</span></div>
<div class="line"><span class="lineno">  740</span>  std::copy_n(output_state_ptr, n_batch * n_output, output_ptr);</div>
<div class="line"><span class="lineno">  741</span>}</div>
<div class="ttc" id="acompiler_2luci-interpreter_2src_2kernels_2_utils_8h_html_a231f5fa1ff2a3f19222b42cc9bbd1f2d"><div class="ttname"><a href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h.html#a231f5fa1ff2a3f19222b42cc9bbd1f2d">LUCI_INTERPRETER_CHECK</a></div><div class="ttdeci">#define LUCI_INTERPRETER_CHECK(cond)</div><div class="ttdef"><b>Definition:</b> <a href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h_source.html#l00036">Utils.h:36</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ab554f067a0e70af0121424c774ad3880"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ab554f067a0e70af0121424c774ad3880">luci_interpreter_pal::lstm::update_lstm_cell_integer</a></div><div class="ttdeci">void update_lstm_cell_integer(int n_batch, int n_cell, int16_t *cell_state, int32_t cell_state_scale, const int16_t *input_gate, int16_t *forget_gate, const int16_t *cell_gate, bool use_cifg, int16_t clip)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">PALUnidirectionalSequenceLSTM.h:413</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_ad07afcc83af092c475787d8184538098"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#ad07afcc83af092c475787d8184538098">luci_interpreter_pal::lstm::calculate_lstm_output_integer8x8_16</a></div><div class="ttdeci">void calculate_lstm_output_integer8x8_16(int n_batch, int n_cell, int n_output, int16_t *cell_state, int32_t cell_state_scale, const int16_t *output_gate, int32_t hidden_scale_a, int32_t hidden_scale_b, int32_t hidden_zp, const int8_t *projection_weights, int32_t proj_scale_a, int32_t proj_scale_b, const int32_t *projection_bias, int32_t output_state_zp, int8_t quantized_proj_clip, int8_t *output_state, int16_t *scratch0, int8_t *scratch1, int32_t *scratch2)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">PALUnidirectionalSequenceLSTM.h:350</a></div></div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_adaa95dd338f0bbd9be680fd7dfc6d1aa"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#adaa95dd338f0bbd9be680fd7dfc6d1aa">luci_interpreter_pal::lstm::calculate_lstm_gate_integer_8x8_16</a></div><div class="ttdeci">void calculate_lstm_gate_integer_8x8_16(const int8_t *input, const int8_t *input_to_gate_weights, const int32_t *input_to_gate_bias, const int32_t input_to_gate_scale_a, const int32_t input_to_gate_scale_b, const int8_t *output_state, const int8_t *recurrent_to_gate_weights, const int32_t *recurrent_to_gate_bias, const int32_t recurrent_to_gate_scale_a, const int32_t recurrent_to_gate_scale_b, const int16_t *cell_state, const int16_t *cell_to_gate_weights, const int32_t cell_to_gate_scale_a, const int32_t cell_to_gate_scale_b, const int16_t *layer_norm_coefficients, const int32_t *layer_norm_bias, const int32_t layer_norm_input_scale_a, const int32_t layer_norm_input_scale_b, const int32_t layer_norm_variance_guard, const int n_batch, const int n_input, const int n_output, const int n_cell, const TfLiteFusedActivation activation, int16_t *gate, int32_t *scratch5)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00443">PALUnidirectionalSequenceLSTM.h:443</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00443">calculate_lstm_gate_integer_8x8_16()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">calculate_lstm_output_integer8x8_16()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00039">kTfLiteActSigmoid</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00037">kTfLiteActTanh</a>, <a class="el" href="compiler_2luci-interpreter_2src_2kernels_2_utils_8h_source.html#l00036">LUCI_INTERPRETER_CHECK</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">update_lstm_cell_integer()</a>.</p>

</div>
</div>
<a id="ad9970c643958b6d2c26dcd2506bac62b" name="ad9970c643958b6d2c26dcd2506bac62b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9970c643958b6d2c26dcd2506bac62b">&#9670;&#160;</a></span>matrix_batch_vector_multiply_accumulate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::matrix_batch_vector_multiply_accumulate </td>
          <td>(</td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t *&#160;</td>
          <td class="paramname"><em>bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>input_to_gate_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>multiplier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>n_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>output_zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00257">257</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  262</span>{</div>
<div class="line"><span class="lineno">  263</span>  <span class="keyword">const</span> int16_t output_max = std::numeric_limits&lt;T&gt;::max();</div>
<div class="line"><span class="lineno">  264</span>  <span class="keyword">const</span> int16_t output_min = std::numeric_limits&lt;T&gt;::min();</div>
<div class="line"><span class="lineno">  265</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> batch = 0; batch &lt; n_batch; ++batch)</div>
<div class="line"><span class="lineno">  266</span>  {</div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; n_output; ++row)</div>
<div class="line"><span class="lineno">  268</span>    {</div>
<div class="line"><span class="lineno">  269</span>      int32_t acc = bias[row];</div>
<div class="line"><span class="lineno">  270</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; n_input; ++col)</div>
<div class="line"><span class="lineno">  271</span>      {</div>
<div class="line"><span class="lineno">  272</span>        int8_t input_val = input[batch * n_input + col];</div>
<div class="line"><span class="lineno">  273</span>        int8_t weights_val = input_to_gate_weights[row * n_input + col];</div>
<div class="line"><span class="lineno">  274</span>        acc += input_val * weights_val;</div>
<div class="line"><span class="lineno">  275</span>      }</div>
<div class="line"><span class="lineno">  276</span>      acc = multiply_by_quantized_multiplier(acc, multiplier, shift);</div>
<div class="line"><span class="lineno">  277</span>      acc += output_zp;</div>
<div class="line"><span class="lineno">  278</span>      acc += output[batch * n_output + row];</div>
<div class="line"><span class="lineno">  279</span>      <span class="keywordflow">if</span> (acc &gt; output_max)</div>
<div class="line"><span class="lineno">  280</span>      {</div>
<div class="line"><span class="lineno">  281</span>        acc = output_max;</div>
<div class="line"><span class="lineno">  282</span>      }</div>
<div class="line"><span class="lineno">  283</span>      <span class="keywordflow">if</span> (acc &lt; output_min)</div>
<div class="line"><span class="lineno">  284</span>      {</div>
<div class="line"><span class="lineno">  285</span>        acc = output_min;</div>
<div class="line"><span class="lineno">  286</span>      }</div>
<div class="line"><span class="lineno">  287</span>      <a class="code hl_variable" href="namespacegen__h5__explicit__inputs.html#acd1aa9ba45d45c6b619b723e6e34c576">output</a>[batch * n_output + row] = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(acc);</div>
<div class="line"><span class="lineno">  288</span>    }</div>
<div class="line"><span class="lineno">  289</span>  }</div>
<div class="line"><span class="lineno">  290</span>}</div>
<div class="ttc" id="anamespacegen__h5__explicit__inputs_html_acd1aa9ba45d45c6b619b723e6e34c576"><div class="ttname"><a href="namespacegen__h5__explicit__inputs.html#acd1aa9ba45d45c6b619b723e6e34c576">gen_h5_explicit_inputs.output</a></div><div class="ttdeci">output</div><div class="ttdef"><b>Definition:</b> <a href="gen__h5__explicit__inputs_8py_source.html#l00035">gen_h5_explicit_inputs.py:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00042">multiply_by_quantized_multiplier()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00443">calculate_lstm_gate_integer_8x8_16()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00350">calculate_lstm_output_integer8x8_16()</a>.</p>

</div>
</div>
<a id="acbe525077503e0d3f37d59b7fc8276e2" name="acbe525077503e0d3f37d59b7fc8276e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbe525077503e0d3f37d59b7fc8276e2">&#9670;&#160;</a></span>multiply_by_quantized_multiplier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32_t luci_interpreter_pal::lstm::multiply_by_quantized_multiplier </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>quantized_multiplier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00042">42</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>{</div>
<div class="line"><span class="lineno">   44</span>  <span class="keyword">using </span>gemmlowp::RoundingDivideByPOT;</div>
<div class="line"><span class="lineno">   45</span>  <span class="keyword">using </span>gemmlowp::SaturatingRoundingDoublingHighMul;</div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordtype">int</span> left_shift = shift &gt; 0 ? shift : 0;</div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordtype">int</span> right_shift = shift &gt; 0 ? 0 : -shift;</div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordflow">return</span> RoundingDivideByPOT(</div>
<div class="line"><span class="lineno">   49</span>    SaturatingRoundingDoublingHighMul(x * (1 &lt;&lt; left_shift), quantized_multiplier), right_shift);</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00186">apply_layer_norm()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00052">cwise_mul()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00257">matrix_batch_vector_multiply_accumulate()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00238">vector_batch_vector_cwise_product_accumulate()</a>.</p>

</div>
</div>
<a id="a7b3a8ce5736307c9146154fd4639e0cb" name="a7b3a8ce5736307c9146154fd4639e0cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3a8ce5736307c9146154fd4639e0cb">&#9670;&#160;</a></span>sub1_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::sub1_vector </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00072">72</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>{</div>
<div class="line"><span class="lineno">   74</span>  <span class="keyword">static</span> <span class="keyword">const</span> int16_t kOne = 32767;</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; v_size; v++)</div>
<div class="line"><span class="lineno">   76</span>  {</div>
<div class="line"><span class="lineno">   77</span>    *result++ = kOne - *vector++;</div>
<div class="line"><span class="lineno">   78</span>  }</div>
<div class="line"><span class="lineno">   79</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">update_lstm_cell_integer()</a>.</p>

</div>
</div>
<a id="ab554f067a0e70af0121424c774ad3880" name="ab554f067a0e70af0121424c774ad3880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab554f067a0e70af0121424c774ad3880">&#9670;&#160;</a></span>update_lstm_cell_integer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::update_lstm_cell_integer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>cell_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>cell_state_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>input_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>forget_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>cell_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_cifg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>clip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00413">413</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  417</span>{</div>
<div class="line"><span class="lineno">  418</span>  <span class="comment">// Use the forget_gate array as scratch, as input_gate array is not allocated</span></div>
<div class="line"><span class="lineno">  419</span>  <span class="comment">// in CIFG case. (Be careful not to write to the scratch before reading the</span></div>
<div class="line"><span class="lineno">  420</span>  <span class="comment">// forget gate data.)</span></div>
<div class="line"><span class="lineno">  421</span>  int16_t *scratch = forget_gate;</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>  <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#a13269908e5cbb4827f974e782b98f6b2">cwise_mul</a>(forget_gate, cell_state, n_batch, n_cell, 15, cell_state);</div>
<div class="line"><span class="lineno">  424</span>  <span class="keywordflow">if</span> (use_cifg)</div>
<div class="line"><span class="lineno">  425</span>  {</div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#a7b3a8ce5736307c9146154fd4639e0cb">sub1_vector</a>(forget_gate, n_batch * n_cell, scratch);</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#a13269908e5cbb4827f974e782b98f6b2">cwise_mul</a>(scratch, cell_gate, n_batch, n_cell, 30 + cell_state_scale, scratch);</div>
<div class="line"><span class="lineno">  428</span>  }</div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  430</span>  {</div>
<div class="line"><span class="lineno">  431</span>    cwise_mul(input_gate, cell_gate, n_batch, n_cell, 30 + cell_state_scale, scratch);</div>
<div class="line"><span class="lineno">  432</span>  }</div>
<div class="line"><span class="lineno">  433</span>  cwise_add(cell_state, scratch, n_batch, n_cell, cell_state);</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordflow">if</span> (clip &gt; 0)</div>
<div class="line"><span class="lineno">  436</span>  {</div>
<div class="line"><span class="lineno">  437</span>    cwise_clipping(cell_state, n_batch * n_cell, clip);</div>
<div class="line"><span class="lineno">  438</span>  }</div>
<div class="line"><span class="lineno">  439</span>}</div>
<div class="ttc" id="anamespaceluci__interpreter__pal_1_1lstm_html_a7b3a8ce5736307c9146154fd4639e0cb"><div class="ttname"><a href="namespaceluci__interpreter__pal_1_1lstm.html#a7b3a8ce5736307c9146154fd4639e0cb">luci_interpreter_pal::lstm::sub1_vector</a></div><div class="ttdeci">void sub1_vector(const int16_t *vector, int v_size, int16_t *result)</div><div class="ttdef"><b>Definition:</b> <a href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00072">PALUnidirectionalSequenceLSTM.h:72</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00089">cwise_add()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00081">cwise_clipping()</a>, <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00052">cwise_mul()</a>, and <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00072">sub1_vector()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00612">lstm_step_integer_8x8_16()</a>.</p>

</div>
</div>
<a id="a7361af5bb813813c50859760c4cc8f8a" name="a7361af5bb813813c50859760c4cc8f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7361af5bb813813c50859760c4cc8f8a">&#9670;&#160;</a></span>vector_batch_vector_cwise_product_accumulate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void luci_interpreter_pal::lstm::vector_batch_vector_cwise_product_accumulate </td>
          <td>(</td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>batch_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>multiplier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00238">238</a> of file <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html">PALUnidirectionalSequenceLSTM.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span>{</div>
<div class="line"><span class="lineno">  242</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; n_batch; b++)</div>
<div class="line"><span class="lineno">  243</span>  {</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; v_size; v++)</div>
<div class="line"><span class="lineno">  245</span>    {</div>
<div class="line"><span class="lineno">  246</span>      int32_t prod = vector[v] * *batch_vector++;</div>
<div class="line"><span class="lineno">  247</span>      prod = <a class="code hl_function" href="namespaceluci__interpreter__pal_1_1lstm.html#acbe525077503e0d3f37d59b7fc8276e2">multiply_by_quantized_multiplier</a>(prod, multiplier, shift);</div>
<div class="line"><span class="lineno">  248</span>      int32_t output = prod + *result;</div>
<div class="line"><span class="lineno">  249</span>      output =</div>
<div class="line"><span class="lineno">  250</span>        std::max(std::min(<span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(32767), output), <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(-32768));</div>
<div class="line"><span class="lineno">  251</span>      *result++ = output;</div>
<div class="line"><span class="lineno">  252</span>    }</div>
<div class="line"><span class="lineno">  253</span>  }</div>
<div class="line"><span class="lineno">  254</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00042">multiply_by_quantized_multiplier()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mcu_2_p_a_l_unidirectional_sequence_l_s_t_m_8h_source.html#l00443">calculate_lstm_gate_integer_8x8_16()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceluci__interpreter__pal.html">luci_interpreter_pal</a></li><li class="navelem"><a class="el" href="namespaceluci__interpreter__pal_1_1lstm.html">lstm</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
