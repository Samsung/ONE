<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ONE - On-device Neural Engine: nnfw::cker::train Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ONE - On-device Neural Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacennfw_1_1cker_1_1train.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">nnfw::cker::train Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacennfw_1_1cker_1_1train_1_1functor"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train_1_1functor.html">functor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnfw_1_1cker_1_1train_1_1_depthwise_conv.html">DepthwiseConv</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_filter_op.html">LaunchConv2DBackpropFilterOp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_input_op.html">LaunchConv2DBackpropInputOp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_input_op_impl.html">LaunchConv2DBackpropInputOpImpl</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae29ea521cae886584982a2e79ef0af5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#ae29ea521cae886584982a2e79ef0af5c">ConvInputGrad</a> (const <a class="el" href="structnnfw_1_1cker_1_1_conv_params.html">ConvParams</a> &amp;params, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const float *incoming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;filter_shape, const float *filter_data, const int padding_bottom, const int padding_right, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, float *grad_data)</td></tr>
<tr class="separator:ae29ea521cae886584982a2e79ef0af5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6d9df3c503c8a24c1994e73bced227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#ade6d9df3c503c8a24c1994e73bced227">ConvFilterGrad</a> (const <a class="el" href="structnnfw_1_1cker_1_1_conv_params.html">ConvParams</a> &amp;params, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const float *incoming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;input_shape, const float *input_data, const int padding_bottom, const int padding_right, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;filter_backprop_shape, float *filter_backprop_data)</td></tr>
<tr class="separator:ade6d9df3c503c8a24c1994e73bced227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae451e8541f4091a1c41c54ba240824f4"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ae451e8541f4091a1c41c54ba240824f4"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#ae451e8541f4091a1c41c54ba240824f4">FullyConnectedBiasGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incomming_shape, const T *incomming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, T *grad_data)</td></tr>
<tr class="separator:ae451e8541f4091a1c41c54ba240824f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73263e409724ca45f5cf2dba525d4b0"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ab73263e409724ca45f5cf2dba525d4b0"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#ab73263e409724ca45f5cf2dba525d4b0">square</a> (T value)</td></tr>
<tr class="separator:ab73263e409724ca45f5cf2dba525d4b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6219f86d7d6197357e94a6feb860a2fa"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a6219f86d7d6197357e94a6feb860a2fa"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a6219f86d7d6197357e94a6feb860a2fa">log_threshold</a> ()</td></tr>
<tr class="separator:a6219f86d7d6197357e94a6feb860a2fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac56dcc0882ef61d9d8f9c9132d917ba0"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ac56dcc0882ef61d9d8f9c9132d917ba0"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#ac56dcc0882ef61d9d8f9c9132d917ba0">MSE</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_pred_shape, const T *y_pred_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_true_shape, const T *y_true_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, T *output_data)</td></tr>
<tr class="separator:ac56dcc0882ef61d9d8f9c9132d917ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23fc8a7fd2e8068b5bb1b07a581e0936"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a23fc8a7fd2e8068b5bb1b07a581e0936"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a23fc8a7fd2e8068b5bb1b07a581e0936">MSEGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_pred_shape, const T *y_pred_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_true_shape, const T *y_true_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, T *grad_data)</td></tr>
<tr class="separator:a23fc8a7fd2e8068b5bb1b07a581e0936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7878621644fcff89f4f06359077ad4d1"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a7878621644fcff89f4f06359077ad4d1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a7878621644fcff89f4f06359077ad4d1">CategoricalCrossEntropy</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_pred_shape, const T *y_pred_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_true_shape, const T *y_true_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, T *output_data)</td></tr>
<tr class="separator:a7878621644fcff89f4f06359077ad4d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aed62343258e8bc05dac2924c184f5e"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a1aed62343258e8bc05dac2924c184f5e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a1aed62343258e8bc05dac2924c184f5e">CategoricalCrossEntropyGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_pred_shape, const T *y_pred_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;y_true_shape, const T *y_true_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, T *grad_data)</td></tr>
<tr class="separator:a1aed62343258e8bc05dac2924c184f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5383dd7006f6272ba54849c0bb709350"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a5383dd7006f6272ba54849c0bb709350">MaxPool2D</a> (const <a class="el" href="structnnfw_1_1cker_1_1_pool_params.html">PoolParams</a> &amp;params, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;input_shape, const float *input_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, float *output_data, int *arg_max_index)</td></tr>
<tr class="separator:a5383dd7006f6272ba54849c0bb709350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f474cf700e72f893fd4b9470d584db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#ab1f474cf700e72f893fd4b9470d584db">MaxPool2DGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const float *incoming_data, const int *arg_max_index, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, float *grad_data)</td></tr>
<tr class="separator:ab1f474cf700e72f893fd4b9470d584db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52345a6f0694577d6369713c74e7d027"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a52345a6f0694577d6369713c74e7d027"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a52345a6f0694577d6369713c74e7d027">MeanGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const T *incoming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, T *grad_data)</td></tr>
<tr class="separator:a52345a6f0694577d6369713c74e7d027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ba869240e3cb2e543a61e176115d8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a56ba869240e3cb2e543a61e176115d8f">ReLUGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, const float *output_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const float *incoming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, float *grad_data)</td></tr>
<tr class="separator:a56ba869240e3cb2e543a61e176115d8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe5949773bbbe4ca31565a0eacbd11c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#abe5949773bbbe4ca31565a0eacbd11c2">ReLU6Grad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, const float *output_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const float *incoming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, float *grad_data)</td></tr>
<tr class="separator:abe5949773bbbe4ca31565a0eacbd11c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b6afe0db84836d197f52230d77b913f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a8b6afe0db84836d197f52230d77b913f">SoftMaxGrad</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, const float *output_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;incoming_shape, const float *incoming_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, float *grad_data)</td></tr>
<tr class="separator:a8b6afe0db84836d197f52230d77b913f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abad94c85023d66d3bc85d6a460750b41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#abad94c85023d66d3bc85d6a460750b41">Adam</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;trainable_shape, float *trainable_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, const float *grad_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;m_shape, float *m_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;v_shape, float *v_data, float beta1_power, float beta2_power, float learning_rate, float beta1, float beta2, float epsilon, bool use_nesterov)</td></tr>
<tr class="separator:abad94c85023d66d3bc85d6a460750b41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f9531730e397d0a135dc4881b18fd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacennfw_1_1cker_1_1train.html#a36f9531730e397d0a135dc4881b18fd0">GradientDescent</a> (const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;<a class="el" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, float *output_data, const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;grad_shape, const float *grad_data, float learning_rate)</td></tr>
<tr class="separator:a36f9531730e397d0a135dc4881b18fd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abad94c85023d66d3bc85d6a460750b41" name="abad94c85023d66d3bc85d6a460750b41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abad94c85023d66d3bc85d6a460750b41">&#9670;&#160;</a></span>Adam()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::Adam </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>trainable_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>trainable_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>grad_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>m_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>m_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>v_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>v_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>beta1_power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>beta2_power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>learning_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>beta1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>beta2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_nesterov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2optimizer_2_adam_8h_source.html#l00033">33</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2optimizer_2_adam_8h_source.html">Adam.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>{</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> trainable_tensor;</div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> grad_tensor;</div>
<div class="line"><span class="lineno">   40</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> m_tensor;</div>
<div class="line"><span class="lineno">   41</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> v_tensor;</div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> beta1_power_tensor;</div>
<div class="line"><span class="lineno">   43</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> beta2_power_tensor;</div>
<div class="line"><span class="lineno">   44</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> lr_tensor;</div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> beta1_tensor;</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> beta2_tensor;</div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> epsilon_tensor;</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  trainable_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a14357cda4dbb3b72a4c20e912a14f01d">shape</a>.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a3eb902ab9d3bade541a06bb4320d14b3">ReplaceWith</a>(trainable_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>(), trainable_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ae77616d0ab21c7f405129c2fd6d77cc4">DimsData</a>());</div>
<div class="line"><span class="lineno">   50</span>  trainable_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = trainable_data;</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>  grad_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a14357cda4dbb3b72a4c20e912a14f01d">shape</a>.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a3eb902ab9d3bade541a06bb4320d14b3">ReplaceWith</a>(grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>(), grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ae77616d0ab21c7f405129c2fd6d77cc4">DimsData</a>());</div>
<div class="line"><span class="lineno">   53</span>  grad_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = <span class="keyword">const_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(grad_data);</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>  m_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a14357cda4dbb3b72a4c20e912a14f01d">shape</a>.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a3eb902ab9d3bade541a06bb4320d14b3">ReplaceWith</a>(m_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>(), m_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ae77616d0ab21c7f405129c2fd6d77cc4">DimsData</a>());</div>
<div class="line"><span class="lineno">   56</span>  m_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = m_data;</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  v_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a14357cda4dbb3b72a4c20e912a14f01d">shape</a>.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a3eb902ab9d3bade541a06bb4320d14b3">ReplaceWith</a>(v_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>(), v_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ae77616d0ab21c7f405129c2fd6d77cc4">DimsData</a>());</div>
<div class="line"><span class="lineno">   59</span>  v_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = v_data;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  std::vector&lt;float&gt; beta1_power_vec{beta1_power};</div>
<div class="line"><span class="lineno">   62</span>  beta1_power_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = beta1_power_vec.data();</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  std::vector&lt;float&gt; beta2_power_vec{beta2_power};</div>
<div class="line"><span class="lineno">   65</span>  beta2_power_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = beta2_power_vec.data();</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  std::vector&lt;float&gt; lr_vec{learning_rate};</div>
<div class="line"><span class="lineno">   68</span>  lr_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = lr_vec.data();</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  std::vector&lt;float&gt; beta1_vec{beta1};</div>
<div class="line"><span class="lineno">   71</span>  beta1_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = beta1_vec.data();</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  std::vector&lt;float&gt; beta2_vec{beta2};</div>
<div class="line"><span class="lineno">   74</span>  beta2_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = beta2_vec.data();</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  std::vector&lt;float&gt; epsilon_vec{epsilon};</div>
<div class="line"><span class="lineno">   77</span>  epsilon_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = epsilon_vec.data();</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordflow">if</span> (trainable_shape != m_shape)</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::Adam: output and m do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <span class="keywordflow">if</span> (trainable_shape != v_shape)</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::Adam: output and v do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <span class="keywordflow">if</span> (trainable_shape != grad_shape)</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::Adam: output and gradient do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <span class="keyword">const</span> training_ops::CPUDevice &amp;device = *eigen_support::GetThreadPoolDevice();</div>
<div class="line"><span class="lineno">   89</span>  training_ops::functor::ApplyAdam&lt;training_ops::CPUDevice, float&gt;()(</div>
<div class="line"><span class="lineno">   90</span>    device, trainable_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#afb0643e95f01b7cf6fba692d6755bbbe">flat</a>&lt;<span class="keywordtype">float</span>&gt;(), m_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#afb0643e95f01b7cf6fba692d6755bbbe">flat</a>&lt;<span class="keywordtype">float</span>&gt;(), v_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#afb0643e95f01b7cf6fba692d6755bbbe">flat</a>&lt;<span class="keywordtype">float</span>&gt;(),</div>
<div class="line"><span class="lineno">   91</span>    beta1_power_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(), beta2_power_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(),</div>
<div class="line"><span class="lineno">   92</span>    lr_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(), beta1_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(), beta2_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(),</div>
<div class="line"><span class="lineno">   93</span>    epsilon_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(), <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_class" href="class_tensor.html">Tensor</a> &amp;<span class="keyword">&gt;</span>(grad_tensor).flat&lt;<span class="keywordtype">float</span>&gt;(),</div>
<div class="line"><span class="lineno">   94</span>    use_nesterov);</div>
<div class="line"><span class="lineno">   95</span>}</div>
<div class="ttc" id="aclass_tensor_html"><div class="ttname"><a href="class_tensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="tensor__gen_8cpp_source.html#l00031">tensor_gen.cpp:32</a></div></div>
<div class="ttc" id="aclassnnfw_1_1cker_1_1_shape_html_a01c6b5dc4b24d5c2567c47cb15318839"><div class="ttname"><a href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">nnfw::cker::Shape::DimensionsCount</a></div><div class="ttdeci">int32_t DimensionsCount() const</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">Shape.h:93</a></div></div>
<div class="ttc" id="aclassnnfw_1_1cker_1_1_shape_html_a3eb902ab9d3bade541a06bb4320d14b3"><div class="ttname"><a href="classnnfw_1_1cker_1_1_shape.html#a3eb902ab9d3bade541a06bb4320d14b3">nnfw::cker::Shape::ReplaceWith</a></div><div class="ttdeci">void ReplaceWith(int dimensions_count, const int32_t *dims_data)</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00132">Shape.h:132</a></div></div>
<div class="ttc" id="aclassnnfw_1_1cker_1_1_shape_html_ae77616d0ab21c7f405129c2fd6d77cc4"><div class="ttname"><a href="classnnfw_1_1cker_1_1_shape.html#ae77616d0ab21c7f405129c2fd6d77cc4">nnfw::cker::Shape::DimsData</a></div><div class="ttdeci">int32_t * DimsData()</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00114">Shape.h:114</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_tensor_html"><div class="ttname"><a href="structnnfw_1_1cker_1_1_tensor.html">nnfw::cker::Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00094">Tensor.h:95</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_tensor_html_a13d259f71d97a07d113b5ff016b610f8"><div class="ttname"><a href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">nnfw::cker::Tensor::scalar</a></div><div class="ttdeci">TTypes&lt; T &gt;::ConstScalar scalar() const</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00156">Tensor.h:156</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_tensor_html_a14357cda4dbb3b72a4c20e912a14f01d"><div class="ttname"><a href="structnnfw_1_1cker_1_1_tensor.html#a14357cda4dbb3b72a4c20e912a14f01d">nnfw::cker::Tensor::shape</a></div><div class="ttdeci">Shape shape</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00096">Tensor.h:96</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_tensor_html_a712edb68cf1350d930c3d8a733212801"><div class="ttname"><a href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">nnfw::cker::Tensor::buffer</a></div><div class="ttdeci">void * buffer</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00097">Tensor.h:97</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_tensor_html_afb0643e95f01b7cf6fba692d6755bbbe"><div class="ttname"><a href="structnnfw_1_1cker_1_1_tensor.html#afb0643e95f01b7cf6fba692d6755bbbe">nnfw::cker::Tensor::flat</a></div><div class="ttdeci">TTypes&lt; T &gt;::Flat flat()</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00127">Tensor.h:127</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00097">nnfw::cker::Tensor::buffer</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">nnfw::cker::Shape::DimensionsCount()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00114">nnfw::cker::Shape::DimsData()</a>, <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00127">nnfw::cker::Tensor::flat()</a>, <a class="el" href="_eigen_support_8h_source.html#l00110">nnfw::cker::eigen_support::GetThreadPoolDevice()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00132">nnfw::cker::Shape::ReplaceWith()</a>, <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00156">nnfw::cker::Tensor::scalar()</a>, and <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00096">nnfw::cker::Tensor::shape</a>.</p>

<p class="reference">Referenced by <a class="el" href="_adam_8cc_source.html#l00039">onert::backend::train::optimizer::Adam::applyGradient()</a>.</p>

</div>
</div>
<a id="a7878621644fcff89f4f06359077ad4d1" name="a7878621644fcff89f4f06359077ad4d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7878621644fcff89f4f06359077ad4d1">&#9670;&#160;</a></span>CategoricalCrossEntropy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::CategoricalCrossEntropy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_pred_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_pred_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_true_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_true_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>output_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00077">77</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html">Loss.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>{</div>
<div class="line"><span class="lineno">   81</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.DimensionsCount() != 1)</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::CategoricalCrossEntropy: output dimension count should be 1&quot;</span>);</div>
<div class="line"><span class="lineno">   83</span>  <span class="keywordflow">if</span> (y_pred_shape != y_true_shape)</div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><span class="lineno">   85</span>      <span class="stringliteral">&quot;cker::CategoricalCrossEntropy: y_pred and y_true do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.Dims(0) != y_pred_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0))</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><span class="lineno">   88</span>      <span class="stringliteral">&quot;cker::CategoricalCrossEntropy: output and y_pred do not have the same batch&quot;</span>);</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  <span class="keyword">const</span> <span class="keyword">auto</span> y_pred = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(y_pred_data, y_pred_shape);</div>
<div class="line"><span class="lineno">   91</span>  <span class="keyword">const</span> <span class="keyword">auto</span> y_true = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(y_true_data, y_true_shape);</div>
<div class="line"><span class="lineno">   92</span>  <span class="keyword">auto</span> output = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(output_data, <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  output = -(y_true.array() * y_pred.array().cwiseMax(log_threshold&lt;T&gt;()).log()).colwise().sum();</div>
<div class="line"><span class="lineno">   95</span>}</div>
<div class="ttc" id="a_matrix_8h_html_a4dbf05dabea32cf4bc0693e0cc32d984"><div class="ttname"><a href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a></div><div class="ttdeci">VectorMap&lt; Scalar &gt; MapAsVector(Scalar *data, const Dims&lt; N &gt; &amp;dims)</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_8h_source.html#l00040">Matrix.h:40</a></div></div>
<div class="ttc" id="a_p_a_l_comparisons_8h_html_a74a475996321e12d590d9029e114d8d0"><div class="ttname"><a href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a></div><div class="ttdeci">const luci_interpreter::RuntimeShape output_shape</div><div class="ttdef"><b>Definition:</b> <a href="_p_a_l_comparisons_8h_source.html#l00032">PALComparisons.h:32</a></div></div>
<div class="ttc" id="aclassnnfw_1_1cker_1_1_shape_html_a497180ee7844bbef51b36bd58e61fa31"><div class="ttname"><a href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">nnfw::cker::Shape::Dims</a></div><div class="ttdeci">int32_t Dims(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">Shape.h:94</a></div></div>
<div class="ttc" id="anamespacennfw_1_1cker_html_a5661008cc0dc7e29714ea90ca28efea4"><div class="ttname"><a href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">nnfw::cker::MapAsMatrixWithLastDimAsRows</a></div><div class="ttdeci">MatrixMap&lt; Scalar &gt; MapAsMatrixWithLastDimAsRows(Scalar *data, const Shape &amp;shape)</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">Utils.h:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">nnfw::cker::MapAsMatrixWithLastDimAsRows()</a>, <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00043">nnfw::cker::MapAsVector()</a>, and <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>.</p>

<p class="reference">Referenced by <a class="el" href="_loss_categorical_crossentropy_layer_8cc_source.html#l00043">onert::backend::train::ops::LossCategoricalCrossentropyLayer::forward()</a>.</p>

</div>
</div>
<a id="a1aed62343258e8bc05dac2924c184f5e" name="a1aed62343258e8bc05dac2924c184f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aed62343258e8bc05dac2924c184f5e">&#9670;&#160;</a></span>CategoricalCrossEntropyGrad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::CategoricalCrossEntropyGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_pred_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_pred_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_true_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_true_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00098">98</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html">Loss.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  101</span>{</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">if</span> (y_pred_shape != y_true_shape)</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><span class="lineno">  104</span>      <span class="stringliteral">&quot;cker::CategoricalCrossEntropyGrad: y_pred and y_true do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordflow">if</span> (y_pred_shape != grad_shape)</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><span class="lineno">  107</span>      <span class="stringliteral">&quot;cker::CategoricalCrossEntropyGrad: y_pred and grad do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <span class="keyword">const</span> <span class="keyword">auto</span> y_pred = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(y_pred_data, y_pred_shape);</div>
<div class="line"><span class="lineno">  110</span>  <span class="keyword">const</span> <span class="keyword">auto</span> y_true = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(y_true_data, y_true_shape);</div>
<div class="line"><span class="lineno">  111</span>  <span class="keyword">auto</span> grad = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(grad_data, grad_shape);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  grad = -(y_true.array() / y_pred.array().cwiseMax(log_threshold&lt;T&gt;()));</div>
<div class="line"><span class="lineno">  114</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">nnfw::cker::MapAsMatrixWithLastDimAsRows()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_loss_categorical_crossentropy_layer_8cc_source.html#l00057">onert::backend::train::ops::LossCategoricalCrossentropyLayer::backward()</a>.</p>

</div>
</div>
<a id="ade6d9df3c503c8a24c1994e73bced227" name="ade6d9df3c503c8a24c1994e73bced227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6d9df3c503c8a24c1994e73bced227">&#9670;&#160;</a></span>ConvFilterGrad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::ConvFilterGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnnfw_1_1cker_1_1_conv_params.html">ConvParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>input_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>padding_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>padding_right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>filter_backprop_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>filter_backprop_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_conv_8h_source.html#l00225">225</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_conv_8h_source.html">Conv.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>{</div>
<div class="line"><span class="lineno">  231</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stride_rows = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a0878ee74c474c8a82a574727a2a3048e">stride_height</a>;</div>
<div class="line"><span class="lineno">  232</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stride_cols = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a273ecef205d663377502d9dcaa77f1b4">stride_width</a>;</div>
<div class="line"><span class="lineno">  233</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="namespacennfw_1_1cker.html#a214af5851ca7b77819a78cf4177eb754">PaddingType</a> padding = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#ac0164e1731843fbc98df6f1d352bbc0c">padding_type</a>;</div>
<div class="line"><span class="lineno">  234</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> padding_top = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a0a3450e62d20d27c2638d197f1fd2bb2">padding_values</a>.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_padding_values.html#a1dc41a9ebbd61a7c34ed2b5dd2ec10eb">height</a>;</div>
<div class="line"><span class="lineno">  235</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> padding_left = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a0a3450e62d20d27c2638d197f1fd2bb2">padding_values</a>.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_padding_values.html#a2a3dd79d28c30c5da865290160601fd1">width</a>;</div>
<div class="line"><span class="lineno">  236</span>  assert(padding_top &gt;= 0);</div>
<div class="line"><span class="lineno">  237</span>  assert(padding_bottom &gt;= 0);</div>
<div class="line"><span class="lineno">  238</span>  assert(padding_left &gt;= 0);</div>
<div class="line"><span class="lineno">  239</span>  assert(padding_right &gt;= 0);</div>
<div class="line"><span class="lineno">  240</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> dilation_rows = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#ad47b94004b5b1718979775edaa9eee70">dilation_height_factor</a>;</div>
<div class="line"><span class="lineno">  241</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> dilation_cols = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a8ff1e952b2e7627e11b47a22da0883cb">dilation_width_factor</a>;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> batches = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(input_shape, 0, incoming_shape, 0);</div>
<div class="line"><span class="lineno">  244</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_depth = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(filter_backprop_shape, 2, input_shape, 3);</div>
<div class="line"><span class="lineno">  245</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> output_depth = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(filter_backprop_shape, 3, incoming_shape, 3);</div>
<div class="line"><span class="lineno">  246</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_height = input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">  247</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_width = input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(2);</div>
<div class="line"><span class="lineno">  248</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> filter_backprop_height = filter_backprop_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0);</div>
<div class="line"><span class="lineno">  249</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> filter_backprop_width = filter_backprop_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">  250</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> incoming_height = incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">  251</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> incoming_width = incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(2);</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  <span class="keywordflow">if</span> (dilation_rows != 1 || dilation_cols != 1)</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::ConvFilterGrad: not yet support dilation rates larger than 1.&quot;</span>);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_filter_op.html">LaunchConv2DBackpropFilterOp&lt;float&gt;</a>()(</div>
<div class="line"><span class="lineno">  257</span>    incoming_data, batches, incoming_height, incoming_width, output_depth, input_data, input_height,</div>
<div class="line"><span class="lineno">  258</span>    input_width, input_depth, dilation_rows, dilation_cols, stride_rows, stride_cols, padding,</div>
<div class="line"><span class="lineno">  259</span>    padding_top, padding_bottom, padding_left, padding_right, filter_backprop_data,</div>
<div class="line"><span class="lineno">  260</span>    filter_backprop_height, filter_backprop_width);</div>
<div class="line"><span class="lineno">  261</span>}</div>
<div class="ttc" id="anamespacennfw_1_1cker_html_a0a74e72b1bffcb6519de7fc224416ff9"><div class="ttname"><a href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">nnfw::cker::MatchingDim</a></div><div class="ttdeci">int MatchingDim(const Shape &amp;shape1, int index1, const Shape &amp;shape2, int index2)</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00222">Shape.h:222</a></div></div>
<div class="ttc" id="anamespacennfw_1_1cker_html_a214af5851ca7b77819a78cf4177eb754"><div class="ttname"><a href="namespacennfw_1_1cker.html#a214af5851ca7b77819a78cf4177eb754">nnfw::cker::PaddingType</a></div><div class="ttdeci">PaddingType</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00040">Types.h:41</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_conv_params_html_a0878ee74c474c8a82a574727a2a3048e"><div class="ttname"><a href="structnnfw_1_1cker_1_1_conv_params.html#a0878ee74c474c8a82a574727a2a3048e">nnfw::cker::ConvParams::stride_height</a></div><div class="ttdeci">int16_t stride_height</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00140">Types.h:140</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_conv_params_html_a0a3450e62d20d27c2638d197f1fd2bb2"><div class="ttname"><a href="structnnfw_1_1cker_1_1_conv_params.html#a0a3450e62d20d27c2638d197f1fd2bb2">nnfw::cker::ConvParams::padding_values</a></div><div class="ttdeci">PaddingValues padding_values</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00137">Types.h:137</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_conv_params_html_a273ecef205d663377502d9dcaa77f1b4"><div class="ttname"><a href="structnnfw_1_1cker_1_1_conv_params.html#a273ecef205d663377502d9dcaa77f1b4">nnfw::cker::ConvParams::stride_width</a></div><div class="ttdeci">int16_t stride_width</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00139">Types.h:139</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_conv_params_html_a8ff1e952b2e7627e11b47a22da0883cb"><div class="ttname"><a href="structnnfw_1_1cker_1_1_conv_params.html#a8ff1e952b2e7627e11b47a22da0883cb">nnfw::cker::ConvParams::dilation_width_factor</a></div><div class="ttdeci">int16_t dilation_width_factor</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00141">Types.h:141</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_conv_params_html_ac0164e1731843fbc98df6f1d352bbc0c"><div class="ttname"><a href="structnnfw_1_1cker_1_1_conv_params.html#ac0164e1731843fbc98df6f1d352bbc0c">nnfw::cker::ConvParams::padding_type</a></div><div class="ttdeci">PaddingType padding_type</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00136">Types.h:136</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_conv_params_html_ad47b94004b5b1718979775edaa9eee70"><div class="ttname"><a href="structnnfw_1_1cker_1_1_conv_params.html#ad47b94004b5b1718979775edaa9eee70">nnfw::cker::ConvParams::dilation_height_factor</a></div><div class="ttdeci">int16_t dilation_height_factor</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00142">Types.h:142</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_padding_values_html_a1dc41a9ebbd61a7c34ed2b5dd2ec10eb"><div class="ttname"><a href="structnnfw_1_1cker_1_1_padding_values.html#a1dc41a9ebbd61a7c34ed2b5dd2ec10eb">nnfw::cker::PaddingValues::height</a></div><div class="ttdeci">int16_t height</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00069">Types.h:69</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_padding_values_html_a2a3dd79d28c30c5da865290160601fd1"><div class="ttname"><a href="structnnfw_1_1cker_1_1_padding_values.html#a2a3dd79d28c30c5da865290160601fd1">nnfw::cker::PaddingValues::width</a></div><div class="ttdeci">int16_t width</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00068">Types.h:68</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_filter_op_html"><div class="ttname"><a href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_filter_op.html">nnfw::cker::train::LaunchConv2DBackpropFilterOp</a></div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2train_2operation_2_conv_8h_source.html#l00141">Conv.h:142</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00142">nnfw::cker::ConvParams::dilation_height_factor</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00141">nnfw::cker::ConvParams::dilation_width_factor</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00069">nnfw::cker::PaddingValues::height</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00222">nnfw::cker::MatchingDim()</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00136">nnfw::cker::ConvParams::padding_type</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00137">nnfw::cker::ConvParams::padding_values</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00140">nnfw::cker::ConvParams::stride_height</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00139">nnfw::cker::ConvParams::stride_width</a>, and <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00068">nnfw::cker::PaddingValues::width</a>.</p>

</div>
</div>
<a id="ae29ea521cae886584982a2e79ef0af5c" name="ae29ea521cae886584982a2e79ef0af5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29ea521cae886584982a2e79ef0af5c">&#9670;&#160;</a></span>ConvInputGrad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::ConvInputGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnnfw_1_1cker_1_1_conv_params.html">ConvParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>filter_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>filter_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>padding_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>padding_right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_conv_8h_source.html#l00188">188</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_conv_8h_source.html">Conv.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  192</span>{</div>
<div class="line"><span class="lineno">  193</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stride_rows = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a0878ee74c474c8a82a574727a2a3048e">stride_height</a>;</div>
<div class="line"><span class="lineno">  194</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stride_cols = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a273ecef205d663377502d9dcaa77f1b4">stride_width</a>;</div>
<div class="line"><span class="lineno">  195</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="namespacennfw_1_1cker.html#a214af5851ca7b77819a78cf4177eb754">PaddingType</a> padding = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#ac0164e1731843fbc98df6f1d352bbc0c">padding_type</a>;</div>
<div class="line"><span class="lineno">  196</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> padding_top = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a0a3450e62d20d27c2638d197f1fd2bb2">padding_values</a>.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_padding_values.html#a1dc41a9ebbd61a7c34ed2b5dd2ec10eb">height</a>;</div>
<div class="line"><span class="lineno">  197</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> padding_left = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a0a3450e62d20d27c2638d197f1fd2bb2">padding_values</a>.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_padding_values.html#a2a3dd79d28c30c5da865290160601fd1">width</a>;</div>
<div class="line"><span class="lineno">  198</span>  assert(padding_top &gt;= 0);</div>
<div class="line"><span class="lineno">  199</span>  assert(padding_bottom &gt;= 0);</div>
<div class="line"><span class="lineno">  200</span>  assert(padding_left &gt;= 0);</div>
<div class="line"><span class="lineno">  201</span>  assert(padding_right &gt;= 0);</div>
<div class="line"><span class="lineno">  202</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> dilation_rows = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#ad47b94004b5b1718979775edaa9eee70">dilation_height_factor</a>;</div>
<div class="line"><span class="lineno">  203</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> dilation_cols = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_conv_params.html#a8ff1e952b2e7627e11b47a22da0883cb">dilation_width_factor</a>;</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> batches = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(grad_shape, 0, incoming_shape, 0);</div>
<div class="line"><span class="lineno">  206</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_depth = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(filter_shape, 2, grad_shape, 3);</div>
<div class="line"><span class="lineno">  207</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> output_depth = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(filter_shape, 3, incoming_shape, 3);</div>
<div class="line"><span class="lineno">  208</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> grad_height = grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">  209</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> grad_width = grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(2);</div>
<div class="line"><span class="lineno">  210</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> filter_height = filter_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0);</div>
<div class="line"><span class="lineno">  211</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> filter_width = filter_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">  212</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> incoming_height = incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">  213</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> incoming_width = incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(2);</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <span class="keywordflow">if</span> (dilation_rows != 1 || dilation_cols != 1)</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::ConvFilterGrad: not yet support dilation rates larger than 1.&quot;</span>);</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_input_op.html">LaunchConv2DBackpropInputOp&lt;float&gt;</a>()(</div>
<div class="line"><span class="lineno">  219</span>    incoming_data, batches, incoming_height, incoming_width, output_depth, filter_data,</div>
<div class="line"><span class="lineno">  220</span>    filter_height, filter_width, dilation_rows, dilation_cols, stride_rows, stride_cols, padding,</div>
<div class="line"><span class="lineno">  221</span>    padding_top, padding_bottom, padding_left, padding_right, grad_data, grad_height, grad_width,</div>
<div class="line"><span class="lineno">  222</span>    input_depth);</div>
<div class="line"><span class="lineno">  223</span>}</div>
<div class="ttc" id="astructnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_input_op_html"><div class="ttname"><a href="structnnfw_1_1cker_1_1train_1_1_launch_conv2_d_backprop_input_op.html">nnfw::cker::train::LaunchConv2DBackpropInputOp</a></div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2train_2operation_2_conv_8h_source.html#l00122">Conv.h:123</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00142">nnfw::cker::ConvParams::dilation_height_factor</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00141">nnfw::cker::ConvParams::dilation_width_factor</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00069">nnfw::cker::PaddingValues::height</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00222">nnfw::cker::MatchingDim()</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00136">nnfw::cker::ConvParams::padding_type</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00137">nnfw::cker::ConvParams::padding_values</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00140">nnfw::cker::ConvParams::stride_height</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00139">nnfw::cker::ConvParams::stride_width</a>, and <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00068">nnfw::cker::PaddingValues::width</a>.</p>

</div>
</div>
<a id="ae451e8541f4091a1c41c54ba240824f4" name="ae451e8541f4091a1c41c54ba240824f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae451e8541f4091a1c41c54ba240824f4">&#9670;&#160;</a></span>FullyConnectedBiasGrad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::FullyConnectedBiasGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incomming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>incomming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_fully_connected_8h_source.html#l00031">31</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_fully_connected_8h_source.html">FullyConnected.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{</div>
<div class="line"><span class="lineno">   34</span>  <span class="keyword">const</span> <span class="keyword">auto</span> bias_size = grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ac7e29fd510111992fbd44906e2080f12">FlatSize</a>();</div>
<div class="line"><span class="lineno">   35</span>  <span class="keywordflow">if</span> (bias_size != incomming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(incomming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>() - 1) ||</div>
<div class="line"><span class="lineno">   36</span>      bias_size != grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0))</div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::FullyConnectedBiasGrad: Unmatched shape&quot;</span>);</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  <span class="keyword">const</span> <span class="keyword">auto</span> in_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(incomming_data, incomming_shape);</div>
<div class="line"><span class="lineno">   40</span>  <span class="keyword">auto</span> grad_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(grad_data, grad_shape);</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  grad_mat = in_mat.rowwise().sum();</div>
<div class="line"><span class="lineno">   43</span>}</div>
<div class="ttc" id="aclassnnfw_1_1cker_1_1_shape_html_ac7e29fd510111992fbd44906e2080f12"><div class="ttname"><a href="classnnfw_1_1cker_1_1_shape.html#ac7e29fd510111992fbd44906e2080f12">nnfw::cker::Shape::FlatSize</a></div><div class="ttdeci">int FlatSize() const</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00183">Shape.h:183</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">nnfw::cker::Shape::DimensionsCount()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00183">nnfw::cker::Shape::FlatSize()</a>, and <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">nnfw::cker::MapAsMatrixWithLastDimAsRows()</a>.</p>

</div>
</div>
<a id="a36f9531730e397d0a135dc4881b18fd0" name="a36f9531730e397d0a135dc4881b18fd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36f9531730e397d0a135dc4881b18fd0">&#9670;&#160;</a></span>GradientDescent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::GradientDescent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>grad_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>learning_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2optimizer_2_s_g_d_8h_source.html#l00033">33</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2optimizer_2_s_g_d_8h_source.html">SGD.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>{</div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> output_tensor;</div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> grad_tensor;</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> lr_tensor;</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  output_tensor.shape.ReplaceWith(<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.DimensionsCount(), <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.DimsData());</div>
<div class="line"><span class="lineno">   41</span>  output_tensor.buffer = output_data;</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  grad_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a14357cda4dbb3b72a4c20e912a14f01d">shape</a>.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a3eb902ab9d3bade541a06bb4320d14b3">ReplaceWith</a>(grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>(), grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ae77616d0ab21c7f405129c2fd6d77cc4">DimsData</a>());</div>
<div class="line"><span class="lineno">   44</span>  grad_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = <span class="keyword">const_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(grad_data);</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>  std::vector&lt;float&gt; lr_vec{learning_rate};</div>
<div class="line"><span class="lineno">   47</span>  lr_tensor.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_tensor.html#a712edb68cf1350d930c3d8a733212801">buffer</a> = lr_vec.data();</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a> != grad_shape)</div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">throw</span> std::runtime_error(</div>
<div class="line"><span class="lineno">   51</span>      <span class="stringliteral">&quot;cker::GradientDescent: output and gradient do not have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="namespacennfw_1_1cker_1_1training__ops.html#a667a5d591e975225bf026521f5af79d0">training_ops::CPUDevice</a> &amp;device = *eigen_support::GetThreadPoolDevice();</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_struct" href="structnnfw_1_1cker_1_1training__ops_1_1functor_1_1_apply_gradient_descent.html">training_ops::functor::ApplyGradientDescent&lt;training_ops::CPUDevice, float&gt;</a>()(</div>
<div class="line"><span class="lineno">   55</span>    device, output_tensor.flat&lt;<span class="keywordtype">float</span>&gt;(), lr_tensor.<a class="code hl_function" href="structnnfw_1_1cker_1_1_tensor.html#a13d259f71d97a07d113b5ff016b610f8">scalar</a>&lt;<span class="keywordtype">float</span>&gt;(),</div>
<div class="line"><span class="lineno">   56</span>    <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_struct" href="structnnfw_1_1cker_1_1_tensor.html">Tensor</a> &amp;<span class="keyword">&gt;</span>(grad_tensor).flat&lt;float&gt;());</div>
<div class="line"><span class="lineno">   57</span>}</div>
<div class="ttc" id="anamespacennfw_1_1cker_1_1training__ops_html_a667a5d591e975225bf026521f5af79d0"><div class="ttname"><a href="namespacennfw_1_1cker_1_1training__ops.html#a667a5d591e975225bf026521f5af79d0">nnfw::cker::training_ops::CPUDevice</a></div><div class="ttdeci">Eigen::ThreadPoolDevice CPUDevice</div><div class="ttdef"><b>Definition:</b> <a href="training__ops_8h_source.html#l00070">training_ops.h:70</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1training__ops_1_1functor_1_1_apply_gradient_descent_html"><div class="ttname"><a href="structnnfw_1_1cker_1_1training__ops_1_1functor_1_1_apply_gradient_descent.html">nnfw::cker::training_ops::functor::ApplyGradientDescent</a></div><div class="ttdef"><b>Definition:</b> <a href="training__ops_8h_source.html#l00050">training_ops.h:51</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00097">nnfw::cker::Tensor::buffer</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">nnfw::cker::Shape::DimensionsCount()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00114">nnfw::cker::Shape::DimsData()</a>, <a class="el" href="_eigen_support_8h_source.html#l00110">nnfw::cker::eigen_support::GetThreadPoolDevice()</a>, <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00132">nnfw::cker::Shape::ReplaceWith()</a>, <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00156">nnfw::cker::Tensor::scalar()</a>, and <a class="el" href="compute_2cker_2include_2cker_2operation_2_helper_2_tensor_8h_source.html#l00096">nnfw::cker::Tensor::shape</a>.</p>

<p class="reference">Referenced by <a class="el" href="_s_g_d_8cc_source.html#l00038">onert::backend::train::optimizer::SGD::applyGradient()</a>.</p>

</div>
</div>
<a id="a6219f86d7d6197357e94a6feb860a2fa" name="a6219f86d7d6197357e94a6feb860a2fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6219f86d7d6197357e94a6feb860a2fa">&#9670;&#160;</a></span>log_threshold()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T nnfw::cker::train::log_threshold </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00033">33</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html">Loss.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1e-20); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5383dd7006f6272ba54849c0bb709350" name="a5383dd7006f6272ba54849c0bb709350"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5383dd7006f6272ba54849c0bb709350">&#9670;&#160;</a></span>MaxPool2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::MaxPool2D </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structnnfw_1_1cker_1_1_pool_params.html">PoolParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>input_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>input_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>arg_max_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_max_pool_8h_source.html#l00036">36</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_max_pool_8h_source.html">MaxPool.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>  assert(input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>() == 4);</div>
<div class="line"><span class="lineno">   40</span>  assert(<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.DimensionsCount() == 4);</div>
<div class="line"><span class="lineno">   41</span>  assert(input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0) == <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.Dims(0)); <span class="comment">// MaxPool2D doesn&#39;t change batch</span></div>
<div class="line"><span class="lineno">   42</span>  assert(input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(3) == <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.Dims(3)); <span class="comment">// MaxPool2D doesn&#39;t change depth</span></div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> batches = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(input_shape, 0, <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, 0);</div>
<div class="line"><span class="lineno">   45</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_height = input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">   46</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_width = input_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(2);</div>
<div class="line"><span class="lineno">   47</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> output_height = <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.Dims(1);</div>
<div class="line"><span class="lineno">   48</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> output_width = <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.Dims(2);</div>
<div class="line"><span class="lineno">   49</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> filter_height = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#af962d4c51d9cfff5445f8fd0fa79d1f2">filter_height</a>;</div>
<div class="line"><span class="lineno">   50</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> filter_width = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#aa7c5c48b0487880dfed428a212ea0e8c">filter_width</a>;</div>
<div class="line"><span class="lineno">   51</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> pad_height = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#aef09bc53314176a8b709a6cd07d601d7">padding_values</a>.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_padding_values.html#a1dc41a9ebbd61a7c34ed2b5dd2ec10eb">height</a>;</div>
<div class="line"><span class="lineno">   52</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> pad_width = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#aef09bc53314176a8b709a6cd07d601d7">padding_values</a>.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_padding_values.html#a2a3dd79d28c30c5da865290160601fd1">width</a>;</div>
<div class="line"><span class="lineno">   53</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stride_height = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#a920a18b024aaece07792b53fd7985c45">stride_height</a>;</div>
<div class="line"><span class="lineno">   54</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> stride_width = params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#ab2571df6660224a127a90f06eccafe4d">stride_width</a>;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  <span class="keyword">const</span> <span class="keyword">auto</span> in_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(input_data, input_shape);</div>
<div class="line"><span class="lineno">   57</span>  <span class="keyword">auto</span> out_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(output_data, <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>);</div>
<div class="line"><span class="lineno">   58</span>  <span class="keyword">auto</span> arg_max_index_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(arg_max_index, <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>);</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  <span class="comment">// initialize output area</span></div>
<div class="line"><span class="lineno">   61</span>  std::fill(output_data, output_data + <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.FlatSize(), 0.0);</div>
<div class="line"><span class="lineno">   62</span>  std::fill(arg_max_index, arg_max_index + <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.FlatSize(), -1);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <span class="comment">// initialize projected area with lowest float</span></div>
<div class="line"><span class="lineno">   65</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> h_start =</div>
<div class="line"><span class="lineno">   66</span>    (pad_height &lt; filter_height) ? 0 : (pad_height - filter_height) / stride_height + 1;</div>
<div class="line"><span class="lineno">   67</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> h_end = std::min((input_height + pad_height - 1) / stride_height + 1, output_height);</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> w_start =</div>
<div class="line"><span class="lineno">   70</span>    (pad_width &lt; filter_width) ? 0 : (pad_width - filter_width) / stride_width + 1;</div>
<div class="line"><span class="lineno">   71</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> w_end = std::min((input_width + pad_width - 1) / stride_width + 1, output_width);</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; batches; ++b)</div>
<div class="line"><span class="lineno">   74</span>  {</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h_idx = h_start; h_idx &lt; h_end; h_idx++)</div>
<div class="line"><span class="lineno">   76</span>    {</div>
<div class="line"><span class="lineno">   77</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w_idx = w_start; w_idx &lt; w_end; w_idx++)</div>
<div class="line"><span class="lineno">   78</span>      {</div>
<div class="line"><span class="lineno">   79</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_function" href="helpers_8h.html#a4feba60a9e39bac7e69e89159514c9e6">offset</a> = <a class="code hl_function" href="_feature_map_8h.html#a4281d2df268d543e163b49e29b46e48d">NodeOffset</a>(b, h_idx, w_idx, output_height, output_width);</div>
<div class="line"><span class="lineno">   80</span>        out_mat.col(<a class="code hl_function" href="helpers_8h.html#a4feba60a9e39bac7e69e89159514c9e6">offset</a>).setConstant(std::numeric_limits&lt;float&gt;::lowest());</div>
<div class="line"><span class="lineno">   81</span>      }</div>
<div class="line"><span class="lineno">   82</span>    }</div>
<div class="line"><span class="lineno">   83</span>  }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; batches; ++b)</div>
<div class="line"><span class="lineno">   86</span>  {</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h = 0; h &lt; input_height; ++h)</div>
<div class="line"><span class="lineno">   88</span>    {</div>
<div class="line"><span class="lineno">   89</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; input_width; ++w)</div>
<div class="line"><span class="lineno">   90</span>      {</div>
<div class="line"><span class="lineno">   91</span>        <span class="comment">// (h_start, h_end) * (w_start, w_end) is the range that the input</span></div>
<div class="line"><span class="lineno">   92</span>        <span class="comment">// vector projects to.</span></div>
<div class="line"><span class="lineno">   93</span>        <span class="keywordtype">int</span> hpad = h + pad_height;</div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordtype">int</span> wpad = w + pad_width;</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>        <span class="keywordtype">int</span> h_start = (hpad &lt; filter_height) ? 0 : (hpad - filter_height) / stride_height + 1;</div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordtype">int</span> h_end = std::min(hpad / stride_height + 1, output_height);</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordtype">int</span> w_start = (wpad &lt; filter_width) ? 0 : (wpad - filter_width) / stride_width + 1;</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordtype">int</span> w_end = std::min(wpad / stride_width + 1, output_width);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>        <span class="comment">// compute elementwise sum</span></div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ph = h_start; ph &lt; h_end; ++ph)</div>
<div class="line"><span class="lineno">  104</span>        {</div>
<div class="line"><span class="lineno">  105</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pw = w_start; pw &lt; w_end; ++pw)</div>
<div class="line"><span class="lineno">  106</span>          {</div>
<div class="line"><span class="lineno">  107</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> out_offset = <a class="code hl_function" href="_feature_map_8h.html#a4281d2df268d543e163b49e29b46e48d">NodeOffset</a>(b, ph, pw, output_height, output_width);</div>
<div class="line"><span class="lineno">  108</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> in_offset = <a class="code hl_function" href="_feature_map_8h.html#a4281d2df268d543e163b49e29b46e48d">NodeOffset</a>(b, h, w, input_height, input_width);</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>            <span class="keyword">const</span> <span class="keyword">auto</span> out_vector = out_mat.col(out_offset);</div>
<div class="line"><span class="lineno">  111</span>            <span class="keyword">const</span> <span class="keyword">auto</span> in_vector = in_mat.col(in_offset);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>            <span class="comment">// update arg_max_index_mat</span></div>
<div class="line"><span class="lineno">  114</span>            arg_max_index_mat.col(out_offset) =</div>
<div class="line"><span class="lineno">  115</span>              (out_vector.array() &lt; in_vector.array())</div>
<div class="line"><span class="lineno">  116</span>                .select(in_offset, arg_max_index_mat.col(out_offset));</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>            <span class="comment">// update out_mat</span></div>
<div class="line"><span class="lineno">  119</span>            out_mat.col(out_offset) = out_vector.cwiseMax(in_vector);</div>
<div class="line"><span class="lineno">  120</span>          }</div>
<div class="line"><span class="lineno">  121</span>        }</div>
<div class="line"><span class="lineno">  122</span>      }</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span>  }</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  out_mat.cwiseMin(params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#abb165d50d083ff41957b00a06250a79e">float_activation_min</a>).cwiseMax(params.<a class="code hl_variable" href="structnnfw_1_1cker_1_1_pool_params.html#a724b505369bda13ddeb9bc803d0f0ad6">float_activation_max</a>);</div>
<div class="line"><span class="lineno">  127</span>}</div>
<div class="ttc" id="a_feature_map_8h_html_a4281d2df268d543e163b49e29b46e48d"><div class="ttname"><a href="_feature_map_8h.html#a4281d2df268d543e163b49e29b46e48d">NodeOffset</a></div><div class="ttdeci">int NodeOffset(int b, int h, int w, int height, int width)</div><div class="ttdef"><b>Definition:</b> <a href="_feature_map_8h_source.html#l00021">FeatureMap.h:21</a></div></div>
<div class="ttc" id="ahelpers_8h_html_a4feba60a9e39bac7e69e89159514c9e6"><div class="ttname"><a href="helpers_8h.html#a4feba60a9e39bac7e69e89159514c9e6">offset</a></div><div class="ttdeci">__global uchar * offset(const Image *img, int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="helpers_8h_source.html#l00540">helpers.h:540</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_a724b505369bda13ddeb9bc803d0f0ad6"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#a724b505369bda13ddeb9bc803d0f0ad6">nnfw::cker::PoolParams::float_activation_max</a></div><div class="ttdeci">float float_activation_max</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00093">Types.h:93</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_a920a18b024aaece07792b53fd7985c45"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#a920a18b024aaece07792b53fd7985c45">nnfw::cker::PoolParams::stride_height</a></div><div class="ttdeci">int stride_height</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00084">Types.h:84</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_aa7c5c48b0487880dfed428a212ea0e8c"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#aa7c5c48b0487880dfed428a212ea0e8c">nnfw::cker::PoolParams::filter_width</a></div><div class="ttdeci">int filter_width</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00087">Types.h:87</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_ab2571df6660224a127a90f06eccafe4d"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#ab2571df6660224a127a90f06eccafe4d">nnfw::cker::PoolParams::stride_width</a></div><div class="ttdeci">int stride_width</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00085">Types.h:85</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_abb165d50d083ff41957b00a06250a79e"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#abb165d50d083ff41957b00a06250a79e">nnfw::cker::PoolParams::float_activation_min</a></div><div class="ttdeci">float float_activation_min</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00092">Types.h:92</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_aef09bc53314176a8b709a6cd07d601d7"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#aef09bc53314176a8b709a6cd07d601d7">nnfw::cker::PoolParams::padding_values</a></div><div class="ttdeci">PaddingValues padding_values</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00083">Types.h:83</a></div></div>
<div class="ttc" id="astructnnfw_1_1cker_1_1_pool_params_html_af962d4c51d9cfff5445f8fd0fa79d1f2"><div class="ttname"><a href="structnnfw_1_1cker_1_1_pool_params.html#af962d4c51d9cfff5445f8fd0fa79d1f2">nnfw::cker::PoolParams::filter_height</a></div><div class="ttdeci">int filter_height</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_types_8h_source.html#l00086">Types.h:86</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">nnfw::cker::Shape::DimensionsCount()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00086">nnfw::cker::PoolParams::filter_height</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00087">nnfw::cker::PoolParams::filter_width</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00093">nnfw::cker::PoolParams::float_activation_max</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00092">nnfw::cker::PoolParams::float_activation_min</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00069">nnfw::cker::PaddingValues::height</a>, <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">nnfw::cker::MapAsMatrixWithLastDimAsRows()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00222">nnfw::cker::MatchingDim()</a>, <a class="el" href="compute_2cker_2include_2cker_2_utils_8h_source.html#l00144">nnfw::cker::NodeOffset()</a>, <a class="el" href="helpers_8h_source.html#l00540">offset()</a>, <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00083">nnfw::cker::PoolParams::padding_values</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00084">nnfw::cker::PoolParams::stride_height</a>, <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00085">nnfw::cker::PoolParams::stride_width</a>, and <a class="el" href="compute_2cker_2include_2cker_2_types_8h_source.html#l00068">nnfw::cker::PaddingValues::width</a>.</p>

</div>
</div>
<a id="ab1f474cf700e72f893fd4b9470d584db" name="ab1f474cf700e72f893fd4b9470d584db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1f474cf700e72f893fd4b9470d584db">&#9670;&#160;</a></span>MaxPool2DGrad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::MaxPool2DGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>arg_max_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_max_pool_8h_source.html#l00129">129</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_max_pool_8h_source.html">MaxPool.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{</div>
<div class="line"><span class="lineno">  132</span>  assert(grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>() == 4);</div>
<div class="line"><span class="lineno">  133</span>  assert(incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>() == 4);</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  <span class="comment">// initialize grad_data</span></div>
<div class="line"><span class="lineno">  136</span>  std::fill(grad_data, grad_data + grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ac7e29fd510111992fbd44906e2080f12">FlatSize</a>(), 0.0);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> depth = <a class="code hl_function" href="namespacennfw_1_1cker.html#a0a74e72b1bffcb6519de7fc224416ff9">MatchingDim</a>(grad_shape, 3, incoming_shape, 3);</div>
<div class="line"><span class="lineno">  139</span>  <span class="keyword">const</span> <span class="keyword">auto</span> incoming_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(incoming_data, incoming_shape);</div>
<div class="line"><span class="lineno">  140</span>  <span class="keyword">auto</span> arg_max_index_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(arg_max_index, incoming_shape);</div>
<div class="line"><span class="lineno">  141</span>  <span class="keyword">auto</span> grad_mat = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(grad_data, grad_shape);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_index = 0; col_index &lt; incoming_mat.cols(); col_index++)</div>
<div class="line"><span class="lineno">  144</span>  {</div>
<div class="line"><span class="lineno">  145</span>    <span class="keyword">auto</span> arg_indices = arg_max_index_mat.col(col_index);</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; depth; d++)</div>
<div class="line"><span class="lineno">  147</span>    {</div>
<div class="line"><span class="lineno">  148</span>      <span class="comment">// output value is from padding, so nothing to propagate</span></div>
<div class="line"><span class="lineno">  149</span>      <span class="keywordflow">if</span> (arg_indices(d) == -1)</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>      grad_mat(d, arg_indices(d)) += incoming_mat(d, col_index);</div>
<div class="line"><span class="lineno">  153</span>    }</div>
<div class="line"><span class="lineno">  154</span>  }</div>
<div class="line"><span class="lineno">  155</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">nnfw::cker::Shape::DimensionsCount()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00183">nnfw::cker::Shape::FlatSize()</a>, <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">nnfw::cker::MapAsMatrixWithLastDimAsRows()</a>, and <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00222">nnfw::cker::MatchingDim()</a>.</p>

</div>
</div>
<a id="a52345a6f0694577d6369713c74e7d027" name="a52345a6f0694577d6369713c74e7d027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52345a6f0694577d6369713c74e7d027">&#9670;&#160;</a></span>MeanGrad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::MeanGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_reduce_mean_8h_source.html#l00032">32</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_reduce_mean_8h_source.html">ReduceMean.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>{</div>
<div class="line"><span class="lineno">   35</span>  <a class="code hl_function" href="namespacennfw_1_1cker.html#a1e1dff7348ecb46fba0b6781f8183c6a">BroadcastTo</a>(incoming_shape, <span class="keyword">const_cast&lt;</span>T *<span class="keyword">&gt;</span>(incoming_data), grad_shape, grad_data);</div>
<div class="line"><span class="lineno">   36</span>  <span class="keyword">const</span> <span class="keyword">auto</span> incoming = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(incoming_data, incoming_shape);</div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">auto</span> grad = <a class="code hl_function" href="namespacennfw_1_1cker.html#a5661008cc0dc7e29714ea90ca28efea4">MapAsMatrixWithLastDimAsRows</a>(grad_data, grad_shape);</div>
<div class="line"><span class="lineno">   38</span>  grad /= (grad.size() / incoming.size());</div>
<div class="line"><span class="lineno">   39</span>}</div>
<div class="ttc" id="anamespacennfw_1_1cker_html_a1e1dff7348ecb46fba0b6781f8183c6a"><div class="ttname"><a href="namespacennfw_1_1cker.html#a1e1dff7348ecb46fba0b6781f8183c6a">nnfw::cker::BroadcastTo</a></div><div class="ttdeci">void BroadcastTo(const Shape &amp;input_shape, T *input_data, const Shape &amp;output_shape, T *output_data)</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2operation_2_broadcast_to_8h_source.html#l00132">BroadcastTo.h:132</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2operation_2_broadcast_to_8h_source.html#l00132">nnfw::cker::BroadcastTo()</a>, and <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00060">nnfw::cker::MapAsMatrixWithLastDimAsRows()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_2ops_2_mean_layer_8cc_source.html#l00052">onert::backend::train::ops::MeanLayer::backward()</a>.</p>

</div>
</div>
<a id="ac56dcc0882ef61d9d8f9c9132d917ba0" name="ac56dcc0882ef61d9d8f9c9132d917ba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56dcc0882ef61d9d8f9c9132d917ba0">&#9670;&#160;</a></span>MSE()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::MSE </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_pred_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_pred_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_true_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_true_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>output_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00036">36</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html">Loss.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.DimensionsCount() != 1)</div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::MSE: output dimension count should be 1&quot;</span>);</div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>.Dims(0) != y_pred_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0))</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::MSE: output and y_pred do not have the same batch&quot;</span>);</div>
<div class="line"><span class="lineno">   43</span>  <span class="keywordflow">if</span> (y_pred_shape != y_true_shape)</div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::MSE: y_pred_shape != y_true_shape&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>  <span class="keyword">const</span> <span class="keyword">auto</span> batch = y_pred_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0);</div>
<div class="line"><span class="lineno">   47</span>  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a> = <a class="code hl_function" href="namespacennfw_1_1cker.html#a59fdb0b28360a8fcf55b1080b63eefb3">FlatSizeSkipDim</a>(y_pred_shape, 0);</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; batch; ++b)</div>
<div class="line"><span class="lineno">   50</span>  {</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordtype">float</span> sum = 0.f;</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a>; ++i)</div>
<div class="line"><span class="lineno">   53</span>    {</div>
<div class="line"><span class="lineno">   54</span>      sum += <a class="code hl_function" href="namespacennfw_1_1cker_1_1train.html#ab73263e409724ca45f5cf2dba525d4b0">square</a>(y_pred_data[b * <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a> + i] - y_true_data[b * <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a> + i]);</div>
<div class="line"><span class="lineno">   55</span>    }</div>
<div class="line"><span class="lineno">   56</span>    output_data[b] = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(sum / <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a>);</div>
<div class="line"><span class="lineno">   57</span>  }</div>
<div class="line"><span class="lineno">   58</span>}</div>
<div class="ttc" id="anamespacennfw_1_1cker_1_1train_html_ab73263e409724ca45f5cf2dba525d4b0"><div class="ttname"><a href="namespacennfw_1_1cker_1_1train.html#ab73263e409724ca45f5cf2dba525d4b0">nnfw::cker::train::square</a></div><div class="ttdeci">T square(T value)</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00032">Loss.h:32</a></div></div>
<div class="ttc" id="anamespacennfw_1_1cker_html_a59fdb0b28360a8fcf55b1080b63eefb3"><div class="ttname"><a href="namespacennfw_1_1cker.html#a59fdb0b28360a8fcf55b1080b63eefb3">nnfw::cker::FlatSizeSkipDim</a></div><div class="ttdeci">int FlatSizeSkipDim(const Shape &amp;shape, int skip_dim)</div><div class="ttdef"><b>Definition:</b> <a href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00257">Shape.h:257</a></div></div>
<div class="ttc" id="aonert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp_html_a10d56296440a32555b0b81a24936255c"><div class="ttname"><a href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a></div><div class="ttdeci">int32_t size[5]</div><div class="ttdef"><b>Definition:</b> <a href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp_source.html#l00035">Slice.cpp:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00257">nnfw::cker::FlatSizeSkipDim()</a>, <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>, <a class="el" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp_source.html#l00035">size</a>, and <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00032">square()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_loss_mean_squared_error_layer_8cc_source.html#l00038">onert::backend::train::ops::LossMeanSquaredErrorLayer::forward()</a>.</p>

</div>
</div>
<a id="a23fc8a7fd2e8068b5bb1b07a581e0936" name="a23fc8a7fd2e8068b5bb1b07a581e0936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23fc8a7fd2e8068b5bb1b07a581e0936">&#9670;&#160;</a></span>MSEGrad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::MSEGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_pred_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_pred_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>y_true_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>y_true_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00061">61</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html">Loss.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>{</div>
<div class="line"><span class="lineno">   64</span>  <span class="keywordflow">if</span> (y_pred_shape != y_true_shape)</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::MSEGrad: y_pred_shape != y_true_shape&quot;</span>);</div>
<div class="line"><span class="lineno">   66</span>  <span class="keywordflow">if</span> (y_pred_shape != grad_shape)</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::MSEGrad: y_pred_shape != grad_shape&quot;</span>);</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a> = grad_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#ac7e29fd510111992fbd44906e2080f12">FlatSize</a>();</div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a>; ++i)</div>
<div class="line"><span class="lineno">   71</span>  {</div>
<div class="line"><span class="lineno">   72</span>    grad_data[i] = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(-2 * (y_true_data[i] - y_pred_data[i]) / <a class="code hl_variable" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp.html#a10d56296440a32555b0b81a24936255c">size</a>);</div>
<div class="line"><span class="lineno">   73</span>  }</div>
<div class="line"><span class="lineno">   74</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00183">nnfw::cker::Shape::FlatSize()</a>, and <a class="el" href="onert-micro_2luci-interpreter_2src_2kernels_2_slice_8cpp_source.html#l00035">size</a>.</p>

<p class="reference">Referenced by <a class="el" href="_loss_mean_squared_error_layer_8cc_source.html#l00052">onert::backend::train::ops::LossMeanSquaredErrorLayer::backward()</a>.</p>

</div>
</div>
<a id="abe5949773bbbe4ca31565a0eacbd11c2" name="abe5949773bbbe4ca31565a0eacbd11c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe5949773bbbe4ca31565a0eacbd11c2">&#9670;&#160;</a></span>ReLU6Grad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::ReLU6Grad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>output_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_re_l_u6_8h_source.html#l00031">31</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_re_l_u6_8h_source.html">ReLU6.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>{</div>
<div class="line"><span class="lineno">   35</span>  <span class="keyword">const</span> <span class="keyword">auto</span> output_map = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(output_data, <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>);</div>
<div class="line"><span class="lineno">   36</span>  <span class="keyword">const</span> <span class="keyword">auto</span> incoming_map = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(incoming_data, incoming_shape);</div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">auto</span> grad_map = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(grad_data, grad_shape);</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a> != incoming_shape || <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a> != grad_shape)</div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">throw</span> std::runtime_error{<span class="stringliteral">&quot;cker::ReLU6Grad: Unsupported shape&quot;</span>};</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  grad_map.array() =</div>
<div class="line"><span class="lineno">   43</span>    incoming_map.array() *</div>
<div class="line"><span class="lineno">   44</span>    (0.0f &lt; output_map.array() &amp;&amp; output_map.array() &lt; 6.0f).<span class="keyword">template</span> cast&lt;float&gt;();</div>
<div class="line"><span class="lineno">   45</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00043">nnfw::cker::MapAsVector()</a>, and <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_2ops_2_elementwise_activation_layer_8cc_source.html#l00038">onert::backend::train::ops::ElementwiseActivationLayer::configure()</a>.</p>

</div>
</div>
<a id="a56ba869240e3cb2e543a61e176115d8f" name="a56ba869240e3cb2e543a61e176115d8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56ba869240e3cb2e543a61e176115d8f">&#9670;&#160;</a></span>ReLUGrad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::ReLUGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>output_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_re_l_u_8h_source.html#l00032">32</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_re_l_u_8h_source.html">ReLU.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>{</div>
<div class="line"><span class="lineno">   36</span>  <span class="keyword">const</span> <span class="keyword">auto</span> output_map = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(output_data, <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>);</div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">const</span> <span class="keyword">auto</span> incoming_map = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(incoming_data, incoming_shape);</div>
<div class="line"><span class="lineno">   38</span>  <span class="keyword">auto</span> grad_map = <a class="code hl_function" href="_matrix_8h.html#a4dbf05dabea32cf4bc0693e0cc32d984">MapAsVector</a>(grad_data, grad_shape);</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a> == incoming_shape &amp;&amp; <a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a> == grad_shape)</div>
<div class="line"><span class="lineno">   41</span>    grad_map.array() = incoming_map.array() * (output_map.array() &gt; 0.0f).<span class="keyword">template</span> cast&lt;float&gt;();</div>
<div class="line"><span class="lineno">   42</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;cker::ReLUGrad: Unsupported shape&quot;</span>);</div>
<div class="line"><span class="lineno">   44</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2eigen_2_utils_8h_source.html#l00043">nnfw::cker::MapAsVector()</a>, and <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_2ops_2_elementwise_activation_layer_8cc_source.html#l00038">onert::backend::train::ops::ElementwiseActivationLayer::configure()</a>.</p>

</div>
</div>
<a id="a8b6afe0db84836d197f52230d77b913f" name="a8b6afe0db84836d197f52230d77b913f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b6afe0db84836d197f52230d77b913f">&#9670;&#160;</a></span>SoftMaxGrad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnfw::cker::train::SoftMaxGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>output_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>output_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>incoming_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>incoming_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classnnfw_1_1cker_1_1_shape.html">Shape</a> &amp;&#160;</td>
          <td class="paramname"><em>grad_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>grad_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_soft_max_8h_source.html#l00030">30</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_soft_max_8h_source.html">SoftMax.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>{</div>
<div class="line"><span class="lineno">   34</span>  <span class="comment">// TODO Support 4dim softmax gradient</span></div>
<div class="line"><span class="lineno">   35</span>  assert(incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a01c6b5dc4b24d5c2567c47cb15318839">DimensionsCount</a>() == 2);</div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_function" href="ann-ref_2src_2ops_2internal_2_dims_8h.html#a93604338a7a3801ed30692282ff124ce">MatchingFlatSize</a>(<a class="code hl_variable" href="_p_a_l_comparisons_8h.html#a74a475996321e12d590d9029e114d8d0">output_shape</a>, incoming_shape, grad_shape);</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> batches = incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(0);</div>
<div class="line"><span class="lineno">   39</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> width = incoming_shape.<a class="code hl_function" href="classnnfw_1_1cker_1_1_shape.html#a497180ee7844bbef51b36bd58e61fa31">Dims</a>(1);</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; batches; ++b)</div>
<div class="line"><span class="lineno">   42</span>  {</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordtype">int</span> b_offset = b * width;</div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w1 = 0; w1 &lt; width; ++w1)</div>
<div class="line"><span class="lineno">   45</span>    {</div>
<div class="line"><span class="lineno">   46</span>      <span class="keywordtype">float</span> sum = 0.0f;</div>
<div class="line"><span class="lineno">   47</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w2 = 0; w2 &lt; width; ++w2)</div>
<div class="line"><span class="lineno">   48</span>      {</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordtype">float</span> val;</div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordflow">if</span> (w1 == w2)</div>
<div class="line"><span class="lineno">   51</span>        {</div>
<div class="line"><span class="lineno">   52</span>          val = output_data[b_offset + w2] * (1.f - output_data[b_offset + w2]);</div>
<div class="line"><span class="lineno">   53</span>        }</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   55</span>        {</div>
<div class="line"><span class="lineno">   56</span>          val = -output_data[b_offset + w2] * output_data[b_offset + w1];</div>
<div class="line"><span class="lineno">   57</span>        }</div>
<div class="line"><span class="lineno">   58</span>        val *= incoming_data[b_offset + w2];</div>
<div class="line"><span class="lineno">   59</span>        sum += val;</div>
<div class="line"><span class="lineno">   60</span>      }</div>
<div class="line"><span class="lineno">   61</span>      grad_data[b_offset + w1] = sum;</div>
<div class="line"><span class="lineno">   62</span>    }</div>
<div class="line"><span class="lineno">   63</span>  }</div>
<div class="line"><span class="lineno">   64</span>}</div>
<div class="ttc" id="aann-ref_2src_2ops_2internal_2_dims_8h_html_a93604338a7a3801ed30692282ff124ce"><div class="ttname"><a href="ann-ref_2src_2ops_2internal_2_dims_8h.html#a93604338a7a3801ed30692282ff124ce">MatchingFlatSize</a></div><div class="ttdeci">int MatchingFlatSize(const Dims&lt; N &gt; &amp;dims, const Dims&lt; N &gt; &amp;check_dims_0)</div><div class="ttdef"><b>Definition:</b> <a href="ann-ref_2src_2ops_2internal_2_dims_8h_source.html#l00108">Dims.h:108</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00093">nnfw::cker::Shape::DimensionsCount()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00094">nnfw::cker::Shape::Dims()</a>, <a class="el" href="compute_2cker_2include_2cker_2_shape_8h_source.html#l00301">nnfw::cker::MatchingFlatSize()</a>, and <a class="el" href="_p_a_l_comparisons_8h_source.html#l00032">output_shape</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_2ops_2_soft_max_layer_8cc_source.html#l00050">onert::backend::train::ops::SoftMaxLayer::backward()</a>.</p>

</div>
</div>
<a id="ab73263e409724ca45f5cf2dba525d4b0" name="ab73263e409724ca45f5cf2dba525d4b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab73263e409724ca45f5cf2dba525d4b0">&#9670;&#160;</a></span>square()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T nnfw::cker::train::square </td>
          <td>(</td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00032">32</a> of file <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html">Loss.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>{ <span class="keywordflow">return</span> value * value; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="compute_2cker_2include_2cker_2train_2operation_2_loss_8h_source.html#l00036">MSE()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacennfw.html">nnfw</a></li><li class="navelem"><a class="el" href="namespacennfw_1_1cker.html">cker</a></li><li class="navelem"><a class="el" href="namespacennfw_1_1cker_1_1train.html">train</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
